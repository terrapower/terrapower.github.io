<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>armi.reactor.components.component &mdash; ARMI 0.5.0 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            ARMI
              <img src="../../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.5.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../armi.html">armi</a></li>
          <li class="breadcrumb-item"><a href="../../reactor.html">armi.reactor</a></li>
          <li class="breadcrumb-item"><a href="../components.html">armi.reactor.components</a></li>
      <li class="breadcrumb-item active">armi.reactor.components.component</li>
  <li class="wy-breadcrumbs-aside">
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for armi.reactor.components.component</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Components represent geometric objects within an assembly such as fuel, bond, coolant, ducts, wires, etc.</span>

<span class="sd">This module contains the abstract definition of a Component.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">materials</span><span class="p">,</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi.bookkeeping</span> <span class="kn">import</span> <span class="n">report</span>
<span class="kn">from</span> <span class="nn">armi.materials</span> <span class="kn">import</span> <span class="n">custom</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">void</span>
<span class="kn">from</span> <span class="nn">armi.nucDirectory</span> <span class="kn">import</span> <span class="n">nuclideBases</span>
<span class="kn">from</span> <span class="nn">armi.reactor</span> <span class="kn">import</span> <span class="n">composites</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="n">parameters</span>
<span class="kn">from</span> <span class="nn">armi.reactor.components</span> <span class="kn">import</span> <span class="n">componentParameters</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">densityTools</span>
<span class="kn">from</span> <span class="nn">armi.utils.units</span> <span class="kn">import</span> <span class="n">C_TO_K</span>

<span class="n">COMPONENT_LINK_REGEX</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\s*(.+?)\s*\.\s*(.+?)\s*$&quot;</span><span class="p">)</span>


<span class="n">_NICE_DIM_NAMES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Inner Diameter (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;od&quot;</span><span class="p">:</span> <span class="s2">&quot;Outer Diameter (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;Inner Pitch (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;Outer Pitch (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mult&quot;</span><span class="p">:</span> <span class="s2">&quot;Multiplicity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;axialPitch&quot;</span><span class="p">:</span> <span class="s2">&quot;Axial Pitch (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;helixDiameter&quot;</span><span class="p">:</span> <span class="s2">&quot;Helix Diameter (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="s2">&quot;Length (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;Height (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;Width (cm)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;areaMod&quot;</span><span class="p">:</span> <span class="s2">&quot;Area Mod. Factor&quot;</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="componentTypeIsValid"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.componentTypeIsValid">[docs]</a><span class="k">def</span> <span class="nf">componentTypeIsValid</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks that the component assigned component type is valid.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - `Coolant` components are can no longer be defined as a general `Component` and should be specfied as a</span>
<span class="sd">      `DerivedShape` if the coolant dimensions are not provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">armi.reactor.components</span> <span class="kn">import</span> <span class="n">NullComponent</span>

    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;coolant&quot;</span><span class="p">:</span>
        <span class="n">invalidComponentTypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Component</span><span class="p">,</span> <span class="n">NullComponent</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">invalidComponentTypes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Coolant components cannot be defined as a `Component`. Either define coolant as a &quot;</span>
                <span class="s2">&quot;`DerivedShape` or specify its dimensions explicitly using another component type.&quot;</span>
            <span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_DimensionLink</span><span class="p">(</span><span class="nb">tuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A linked dimension, where one component uses a dimension from another.</span>

<span class="sd">    Useful when the boundaries are physically shared and should move together.</span>

<span class="sd">    The tuple contains (linkedComponent, linkedDimensionName).</span>

<span class="sd">    In equating two components, we need the linked dimensions to resolve responsibly/precisely.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">getLinkedComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the linked component.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">resolveDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current value of the linked dimension.&quot;&quot;&quot;</span>
        <span class="n">linkedComponent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dimID</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">linkedComponent</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="n">dimID</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">otherDimension</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">other</span><span class="o">.</span><span class="n">resolveDimension</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">_DimensionLink</span><span class="p">)</span> <span class="k">else</span> <span class="n">other</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolveDimension</span><span class="p">()</span> <span class="o">==</span> <span class="n">otherDimension</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of a dimension link.</span>

<span class="sd">        These look like ``otherComponentName.otherDimensionName``.</span>
<span class="sd">        For example, if a link were to a ``fuel`` component&#39;s</span>
<span class="sd">        ``od`` param, the link would render as ``fuel.od``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>


<div class="viewcode-block" id="ComponentType"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.ComponentType">[docs]</a><span class="k">class</span> <span class="nc">ComponentType</span><span class="p">(</span><span class="n">composites</span><span class="o">.</span><span class="n">CompositeModelType</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ComponetType is a metaclass for storing and initializing Component subclass types.</span>

<span class="sd">    The construction of Component subclasses is being done through factories for ease of</span>
<span class="sd">    user input.  As a consequence, the ``__init__`` methods&#39; arguments need to be known</span>
<span class="sd">    in order to conform them to the correct format. Additionally, the constructors</span>
<span class="sd">    arguments can be used to determine the Component subclasses dimensions.</span>

<span class="sd">    Warning</span>
<span class="sd">    -------</span>
<span class="sd">    The import-time metaclass-based component subclass registration was a good idea, but in practice</span>
<span class="sd">    has caused significant confusion and trouble. We will replace this soon with an explicit</span>
<span class="sd">    plugin-based component subclass registration system.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TYPES</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: :meta hide-value:</span>

    <span class="n">NON_DIMENSION_NAMES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Tinput&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Thot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;isotopics&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mergeWith&quot;</span><span class="p">,</span>
        <span class="s2">&quot;material&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;components&quot;</span><span class="p">,</span>
        <span class="s2">&quot;area&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="n">newType</span> <span class="o">=</span> <span class="n">composites</span><span class="o">.</span><span class="n">CompositeModelType</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="n">ComponentType</span><span class="o">.</span><span class="n">TYPES</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">newType</span>

        <span class="c1"># the co_varnames attribute contains arguments and then locals so we must</span>
        <span class="c1"># restrict it to just the arguments.</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">newType</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_varnames</span><span class="p">[</span>
            <span class="mi">1</span> <span class="p">:</span> <span class="n">newType</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span>
        <span class="p">]</span>

        <span class="c1"># INIT_SIGNATURE and DIMENSION_NAMES are in the same order as the method signature</span>
        <span class="n">newType</span><span class="o">.</span><span class="n">INIT_SIGNATURE</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
        <span class="n">newType</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">k</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">newType</span><span class="o">.</span><span class="n">INIT_SIGNATURE</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ComponentType</span><span class="o">.</span><span class="n">NON_DIMENSION_NAMES</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">newType</span></div>


<div class="viewcode-block" id="Component"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component">[docs]</a><span class="k">class</span> <span class="nc">Component</span><span class="p">(</span><span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ComponentType</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A primitive object in a reactor that has definite area/volume, material and composition.</span>

<span class="sd">    Could be fuel pins, cladding, duct, wire wrap, etc. One component object may represent</span>
<span class="sd">    multiple physical components via the ``multiplicity`` mechanism.</span>

<span class="sd">    .. impl:: Define a physical piece of a reactor.</span>
<span class="sd">        :id: I_ARMI_COMP_DEF</span>
<span class="sd">        :implements: R_ARMI_COMP_DEF</span>

<span class="sd">        The primitive object in an ARMI reactor is a Component. A Component is comprised</span>
<span class="sd">        of a shape and composition. This class serves as a base class which all</span>
<span class="sd">        Component types within ARMI are built upon. All primitive shapes (such as a</span>
<span class="sd">        square, circle, holed hexagon, helix etc.) are derived from this base class.</span>

<span class="sd">        Fundamental capabilities of this class include the ability to store parameters</span>
<span class="sd">        and attributes which describe the physical state of each Component within the</span>
<span class="sd">        ARMI data model.</span>

<span class="sd">    .. impl:: Order Components by their outermost diameter (using the &lt; operator).</span>
<span class="sd">        :id: I_ARMI_COMP_ORDER</span>
<span class="sd">        :implements: R_ARMI_COMP_ORDER</span>

<span class="sd">        Determining Component order by outermost diameters is implemented via</span>
<span class="sd">        the ``__lt__()`` method, which is used to control ``sort()`` as the</span>
<span class="sd">        standard approach in Python. However, ``__lt__()`` does not show up in the API.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    temperatureInC : float</span>
<span class="sd">        Current temperature of component in celcius.</span>
<span class="sd">    inputTemperatureInC : float</span>
<span class="sd">        Reference temperature in C at which dimension definitions were input</span>
<span class="sd">    temperatureInC : float</span>
<span class="sd">        Temperature in C to which dimensions were thermally-expanded upon input.</span>
<span class="sd">    material : str or material.Material</span>
<span class="sd">        The material object that makes up this component and give it its thermo-mechanical properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DIMENSION_NAMES</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>  <span class="c1"># will be assigned by ComponentType</span>
    <span class="n">INIT_SIGNATURE</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>  <span class="c1"># will be assigned by ComponentType</span>

    <span class="n">is3D</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># flag to show that area is 2D by default</span>

    <span class="n">_COMP_REPORT_GROUPS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;intercoolant&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">INTERCOOLANT_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;bond&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">BOND_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;duct&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">DUCT_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;coolant&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">COOLANT_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;clad&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">CLAD_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;fuel&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">FUEL_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;wire&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">WIRE_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;liner&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">LINER_DIMS</span><span class="p">,</span>
        <span class="s2">&quot;gap&quot;</span><span class="p">:</span> <span class="n">report</span><span class="o">.</span><span class="n">GAP_DIMS</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">_TOLERANCE</span> <span class="o">=</span> <span class="mf">1e-10</span>

    <span class="n">THERMAL_EXPANSION_DIMS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">pDefs</span> <span class="o">=</span> <span class="n">componentParameters</span><span class="o">.</span><span class="n">getComponentParameterDefinitions</span><span class="p">()</span>

    <span class="n">material</span><span class="p">:</span> <span class="n">materials</span><span class="o">.</span><span class="n">Material</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">material</span><span class="p">,</span>
        <span class="n">Tinput</span><span class="p">,</span>
        <span class="n">Thot</span><span class="p">,</span>
        <span class="n">area</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">isotopics</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">mergeWith</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">components</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Non-unique component name </span><span class="si">{}</span><span class="s2"> repeated in same block.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="n">componentTypeIsValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputTemperatureInC</span> <span class="o">=</span> <span class="n">Tinput</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span> <span class="o">=</span> <span class="n">Thot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setProperties</span><span class="p">(</span><span class="n">material</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applyMaterialMassFracsToNumberDensities</span><span class="p">()</span>  <span class="c1"># not necessary when duplicating...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">mergeWith</span> <span class="o">=</span> <span class="n">mergeWith</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">customIsotopicsName</span> <span class="o">=</span> <span class="n">isotopics</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temperatureInC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the hot temperature in Celsius.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">temperatureInC</span>

    <span class="nd">@temperatureInC</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">temperatureInC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the hot temperature in Celsius.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">temperatureInC</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temperatureInK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Current hot temperature in Kelvin.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span> <span class="o">+</span> <span class="n">C_TO_K</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if a circle encompassing this object has a smaller diameter than one encompassing another component.</span>

<span class="sd">        This allows sorting because the Python sort functions only use this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">thisOD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBoundingCircleOuterDiameter</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">thatOD</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">getBoundingCircleOuterDiameter</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">thisOD</span> <span class="o">&lt;</span> <span class="n">thatOD</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Components 1 (</span><span class="si">{}</span><span class="s2"> with OD </span><span class="si">{}</span><span class="s2">) and 2 (</span><span class="si">{}</span><span class="s2"> and OD </span><span class="si">{}</span><span class="s2">) cannot be ordered because their &quot;</span>
                <span class="s2">&quot;bounding circle outer diameters are not comparable.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">thisOD</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">thatOD</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_linkAndStoreDimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="o">**</span><span class="n">dims</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Link dimensions to another component.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dims</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setDimension</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">components</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resolveLinkedDims</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>

<div class="viewcode-block" id="Component.resolveLinkedDims"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.resolveLinkedDims">[docs]</a>    <span class="k">def</span> <span class="nf">resolveLinkedDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert dimension link strings to actual links.</span>

<span class="sd">        .. impl:: The volume of some defined shapes depend on the solid components surrounding them.</span>
<span class="sd">            :id: I_ARMI_COMP_FLUID1</span>
<span class="sd">            :implements: R_ARMI_COMP_FLUID</span>

<span class="sd">            Some Components are fluids and are thus defined by the shapes surrounding</span>
<span class="sd">            them. This method cycles through each dimension defining the border of this</span>
<span class="sd">            Component and converts the name of that Component to a link to the object</span>
<span class="sd">            itself. This series of links is then used downstream to resolve</span>
<span class="sd">            dimensional information.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">match</span> <span class="o">=</span> <span class="n">COMPONENT_LINK_REGEX</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">comp</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                    <span class="n">linkedKey</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span> <span class="o">=</span> <span class="n">_DimensionLink</span><span class="p">((</span><span class="n">comp</span><span class="p">,</span> <span class="n">linkedKey</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Component names should not have periods in them: `</span><span class="si">{}</span><span class="s2">`&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">value</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                            <span class="s2">&quot;Bad component link `</span><span class="si">{}</span><span class="s2">` defined as `</span><span class="si">{}</span><span class="s2">`&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">dimName</span><span class="p">,</span> <span class="n">value</span>
                            <span class="p">)</span>
                        <span class="p">)</span></div>

<div class="viewcode-block" id="Component.setLink"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setLink">[docs]</a>    <span class="k">def</span> <span class="nf">setLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">otherComp</span><span class="p">,</span> <span class="n">otherCompKey</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the dimension link.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_DimensionLink</span><span class="p">((</span><span class="n">otherComp</span><span class="p">,</span> <span class="n">otherCompKey</span><span class="p">))</span></div>

<div class="viewcode-block" id="Component.setProperties"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setProperties">[docs]</a>    <span class="k">def</span> <span class="nf">setProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">properties</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply thermo-mechanical properties of a Material.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">materials</span><span class="o">.</span><span class="n">resolveMaterialClassByName</span><span class="p">(</span><span class="n">properties</span><span class="p">)()</span>
            <span class="c1"># note that the material will not be expanded to natural isotopics</span>
            <span class="c1"># here because the user-input blueprints information is not available</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="n">mat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearLinkedCache</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.applyMaterialMassFracsToNumberDensities"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.applyMaterialMassFracsToNumberDensities">[docs]</a>    <span class="k">def</span> <span class="nf">applyMaterialMassFracsToNumberDensities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the hot number densities for the component based on material mass fractions/density.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - the density returned accounts for the expansion of the component</span>
<span class="sd">          due to the difference in self.inputTemperatureInC and self.temperatureInC</span>
<span class="sd">        - After the expansion, the density of the component should reflect the 3d</span>
<span class="sd">          density of the material</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># note, that this is not the actual material density, but rather 2D expanded</span>
        <span class="c1"># `density` is 3D density</span>
        <span class="c1"># call getProperty to cache and improve speed</span>
        <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s2">&quot;pseudoDensity&quot;</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span> <span class="o">=</span> <span class="n">densityTools</span><span class="o">.</span><span class="n">getNDensFromMasses</span><span class="p">(</span>
            <span class="n">density</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">massFrac</span>
        <span class="p">)</span>

        <span class="c1"># material needs to be expanded from the material&#39;s cold temp to hot,</span>
        <span class="c1"># not components cold temp, so we don&#39;t use mat.linearExpansionFactor or</span>
        <span class="c1"># component.getThermalExpansionFactor.</span>
        <span class="c1"># Materials don&#39;t typically define the temperature for which their references</span>
        <span class="c1"># density is defined so linearExpansionPercent must be called</span>
        <span class="n">coldMatAxialExpansionFactor</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeNDensByFactor</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">coldMatAxialExpansionFactor</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.adjustDensityForHeightExpansion"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.adjustDensityForHeightExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">adjustDensityForHeightExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newHot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the densities in cases where height of the block/component is changing with expansion.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Call before setTemperature since we need old hot temp.</span>
<span class="sd">        This works well if there is only 1 solid component.</span>
<span class="sd">        If there are multiple components expanding at different rates during thermal</span>
<span class="sd">        expansion this becomes more complicated and, and axial expansion should be used.</span>
<span class="sd">        Multiple expansion rates cannot trivially be accommodated.</span>
<span class="sd">        See AxialExpansionChanger.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeNDensByFactor</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">getHeightFactor</span><span class="p">(</span><span class="n">newHot</span><span class="p">))</span></div>

<div class="viewcode-block" id="Component.getHeightFactor"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getHeightFactor">[docs]</a>    <span class="k">def</span> <span class="nf">getHeightFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newHot</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the factor by which height would change by if we did 3D expansion.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Call before setTemperature since we need old hot temp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getThermalExpansionFactor</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">newHot</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getProperties"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getProperties">[docs]</a>    <span class="k">def</span> <span class="nf">getProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the active Material object defining thermo-mechanical properties.</span>

<span class="sd">        .. impl:: Material properties are retrievable.</span>
<span class="sd">            :id: I_ARMI_COMP_MAT0</span>
<span class="sd">            :implements: R_ARMI_COMP_MAT</span>

<span class="sd">            This method returns the material object that is assigned to the Component.</span>

<span class="sd">        .. impl:: Components have one-and-only-one material.</span>
<span class="sd">            :id: I_ARMI_COMP_1MAT</span>
<span class="sd">            :implements: R_ARMI_COMP_1MAT</span>

<span class="sd">            This method returns the material object that is assigned to the Component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquidPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">liquidPorosity</span>

    <span class="nd">@liquidPorosity</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">liquidPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">porosity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">liquidPorosity</span> <span class="o">=</span> <span class="n">porosity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gasPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">gasPorosity</span>

    <span class="nd">@gasPorosity</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">gasPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">porosity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">gasPorosity</span> <span class="o">=</span> <span class="n">porosity</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Duplicate a component, used for breaking fuel into separate components.&quot;&quot;&quot;</span>
        <span class="n">linkedDims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLinkedDimsAndValues</span><span class="p">()</span>
        <span class="n">newC</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restoreLinkedDims</span><span class="p">(</span><span class="n">linkedDims</span><span class="p">)</span>
        <span class="n">newC</span><span class="o">.</span><span class="n">_restoreLinkedDims</span><span class="p">(</span><span class="n">linkedDims</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newC</span>

<div class="viewcode-block" id="Component.setLumpedFissionProducts"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setLumpedFissionProducts">[docs]</a>    <span class="k">def</span> <span class="nf">setLumpedFissionProducts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lfpCollection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets lumped fission product collection on a lfp compatible material if possible.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span><span class="o">.</span><span class="n">setLumpedFissionProducts</span><span class="p">(</span><span class="n">lfpCollection</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># This material doesn&#39;t setLumpedFissionProducts because it&#39;s a regular</span>
            <span class="c1"># material, not a lumpedFissionProductCompatable material</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="Component.getArea"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getArea">[docs]</a>    <span class="k">def</span> <span class="nf">getArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the area of a Component in cm^2.</span>

<span class="sd">        .. impl:: Get a dimension of a Component.</span>
<span class="sd">            :id: I_ARMI_COMP_VOL0</span>
<span class="sd">            :implements: R_ARMI_COMP_VOL</span>

<span class="sd">            This method returns the area of a Component.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        block.getVolumeFractions: component coolant is typically the &quot;leftover&quot; and is calculated and set here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">area</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getComponentArea</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;modArea&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">comp</span><span class="p">,</span> <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">modArea</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;sub&quot;</span><span class="p">:</span>
                <span class="n">area</span> <span class="o">-=</span> <span class="n">comp</span><span class="o">.</span><span class="n">getComponentArea</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;add&quot;</span><span class="p">:</span>
                <span class="n">area</span> <span class="o">+=</span> <span class="n">comp</span><span class="o">.</span><span class="n">getComponentArea</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Option </span><span class="si">{}</span><span class="s2"> does not exist&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkNegativeArea</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">cold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">area</span></div>

<div class="viewcode-block" id="Component.getVolume"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getVolume">[docs]</a>    <span class="k">def</span> <span class="nf">getVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the volume [cm^3] of the Component.</span>

<span class="sd">        .. impl:: Get a dimension of a Component.</span>
<span class="sd">            :id: I_ARMI_COMP_VOL1</span>
<span class="sd">            :implements: R_ARMI_COMP_VOL</span>

<span class="sd">            This method returns the volume of a Component.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        ``self.p.volume`` is not set until this method is called,</span>
<span class="sd">        so under most circumstances it is probably not safe to</span>
<span class="sd">        access ``self.p.volume`` directly. This is because not</span>
<span class="sd">        all components (e.g., ``DerivedShape``) can compute</span>
<span class="sd">        their volume during initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updateVolume</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> has undefined volume.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span></div>

<div class="viewcode-block" id="Component.clearCache"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.clearCache">[docs]</a>    <span class="k">def</span> <span class="nf">clearCache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalidate the volume so that it will be recomputed from current dimensions upon next access.</span>

<span class="sd">        The updated value will be based on its shape and current dimensions.</span>
<span class="sd">        If there is a parent container and that container contains a DerivedShape, then that must be</span>
<span class="sd">        updated as well since its volume may be changing.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        clearLinkedCache: Clears cache of components that depend on this component&#39;s dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">derivedMustUpdate</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_updateVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recompute and store volume.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">computeVolume</span><span class="p">()</span>

<div class="viewcode-block" id="Component.computeVolume"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.computeVolume">[docs]</a>    <span class="k">def</span> <span class="nf">computeVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute volume.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3D</span><span class="p">:</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getArea</span><span class="p">()</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getHeight</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getComponentVolume</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkNegativeVolume</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">volume</span></div>

    <span class="k">def</span> <span class="nf">_checkNegativeArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">cold</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check for negative area and warn/error when appropriate.</span>

<span class="sd">        Negative component area is allowed for Void materials (such as gaps)</span>
<span class="sd">        which may be placed between components that will overlap during thermal expansion</span>
<span class="sd">        (such as liners and cladding and annular fuel).</span>

<span class="sd">        Overlapping is allowed to maintain conservation of atoms while sticking close to the</span>
<span class="sd">        as-built geometry. Modules that need true geometries will have to handle this themselves.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">area</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">area</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">cold</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">containsVoidMaterial</span><span class="p">()</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">containsSolidMaterial</span><span class="p">():</span>
                <span class="n">negAreaFailure</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Component </span><span class="si">{}</span><span class="s2"> with </span><span class="si">{}</span><span class="s2"> has cold negative area of </span><span class="si">{}</span><span class="s2"> cm^2. &quot;</span>
                    <span class="s2">&quot;This can be caused by component &quot;</span>
                    <span class="s2">&quot;overlap with component dimension linking or by invalid inputs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">area</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ArithmeticError</span><span class="p">(</span><span class="n">negAreaFailure</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_checkNegativeVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for negative volume.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        self._checkNegativeArea</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">volume</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">containsSolidMaterial</span><span class="p">():</span>
            <span class="n">negVolFailure</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Component </span><span class="si">{}</span><span class="s2"> with </span><span class="si">{}</span><span class="s2"> has cold negative volume of </span><span class="si">{}</span><span class="s2"> cm^3. &quot;</span>
                <span class="s2">&quot;This can be caused by component &quot;</span>
                <span class="s2">&quot;overlap with component dimension linking or by invalid inputs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">volume</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ArithmeticError</span><span class="p">(</span><span class="n">negVolFailure</span><span class="p">)</span>

<div class="viewcode-block" id="Component.containsVoidMaterial"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.containsVoidMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">containsVoidMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if component material is void.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">void</span><span class="o">.</span><span class="n">Void</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.containsSolidMaterial"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.containsSolidMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">containsSolidMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if the component material is a solid.</span>

<span class="sd">        .. impl:: Determine if a material is solid.</span>
<span class="sd">            :id: I_ARMI_COMP_SOLID</span>
<span class="sd">            :implements: R_ARMI_COMP_SOLID</span>

<span class="sd">            For certain operations it is important to know if a Component is a solid or</span>
<span class="sd">            fluid material. This method will return a boolean indicating if the material</span>
<span class="sd">            is solid or not by checking if the material is an instance of the ``material.Fluid`` class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">material</span><span class="o">.</span><span class="n">Fluid</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getComponentArea"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getComponentArea">[docs]</a>    <span class="k">def</span> <span class="nf">getComponentArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the area of this component in cm^2.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cold : bool, optional</span>
<span class="sd">            Compute the area with as-input dimensions instead of thermally-expanded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Component.getComponentVolume"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getComponentVolume">[docs]</a>    <span class="k">def</span> <span class="nf">getComponentVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span></div>

<div class="viewcode-block" id="Component.setVolume"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setVolume">[docs]</a>    <span class="k">def</span> <span class="nf">setVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Component.setArea"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setArea">[docs]</a>    <span class="k">def</span> <span class="nf">setArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Component.setTemperature"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setTemperature">[docs]</a>    <span class="k">def</span> <span class="nf">setTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperatureInC</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust temperature of this component.</span>

<span class="sd">        This will cause thermal expansion or contraction of solid or liquid components and will</span>
<span class="sd">        accordingly adjust number densities to conserve mass.</span>

<span class="sd">        Liquids still have a number density adjustment, but some mass tends to expand in or out of</span>
<span class="sd">        the bounding area.</span>

<span class="sd">        Since some composites have multiple materials in them that thermally expand differently,</span>
<span class="sd">        the axial dimension is generally left unchanged. Hence, this a 2-D thermal expansion.</span>

<span class="sd">        Number density change is proportional to mass density change :math:`\frac{d\rho}{\rho}`.</span>
<span class="sd">        A multiplicative factor :math:`f_N` to apply to number densities when going from T to T&#39;</span>
<span class="sd">        is as follows:</span>

<span class="sd">        .. math::</span>

<span class="sd">            N^{\prime} = N \cdot f_N \\</span>
<span class="sd">            \frac{dN}{N} = f_N - 1</span>

<span class="sd">        Since :math:`\frac{dN}{N} \sim\frac{d\rho}{\rho}`, we have:</span>

<span class="sd">        .. math::</span>

<span class="sd">            f_N  = \frac{d\rho}{\rho} + 1 = \frac{\rho^{\prime}}{\rho}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prevTemp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">temperatureInC</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">getThermalExpansionDensityReduction</span><span class="p">(</span>
            <span class="n">prevTemp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeNDensByFactor</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearLinkedCache</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.getNuclides"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getNuclides">[docs]</a>    <span class="k">def</span> <span class="nf">getNuclides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return nuclides in this component.</span>

<span class="sd">        This includes anything that has been specified in here, including trace nuclides.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span></div>

<div class="viewcode-block" id="Component.getNumberDensity"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getNumberDensity">[docs]</a>    <span class="k">def</span> <span class="nf">getNumberDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number density of nucName, return zero if it does not exist here.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nucName : str</span>
<span class="sd">            Nuclide name</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        number density : float</span>
<span class="sd">            number density in atoms/bn-cm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getNuclideNumberDensities"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getNuclideNumberDensities">[docs]</a>    <span class="k">def</span> <span class="nf">getNuclideNumberDensities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucNames</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of number densities for the nuc names requested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="n">nucNames</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">_getNdensHelper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="p">)</span>

<div class="viewcode-block" id="Component.setName"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setName">[docs]</a>    <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Components use name for type and name.&quot;&quot;&quot;</span>
        <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.setNumberDensity"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setNumberDensity">[docs]</a>    <span class="k">def</span> <span class="nf">setNumberDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucName</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set heterogeneous number density.</span>

<span class="sd">        .. impl:: Setting nuclide fractions.</span>
<span class="sd">            :id: I_ARMI_COMP_NUCLIDE_FRACS0</span>
<span class="sd">            :implements: R_ARMI_COMP_NUCLIDE_FRACS</span>

<span class="sd">            The method allows a user or plugin to set the number density of a Component.</span>
<span class="sd">            It also indicates to other processes that may depend on a Component&#39;s</span>
<span class="sd">            status about this change via the ``assigned`` attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nucName : str</span>
<span class="sd">            nuclide to modify</span>
<span class="sd">        val : float</span>
<span class="sd">            Number density to set in atoms/bn-cm (heterogeneous)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="p">[</span><span class="n">nucName</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">assigned</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SINCE_ANYTHING</span>
        <span class="c1"># necessary for syncMpiState</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">ALL_DEFINITIONS</span><span class="p">[</span>
            <span class="s2">&quot;numberDensities&quot;</span>
        <span class="p">]</span><span class="o">.</span><span class="n">assigned</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SINCE_ANYTHING</span></div>

<div class="viewcode-block" id="Component.setNumberDensities"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setNumberDensities">[docs]</a>    <span class="k">def</span> <span class="nf">setNumberDensities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numberDensities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set one or more multiple number densities. Clears out any number density not listed.</span>

<span class="sd">        .. impl:: Setting nuclide fractions.</span>
<span class="sd">            :id: I_ARMI_COMP_NUCLIDE_FRACS1</span>
<span class="sd">            :implements: R_ARMI_COMP_NUCLIDE_FRACS</span>

<span class="sd">            The method allows a user or plugin to set the number densities of a</span>
<span class="sd">            Component. In contrast to the ``setNumberDensity`` method, it sets all</span>
<span class="sd">            densities within a Component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        numberDensities : dict</span>
<span class="sd">            nucName: ndens pairs.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        We don&#39;t just call setNumberDensity for each nuclide because we don&#39;t want to call ``getVolumeFractions``</span>
<span class="sd">        for each nuclide (it&#39;s inefficient).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span> <span class="o">=</span> <span class="n">numberDensities</span></div>

<div class="viewcode-block" id="Component.updateNumberDensities"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.updateNumberDensities">[docs]</a>    <span class="k">def</span> <span class="nf">updateNumberDensities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numberDensities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set one or more multiple number densities. Leaves unlisted number densities alone.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        numberDensities : dict</span>
<span class="sd">            nucName: ndens pairs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">numberDensities</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">numberDensities</span><span class="p">)</span>
        <span class="c1"># since we&#39;re updating the object the param points to but not the param itself, we have to inform</span>
        <span class="c1"># the param system to flag it as modified so it properly syncs during ``syncMpiState``.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">assigned</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SINCE_ANYTHING</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">paramDefs</span><span class="p">[</span><span class="s2">&quot;numberDensities&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">assigned</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">SINCE_ANYTHING</span></div>

<div class="viewcode-block" id="Component.getEnrichment"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getEnrichment">[docs]</a>    <span class="k">def</span> <span class="nf">getEnrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mass enrichment of this component, as defined by the material.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMassEnrichment</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.getMassEnrichment"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getMassEnrichment">[docs]</a>    <span class="k">def</span> <span class="nf">getMassEnrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the mass enrichment of this component, as defined by the material.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Getting mass enrichment on any level higher than this is ambiguous because you may</span>
<span class="sd">        have enriched boron in one pin and enriched uranium in another and blending those doesn&#39;t make sense.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot get enrichment of </span><span class="si">{}</span><span class="s2"> because `enrichedNuclide` is not defined.&quot;</span>
                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">enrichedNuclide</span> <span class="o">=</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">]</span>
        <span class="n">baselineNucNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="n">enrichedNuclide</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">nuclides</span><span class="p">]</span>
        <span class="n">massFracs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMassFracs</span><span class="p">()</span>
        <span class="n">massFracEnrichedElement</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">massFrac</span>
            <span class="k">for</span> <span class="n">nucName</span><span class="p">,</span> <span class="n">massFrac</span> <span class="ow">in</span> <span class="n">massFracs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="n">baselineNucNames</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">massFracs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">massFracEnrichedElement</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Component.getMass"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getMass">[docs]</a>    <span class="k">def</span> <span class="nf">getMass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nuclideNames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the mass in grams of nuclide(s) and/or elements in this object.</span>

<span class="sd">        .. math::</span>

<span class="sd">            \text{mass} = \frac{\sum_i (N_i \cdot V \cdot  A_i)}{N_A \cdot 10^{-24}}</span>

<span class="sd">        where</span>
<span class="sd">            :math:`N_i` is number density of nuclide i in (1/bn-cm),</span>

<span class="sd">            :math:`V` is the object volume in :math:`cm^3`</span>

<span class="sd">            :math:`N_A` is Avogadro&#39;s number in 1/moles,</span>

<span class="sd">            :math:`A_i` is the atomic weight of of nuclide i in grams/mole</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nuclideNames : str, optional</span>
<span class="sd">            The nuclide/element specifier to get the mass of in the object.</span>
<span class="sd">            If omitted, total mass is returned.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mass : float</span>
<span class="sd">            The mass in grams.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getSymmetryFactor</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="p">)</span>
        <span class="n">nuclideNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getNuclidesFromSpecifier</span><span class="p">(</span><span class="n">nuclideNames</span><span class="p">)</span>
        <span class="c1"># densities comes from self.p.numberDensities</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNuclideNumberDensities</span><span class="p">(</span><span class="n">nuclideNames</span><span class="p">)</span>
        <span class="n">nDens</span> <span class="o">=</span> <span class="p">{</span><span class="n">nuc</span><span class="p">:</span> <span class="n">dens</span> <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">dens</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nuclideNames</span><span class="p">,</span> <span class="n">densities</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">densityTools</span><span class="o">.</span><span class="n">calculateMassDensity</span><span class="p">(</span><span class="n">nDens</span><span class="p">)</span> <span class="o">*</span> <span class="n">volume</span></div>

<div class="viewcode-block" id="Component.setDimension"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setDimension">[docs]</a>    <span class="k">def</span> <span class="nf">setDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">retainLink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a single dimension on the component.</span>

<span class="sd">        .. impl:: Set a Component dimension, considering thermal expansion.</span>
<span class="sd">            :id: I_ARMI_COMP_EXPANSION1</span>
<span class="sd">            :implements: R_ARMI_COMP_EXPANSION</span>

<span class="sd">            Dimensions should be set considering the impact of thermal expansion. This</span>
<span class="sd">            method allows for a user or plugin to set a dimension and indicate if the</span>
<span class="sd">            dimension is for a cold configuration or not. If it is not for a cold</span>
<span class="sd">            configuration, the thermal expansion factor is considered when setting the</span>
<span class="sd">            dimension.</span>

<span class="sd">            If the ``retainLink`` argument is ``True``, any Components linked to this</span>
<span class="sd">            one will also have its dimensions changed consistently. After a dimension</span>
<span class="sd">            is updated, the ``clearLinkedCache`` method is called which sets the</span>
<span class="sd">            volume of this Component to ``None``. This ensures that when the volume is</span>
<span class="sd">            next accessed it is recomputed using the updated dimensions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The dimension key (op, ip, mult, etc.)</span>
<span class="sd">        val : float</span>
<span class="sd">            The value to set on the dimension</span>
<span class="sd">        retainLink : bool, optional</span>
<span class="sd">            If True, the val will be applied to the dimension of linked</span>
<span class="sd">            component which indirectly changes this component&#39;s dimensions.</span>
<span class="sd">        cold : bool, optional</span>
<span class="sd">            If True sets the component cold dimension to the specified value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">retainLink</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensionIsLinked</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="n">linkedComp</span><span class="p">,</span> <span class="n">linkedDimName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">linkedComp</span><span class="o">.</span><span class="n">setDimension</span><span class="p">(</span><span class="n">linkedDimName</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cold</span><span class="p">:</span>
                <span class="n">expansionFactor</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">getThermalExpansionFactor</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">THERMAL_EXPANSION_DIMS</span>
                    <span class="k">else</span> <span class="mf">1.0</span>
                <span class="p">)</span>
                <span class="n">val</span> <span class="o">/=</span> <span class="n">expansionFactor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clearLinkedCache</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.getDimension"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a specific dimension at temperature as determined by key.</span>

<span class="sd">        .. impl:: Retrieve a dimension at a specified temperature.</span>
<span class="sd">            :id: I_ARMI_COMP_DIMS</span>
<span class="sd">            :implements: R_ARMI_COMP_DIMS</span>

<span class="sd">            Due to thermal expansion, Component dimensions depend on their temperature.</span>
<span class="sd">            This method retrieves a dimension from the Component at a particular</span>
<span class="sd">            temperature, if provided. If the Component is a LinkedComponent then the</span>
<span class="sd">            dimensions are resolved to ensure that any thermal expansion that has</span>
<span class="sd">            occurred to the Components that the LinkedComponent depends on is reflected</span>
<span class="sd">            in the returned dimension.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            The dimension key (op, ip, mult, etc.)</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Temperature in C. If None, the current temperature of the component is used.</span>
<span class="sd">        cold : bool, optional</span>
<span class="sd">            If true, will return cold (input) value of the requested dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dimension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">_DimensionLink</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">dimension</span><span class="o">.</span><span class="n">resolveDimension</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dimension</span> <span class="ow">or</span> <span class="n">cold</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">THERMAL_EXPANSION_DIMS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dimension</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getThermalExpansionFactor</span><span class="p">(</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="n">dimension</span></div>

<div class="viewcode-block" id="Component.getBoundingCircleOuterDiameter"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getBoundingCircleOuterDiameter">[docs]</a>    <span class="k">def</span> <span class="nf">getBoundingCircleOuterDiameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Abstract bounding circle method that should be overwritten by each shape subclass.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Component.getCircleInnerDiameter"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getCircleInnerDiameter">[docs]</a>    <span class="k">def</span> <span class="nf">getCircleInnerDiameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Abstract inner circle method that should be overwritten by each shape subclass.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The inner circle is meaningful for annular shapes, i.e., circle with non-zero ID,</span>
<span class="sd">        hexagon with non-zero IP, etc. For shapes with corners (e.g., hexagon, rectangle, etc)</span>
<span class="sd">        the inner circle intersects the corners of the inner bound, opposed to intersecting</span>
<span class="sd">        the &quot;flats&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="Component.dimensionIsLinked"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.dimensionIsLinked">[docs]</a>    <span class="k">def</span> <span class="nf">dimensionIsLinked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if a the specified dimension is linked to another dimension.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">_DimensionLink</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getDimensionNamesLinkedTo"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getDimensionNamesLinkedTo">[docs]</a>    <span class="k">def</span> <span class="nf">getDimensionNamesLinkedTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">otherComponent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find dimension names linked to the other component in this component.&quot;&quot;&quot;</span>
        <span class="n">dimNames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span><span class="p">:</span>
            <span class="n">isLinked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensionIsLinked</span><span class="p">(</span><span class="n">dimName</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">isLinked</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span><span class="o">.</span><span class="n">getLinkedComponent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">otherComponent</span><span class="p">:</span>
                <span class="n">dimNames</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">dimName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">dimNames</span></div>

<div class="viewcode-block" id="Component.clearLinkedCache"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.clearLinkedCache">[docs]</a>    <span class="k">def</span> <span class="nf">clearLinkedCache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear this cache and any other dependent volumes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearCache</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="c1"># changes in dimensions can affect cached variables such as pitch</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">cached</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLinkedComponents</span><span class="p">():</span>
                <span class="c1"># no clearCache since parent already updated derivedMustUpdate in self.clearCache()</span>
                <span class="n">c</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Component.getLinkedComponents"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getLinkedComponents">[docs]</a>    <span class="k">def</span> <span class="nf">getLinkedComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find other components that are linked to this component.&quot;&quot;&quot;</span>
        <span class="n">dependents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getChildren</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span><span class="p">:</span>
                <span class="n">isLinked</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">dimensionIsLinked</span><span class="p">(</span><span class="n">dimName</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">isLinked</span> <span class="ow">and</span> <span class="n">child</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span><span class="o">.</span><span class="n">getLinkedComponent</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="n">dependents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dependents</span></div>

<div class="viewcode-block" id="Component.getThermalExpansionFactor"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getThermalExpansionFactor">[docs]</a>    <span class="k">def</span> <span class="nf">getThermalExpansionFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the material thermal expansion fraction.</span>

<span class="sd">        .. impl:: Calculates radial thermal expansion factor.</span>
<span class="sd">            :id: I_ARMI_COMP_EXPANSION0</span>
<span class="sd">            :implements: R_ARMI_COMP_EXPANSION</span>

<span class="sd">            This method enables the calculation of the thermal expansion factor</span>
<span class="sd">            for a given material. If the material is solid, the difference</span>
<span class="sd">            between ``T0`` and ``Tc`` is used to calculate the thermal expansion</span>
<span class="sd">            factor. If a solid material does not have a linear expansion factor</span>
<span class="sd">            defined and the temperature difference is greater than</span>
<span class="sd">            a predetermined tolerance, an</span>
<span class="sd">            error is raised. Thermal expansion of fluids or custom materials is</span>
<span class="sd">            neglected, currently.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tc : float, optional</span>
<span class="sd">            Adjusted temperature to get the thermal expansion factor at relative to the reference temperature</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Thermal expansion factor as a percentage (1.0 + dLL), where dLL is the linear expansion factor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">Fluid</span><span class="p">,</span> <span class="n">custom</span><span class="o">.</span><span class="n">Custom</span><span class="p">)):</span>
            <span class="k">return</span> <span class="mf">1.0</span>  <span class="c1"># No thermal expansion of fluids or custom materials</span>

        <span class="k">if</span> <span class="n">T0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">T0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputTemperatureInC</span>
        <span class="k">if</span> <span class="n">Tc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Tc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span>

        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">linearExpansionFactor</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">T0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dLL</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">T0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TOLERANCE</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Linear expansion percent may not be implemented in the </span><span class="si">{}</span><span class="s2"> material class.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;This method needs to be implemented on the material to allow thermal expansion.&quot;</span>
                <span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">Reference temperature: </span><span class="si">{}</span><span class="s2">, Adjusted temperature: </span><span class="si">{}</span><span class="s2">, Temperature difference: </span><span class="si">{}</span><span class="s2">, &quot;</span>
                <span class="s2">&quot;Specified tolerance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">T0</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="p">(</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">T0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TOLERANCE</span>
                <span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Linear expansion percent may not be implemented in the </span><span class="si">{}</span><span class="s2"> material &quot;</span>
                <span class="s2">&quot;class.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">dLL</span></div>

<div class="viewcode-block" id="Component.printContents"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.printContents">[docs]</a>    <span class="k">def</span> <span class="nf">printContents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeNuclides</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a listing of the dimensions and composition of this component.&quot;&quot;&quot;</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDimensionReport</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">includeNuclides</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">():</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{0:10s}</span><span class="s2"> </span><span class="si">{1:.7e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumberDensity</span><span class="p">(</span><span class="n">nuc</span><span class="p">))</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Component.setDimensionReport"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.setDimensionReport">[docs]</a>    <span class="k">def</span> <span class="nf">setDimensionReport</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gives a report of the dimensions of this component.&quot;&quot;&quot;</span>
        <span class="n">reportGroup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">componentType</span><span class="p">,</span> <span class="n">componentReport</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COMP_REPORT_GROUPS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">componentType</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">():</span>
                <span class="n">reportGroup</span> <span class="o">=</span> <span class="n">componentReport</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reportGroup</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;No report group designated for </span><span class="si">{}</span><span class="s2"> component.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
        <span class="n">reportGroup</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Tcold (</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputTemperatureInC</span><span class="p">),</span>
            <span class="s2">&quot;Thot (</span><span class="si">{0}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;modArea&quot;</span><span class="p">,</span> <span class="s2">&quot;area&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">}</span>  <span class="c1"># py3 cannot format None</span>
        <span class="c1"># Set component name and material</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">reportGroup</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="s2">&quot;Material&quot;</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getProperties</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">reportGroup</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
            <span class="n">niceName</span> <span class="o">=</span> <span class="n">_NICE_DIM_NAMES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dimName</span><span class="p">,</span> <span class="n">dimName</span><span class="p">)</span>
            <span class="n">refVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="n">dimName</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">hotVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="n">dimName</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">niceName</span><span class="p">,</span> <span class="p">[</span><span class="n">refVal</span><span class="p">,</span> <span class="n">hotVal</span><span class="p">],</span> <span class="n">reportGroup</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> has an invalid dimension for </span><span class="si">{1}</span><span class="s2">. refVal: </span><span class="si">{2}</span><span class="s2"> hotVal: </span><span class="si">{3}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">dimName</span><span class="p">,</span> <span class="n">refVal</span><span class="p">,</span> <span class="n">hotVal</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># calculate thickness if applicable.</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;ip&quot;</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>

        <span class="k">if</span> <span class="n">suffix</span><span class="p">:</span>
            <span class="n">coldIn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;i</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suffix</span><span class="p">),</span> <span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">hotIn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;i</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suffix</span><span class="p">))</span>
            <span class="n">coldOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;o</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suffix</span><span class="p">),</span> <span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">hotOut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;o</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suffix</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">suffix</span> <span class="ow">and</span> <span class="n">coldIn</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">hotThick</span> <span class="o">=</span> <span class="p">(</span><span class="n">hotOut</span> <span class="o">-</span> <span class="n">hotIn</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="n">coldThick</span> <span class="o">=</span> <span class="p">(</span><span class="n">coldOut</span> <span class="o">-</span> <span class="n">coldIn</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Thickness (cm)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{0:.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coldThick</span><span class="p">),</span>
                <span class="s2">&quot;</span><span class="si">{0:.7f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hotThick</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">reportGroup</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">report</span><span class="o">.</span><span class="n">ALL</span><span class="p">[</span><span class="n">reportGroup</span><span class="p">]</span></div>

<div class="viewcode-block" id="Component.updateDims"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.updateDims">[docs]</a>    <span class="k">def</span> <span class="nf">updateDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDimension</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.mergeNuclidesInto"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.mergeNuclidesInto">[docs]</a>    <span class="k">def</span> <span class="nf">mergeNuclidesInto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compToMergeWith</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set another component&#39;s number densities to reflect this one merged into it.</span>

<span class="sd">        You must also modify the geometry of the other component and remove this component to</span>
<span class="sd">        conserve atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># record pre-merged number densities and areas</span>
        <span class="n">aMe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getArea</span><span class="p">()</span>
        <span class="n">aMerge</span> <span class="o">=</span> <span class="n">compToMergeWith</span><span class="o">.</span><span class="n">getArea</span><span class="p">()</span>
        <span class="n">meNDens</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">nucName</span><span class="p">:</span> <span class="n">aMe</span> <span class="o">/</span> <span class="n">aMerge</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNumberDensity</span><span class="p">(</span><span class="n">nucName</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">mergeNDens</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">nucName</span><span class="p">:</span> <span class="n">compToMergeWith</span><span class="o">.</span><span class="n">getNumberDensity</span><span class="p">(</span><span class="n">nucName</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="n">compToMergeWith</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="c1"># set the new homogenized number densities from both. Allow</span>
        <span class="c1"># overlapping nuclides.</span>
        <span class="k">for</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">meNDens</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">mergeNDens</span><span class="p">):</span>
            <span class="n">compToMergeWith</span><span class="o">.</span><span class="n">setNumberDensity</span><span class="p">(</span>
                <span class="n">nucName</span><span class="p">,</span> <span class="p">(</span><span class="n">meNDens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="n">mergeNDens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="Component.iterComponents"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.iterComponents">[docs]</a>    <span class="k">def</span> <span class="nf">iterComponents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typeSpec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasFlags</span><span class="p">(</span><span class="n">typeSpec</span><span class="p">,</span> <span class="n">exact</span><span class="p">):</span>
            <span class="k">yield</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Component.backUp"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.backUp">[docs]</a>    <span class="k">def</span> <span class="nf">backUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and store a backup of the state.</span>

<span class="sd">        This needed to be overridden due to linked components which actually have a parameter value of another</span>
<span class="sd">        ARMI component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">linkedDims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLinkedDimsAndValues</span><span class="p">()</span>
        <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="n">backUp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restoreLinkedDims</span><span class="p">(</span><span class="n">linkedDims</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.restoreBackup"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.restoreBackup">[docs]</a>    <span class="k">def</span> <span class="nf">restoreBackup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paramsToApply</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restore the parameters from perviously created backup.</span>

<span class="sd">        This needed to be overridden due to linked components which actually have a parameter value</span>
<span class="sd">        of another ARMI component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">linkedDims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getLinkedDimsAndValues</span><span class="p">()</span>
        <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="n">restoreBackup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paramsToApply</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_restoreLinkedDims</span><span class="p">(</span><span class="n">linkedDims</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_getLinkedDimsAndValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">linkedDims</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span><span class="p">:</span>
            <span class="c1"># backUp and restore are called in tight loops, getting the value and checking here is</span>
            <span class="c1"># faster than calling self.dimensionIsLinked because that requires and extra</span>
            <span class="c1"># p.__getitem__</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Could not find parameter </span><span class="si">{}</span><span class="s2"> defined for </span><span class="si">{}</span><span class="s2">. Is the desired &quot;</span>
                    <span class="s2">&quot;Component class?&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dimName</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">_DimensionLink</span><span class="p">):</span>
                <span class="n">linkedDims</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">paramDefs</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span><span class="o">.</span><span class="n">fieldName</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">linkedDims</span>

    <span class="k">def</span> <span class="nf">_restoreLinkedDims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linkedDims</span><span class="p">):</span>
        <span class="c1"># force update without setting the &quot;.assigned&quot; flag</span>
        <span class="k">for</span> <span class="n">fieldName</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">linkedDims</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">fieldName</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Component.adjustMassEnrichment"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.adjustMassEnrichment">[docs]</a>    <span class="k">def</span> <span class="nf">adjustMassEnrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">massFraction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the mass fraction of this component.</span>

<span class="sd">        The nuclides to adjust are defined by the material. This changes whichever nuclides are to</span>
<span class="sd">        be enriched vs. the baseline nuclides of that element while holding mass constant. For</span>
<span class="sd">        example it might adjust boron or uranium enrichment.</span>

<span class="sd">        Conceptually, you could hold number of atoms, volume, or mass constant during this</span>
<span class="sd">        operation. Historically ARMI adjusted mass fractions which was meant to keep mass constant.</span>

<span class="sd">        If you have 20 mass % Uranium and adjust the enrichment, you will still have 20% Uranium</span>
<span class="sd">        mass. But, the actual mass actually might change a bit because the enriched nuclide weighs</span>
<span class="sd">        less.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Material.enrichedNuclide</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot adjust enrichment of </span><span class="si">{}</span><span class="s2"> because `enrichedNuclide` is not defined.&quot;</span>
                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">enrichedNuclide</span> <span class="o">=</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">]</span>
        <span class="n">baselineNucNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="n">enrichedNuclide</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">nuclides</span><span class="p">]</span>
        <span class="n">massFracsBefore</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMassFracs</span><span class="p">()</span>
        <span class="n">massFracEnrichedElement</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">massFrac</span>
            <span class="k">for</span> <span class="n">nucName</span><span class="p">,</span> <span class="n">massFrac</span> <span class="ow">in</span> <span class="n">massFracsBefore</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nucName</span> <span class="ow">in</span> <span class="n">baselineNucNames</span>
        <span class="p">)</span>

        <span class="n">adjustedMassFracs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">:</span> <span class="n">massFracEnrichedElement</span> <span class="o">*</span> <span class="n">massFraction</span>
        <span class="p">}</span>

        <span class="n">baselineNucNames</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">)</span>
        <span class="n">massFracTotalUnenriched</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">massFracEnrichedElement</span> <span class="o">-</span> <span class="n">massFracsBefore</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">baseNucName</span> <span class="ow">in</span> <span class="n">baselineNucNames</span><span class="p">:</span>
            <span class="c1"># maintain relative mass fractions of baseline nuclides.</span>
            <span class="n">frac</span> <span class="o">=</span> <span class="n">massFracsBefore</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">baseNucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">massFracTotalUnenriched</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">frac</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">adjustedMassFracs</span><span class="p">[</span><span class="n">baseNucName</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">massFracEnrichedElement</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">massFraction</span><span class="p">)</span> <span class="o">*</span> <span class="n">frac</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMassFracs</span><span class="p">(</span><span class="n">adjustedMassFracs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getIntegratedMgFlux"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getIntegratedMgFlux">[docs]</a>    <span class="k">def</span> <span class="nf">getIntegratedMgFlux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adjoint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the multigroup neutron tracklength in [n-cm/s].</span>

<span class="sd">        The first entry is the first energy group (fastest neutrons). Each additional group is the</span>
<span class="sd">        next energy group, as set in the ISOTXS library.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        adjoint : bool, optional</span>
<span class="sd">            Return adjoint flux instead of real</span>
<span class="sd">        gamma : bool, optional</span>
<span class="sd">            Whether to return the neutron flux or the gamma flux.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        integratedFlux : multigroup neutron tracklength in [n-cm/s]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pinNum</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># no pin-level flux is available</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">volumeFraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">volumeFraction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getIntegratedMgFlux</span><span class="p">(</span><span class="n">adjoint</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>

        <span class="c1"># pin-level flux is available. Note that it is NOT integrated on the param level.</span>
        <span class="k">if</span> <span class="n">gamma</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">adjoint</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Adjoint gamma flux is currently unsupported.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pinFluxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pinMgFluxesGamma</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">adjoint</span><span class="p">:</span>
                <span class="n">pinFluxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pinMgFluxesAdj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pinFluxes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pinMgFluxes</span>

        <span class="k">return</span> <span class="n">pinFluxes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pinNum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.getPinMgFluxes"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getPinMgFluxes">[docs]</a>    <span class="k">def</span> <span class="nf">getPinMgFluxes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">adjoint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the pin multigroup fluxes for the component.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        adjoint : bool, optional</span>
<span class="sd">            Return adjoint flux instead of real</span>
<span class="sd">        gamma : bool, optional</span>
<span class="sd">            Whether to return the neutron flux or the gamma flux.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            A ``(N, nGroup)`` array of pin multigroup fluxes, where ``N`` is the</span>
<span class="sd">            equivalent to the multiplicity of the component (``self.p.mult``)</span>
<span class="sd">            and ``nGroup`` is the number of energy groups of the flux.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the location(s) of the component are not aligned with pin indices</span>
<span class="sd">            from the block. This would happen if this component is not actually</span>
<span class="sd">            a pin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the (i, j, k) location of all pins from the parent block</span>
        <span class="n">indicesAll</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">j</span><span class="p">):</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getPinLocations</span><span class="p">())</span>
        <span class="p">}</span>

        <span class="c1"># Retrieve the indices of this component</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spatialLocator</span><span class="p">,</span> <span class="n">grids</span><span class="o">.</span><span class="n">MultiIndexLocation</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">loc</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="n">loc</span><span class="o">.</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialLocator</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">spatialLocator</span><span class="o">.</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialLocator</span><span class="o">.</span><span class="n">j</span><span class="p">)]</span>

        <span class="c1"># Map this component&#39;s indices to block&#39;s pin indices</span>
        <span class="n">indexMap</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">indicesAll</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">indexMap</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to retrieve pin indices for component </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Get the parameter name we are trying to retrieve</span>
        <span class="k">if</span> <span class="n">gamma</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">adjoint</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Adjoint gamma flux is currently unsupported.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">param</span> <span class="o">=</span> <span class="s2">&quot;pinMgFluxesGamma&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">adjoint</span><span class="p">:</span>
                <span class="n">param</span> <span class="o">=</span> <span class="s2">&quot;pinMgFluxesAdj&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">param</span> <span class="o">=</span> <span class="s2">&quot;pinMgFluxes&quot;</span>

        <span class="c1"># Return pin fluxes</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">indexMap</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ee</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failure getting </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> via parent </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">ee</span></div>

<div class="viewcode-block" id="Component.density"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the mass density of the object in g/cc.&quot;&quot;&quot;</span>
        <span class="n">density</span> <span class="o">=</span> <span class="n">composites</span><span class="o">.</span><span class="n">Composite</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">density</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">void</span><span class="o">.</span><span class="n">Void</span><span class="p">):</span>
            <span class="c1"># possible that there are no nuclides in this component yet. In that case,</span>
            <span class="c1"># defer to Material. Material.density is wrapped to warn if it&#39;s attached</span>
            <span class="c1"># to a parent. Avoid that by calling the inner function directly</span>
            <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">__wrapped__</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temperatureInC</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">density</span></div>

<div class="viewcode-block" id="Component.getLumpedFissionProductCollection"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getLumpedFissionProductCollection">[docs]</a>    <span class="k">def</span> <span class="nf">getLumpedFissionProductCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get collection of LFP objects. Will work for global or block-level LFP models.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lfps : LumpedFissionProduct</span>
<span class="sd">            lfpName keys , lfp object values</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        armi.physics.neutronics.fissionProductModel.lumpedFissionProduct.LumpedFissionProduct : LFP object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getLumpedFissionProductCollection</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">composites</span><span class="o">.</span><span class="n">ArmiObject</span><span class="o">.</span><span class="n">getLumpedFissionProductCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Component.getMicroSuffix"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getMicroSuffix">[docs]</a>    <span class="k">def</span> <span class="nf">getMicroSuffix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getMicroSuffix</span><span class="p">()</span></div>

<div class="viewcode-block" id="Component.getPitchData"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getPitchData">[docs]</a>    <span class="k">def</span> <span class="nf">getPitchData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the pitch data that should be used to determine block pitch.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This pitch data should only be used if this is the pitch defining component in a block. The</span>
<span class="sd">        block is responsible for determining which component in it is the pitch defining component.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Method not implemented on component </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;Please implement if this component type can be a pitch defining component.&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Component.getFuelMass"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.getFuelMass">[docs]</a>    <span class="k">def</span> <span class="nf">getFuelMass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass in grams if this is a fueled component.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMass</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasFlags</span><span class="p">(</span><span class="n">flags</span><span class="o">.</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Component.finalizeLoadingFromDB"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component.finalizeLoadingFromDB">[docs]</a>    <span class="k">def</span> <span class="nf">finalizeLoadingFromDB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply any final actions after creating the component from database.</span>

<span class="sd">        This should **only** be called internally by the database loader. Otherwise</span>
<span class="sd">        some properties could be doubly applied.</span>

<span class="sd">        This exists because the theoretical density is initially defined as a material</span>
<span class="sd">        modification, and then stored as a Material attribute. When reading from blueprints,</span>
<span class="sd">        the blueprint loader sets the theoretical density parameter from the Material</span>
<span class="sd">        attribute. Component parameters are also set when reading from the database.</span>
<span class="sd">        But, we need to set the Material attribute so routines that fetch a material&#39;s</span>
<span class="sd">        density property account for the theoretical density.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">adjustTD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ShapedComponent"><a class="viewcode-back" href="../../../../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.ShapedComponent">[docs]</a><span class="k">class</span> <span class="nc">ShapedComponent</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A component with well-defined dimensions.&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2025, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2025-01-03.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>