

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>armi.materials.material &mdash; ARMI 0.1.4 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/armiicon_16x16.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> ARMI
          

          
            
            <img src="../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../.apidocs/modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../armi.html">armi</a> &raquo;</li>
        
          <li><a href="../materials.html">armi.materials</a> &raquo;</li>
        
      <li>armi.materials.material</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for armi.materials.material</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Base Material classes.</span>

<span class="sd">All temperatures are in K, but Tc can be specified and the functions will convert for you.</span>

<span class="sd">.. Caution:: ARMI uses these objects for all material properties. Under the hood,</span>
<span class="sd">     A system called MAT_PROPS is in charge of several material properties. It</span>
<span class="sd">     is a more industrial-strength material property system that is currently</span>
<span class="sd">     a TerraPower proprietary system. You will see references to it in this module.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">fsolve</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="k">import</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi.nucDirectory</span> <span class="k">import</span> <span class="n">nuclideBases</span>
<span class="kn">from</span> <span class="nn">armi.reactor</span> <span class="k">import</span> <span class="n">composites</span>
<span class="kn">from</span> <span class="nn">armi.materials</span> <span class="k">import</span> <span class="n">materialParameters</span>
<span class="kn">from</span> <span class="nn">armi.utils.units</span> <span class="k">import</span> <span class="n">getTk</span><span class="p">,</span> <span class="n">getTc</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="k">import</span> <span class="n">densityTools</span>

<span class="c1"># globals</span>
<span class="n">FAIL_ON_RANGE</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="Material"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material">[docs]</a><span class="k">class</span> <span class="nc">Material</span><span class="p">(</span><span class="n">composites</span><span class="o">.</span><span class="n">Leaf</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A material is made up of elements or isotopes. It has bulk properties like mass density.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    params : dict</span>
<span class="sd">        scalar parameters.</span>

<span class="sd">    massFrac : dict</span>
<span class="sd">        The mass fractions of each nuclide in this material. These will not always sum to 1.0 after</span>
<span class="sd">        situations like axial expansion.</span>

<span class="sd">    massFracNorm : float</span>
<span class="sd">        The sum of massFrac, tracked by the setters so it doesn&#39;t have to be added up a lot.</span>

<span class="sd">    cache : dict</span>
<span class="sd">        Fast storage for commonly computed values.</span>

<span class="sd">    reference : str</span>
<span class="sd">        The literature reference.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pDefs</span> <span class="o">=</span> <span class="n">materialParameters</span><span class="o">.</span><span class="n">getMaterialParameterDefinitions</span><span class="p">()</span>

    <span class="n">DATA_SOURCE</span> <span class="o">=</span> <span class="s2">&quot;ARMI&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Material&quot;</span>
    <span class="n">references</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># property : citation</span>
    <span class="n">enrichedNuclide</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">correctDensityAfterApplyInputParams</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">modelConst</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">composites</span><span class="o">.</span><span class="n">Leaf</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># track sum of massFrac (which are modified and won&#39;t always sum to 1.0!)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFracNorm</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># so it doesn&#39;t have to be summed each time ( O(1) vs. O(N))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">atomFracDenom</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">references</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># reference dictionary for each method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># call subclass implementations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultMassFracs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">propertyRangeUpdated</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Material: </span><span class="si">{0}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>

<div class="viewcode-block" id="Material.duplicate"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.duplicate">[docs]</a>    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;copy without needing a deepcopy.&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">m</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">m</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">m</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">m</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>

        <span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="Material.linearExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        the instantaneous linear expansion coefficient (dL/L)/dT</span>

<span class="sd">        This is used for reactivity coefficients, etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&quot;</span><span class="si">{self}</span><span class="s2"> does not have a linear expansion property defined&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Material.linearExpansionPercent"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansionPercent">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansionPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        average thermal expansion dL/L. Used for computing hot dimensions</span>

<span class="sd">        Defaults to 0.0 for materials that don&#39;t expand.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tk : float</span>
<span class="sd">            temperature in (K)</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Temperature in (C)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        %dLL(T) in m/m/K</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.linearExpansionFactor"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansionFactor">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansionFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">T0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dL/L factor relative to T0 instead of to the material-dependent reference</span>
<span class="sd">        temperature. This factor dL/Lc is a ratio and will be used in dimensions through the</span>
<span class="sd">        formula::</span>

<span class="sd">            dim = dim0*(1+dLL).</span>

<span class="sd">        If there is no dLL, it should return 0.0</span>

<span class="sd">        calculate thermal expansion based on dL/L0, which is dependent on the mat-dep ref temp.::</span>

<span class="sd">             L(T) = L0(1+dL/L0)</span>
<span class="sd">             (Lh-Lc)/L0 = dL/L0(Th) - dL/L0(Tc)</span>
<span class="sd">             (Lh-Lc)/Lc = (Lh-Lc)/L0 * L0/Lc = (dL/L0(Th)-dL/L0(Tc)/L0 / (dL/L0(Tc)+1.0)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Current (hot) temperature in C</span>
<span class="sd">        T0 : float</span>
<span class="sd">            Cold temperature in C</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dL/L_fromCold : float</span>
<span class="sd">            The average thermal expansion between T_current and T0</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        linearExpansionPercent</span>
<span class="sd">        components.Component.getThermalExpansionFactor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dLLhot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">dLLcold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">T0</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">dLLhot</span> <span class="o">-</span> <span class="n">dLLcold</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">100.0</span> <span class="o">+</span> <span class="n">dLLcold</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.getThermalExpansionDensityReduction"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getThermalExpansionDensityReduction">[docs]</a>    <span class="k">def</span> <span class="nf">getThermalExpansionDensityReduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevTempInC</span><span class="p">,</span> <span class="n">newTempInC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the factor required to update thermal expansion going from temperatureInC to temperatureInCNew.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionFactor</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">newTempInC</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">prevTempInC</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dLL</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="Material.setDefaultMassFracs"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.setDefaultMassFracs">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultMassFracs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;mass fractions&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.setMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.setMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">setMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucName</span><span class="p">,</span> <span class="n">massFrac</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nucName</span><span class="p">]</span> <span class="o">=</span> <span class="n">massFrac</span></div>

<div class="viewcode-block" id="Material.applyInputParams"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.applyInputParams">[docs]</a>    <span class="k">def</span> <span class="nf">applyInputParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply material-specific material input parameters.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.adjustMassEnrichment"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.adjustMassEnrichment">[docs]</a>    <span class="k">def</span> <span class="nf">adjustMassEnrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">massEnrichment</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust the enrichment of the material.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        adjustMassFrac</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjustMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">,</span> <span class="n">massEnrichment</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.adjustMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.adjustMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">adjustMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nuclideName</span><span class="p">,</span> <span class="n">massFraction</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the mass fraction of the specified nuclide.</span>

<span class="sd">        This adjusts the mass fraction of a specified nuclide relative to other nuclides of the same element. If there</span>
<span class="sd">        are no other nuclides within the element, then it is enriched relative to the entire material. For example,</span>
<span class="sd">        enriching U235 in UZr would enrich U235 relative to U238 and other naturally occurring uranium isotopes.</span>
<span class="sd">        Likewise, enriching ZR in UZr would enrich ZR relative to uranium.</span>

<span class="sd">        The method maintains a constant number of atoms, and adjusts ``refDens`` accordingly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nuclideName : str</span>
<span class="sd">            Name of nuclide to enrich.</span>

<span class="sd">        massFraction : float</span>
<span class="sd">            New mass fraction to achieve.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">massFraction</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">massFraction</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot enrich to massFraction of </span><span class="si">{}</span><span class="s2">, must be between 0 and 1&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">massFraction</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">nucsNames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">)</span>

        <span class="c1"># refDens could be zero, but cannot normalize to zero.</span>
        <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="ow">or</span> <span class="mf">1.0</span>
        <span class="n">massDensities</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">nucsNames</span><span class="p">])</span> <span class="o">*</span> <span class="n">density</span>
        <span class="p">)</span>
        <span class="n">atomicMasses</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">nucsNames</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in AMU</span>
        <span class="n">molesPerCC</span> <span class="o">=</span> <span class="n">massDensities</span> <span class="o">/</span> <span class="n">atomicMasses</span>  <span class="c1"># item-wise division</span>

        <span class="n">enrichedIndex</span> <span class="o">=</span> <span class="n">nucsNames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nuclideName</span><span class="p">)</span>
        <span class="n">isoAndEles</span> <span class="o">=</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuclideName</span><span class="p">]</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">nuclideBases</span>
        <span class="n">allIndicesUpdated</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">nucsNames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nuc</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">isoAndEles</span>
            <span class="k">if</span> <span class="n">nuc</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allIndicesUpdated</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuclideName</span><span class="p">],</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">NaturalNuclideBase</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">isMonoIsotopicElement</span><span class="p">(</span><span class="n">nuclideName</span><span class="p">):</span>
                <span class="c1"># if there are not any other nuclides, assume we are enriching an entire element</span>
                <span class="c1"># consequently, allIndicesUpdated is no longer the element&#39;s indices, but the materials indices</span>
                <span class="n">allIndicesUpdated</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nucsNames</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># could be warning if problematic</span>
                    <span class="s2">&quot;Nuclide </span><span class="si">{}</span><span class="s2"> was to be enriched in material </span><span class="si">{}</span><span class="s2">, but there were no other isotopes of &quot;</span>
                    <span class="s2">&quot;that element. Could not assume the enrichment of the entire element as there were &quot;</span>
                    <span class="s2">&quot;other possible isotopes that did not exist in this material.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">nuclideName</span><span class="p">,</span> <span class="bp">self</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">massFraction</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">balanceWeight</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">balanceWeight</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">onlyOneOtherFracToDetermine</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">allIndicesUpdated</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">onlyOneOtherFracToDetermine</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Material </span><span class="si">{}</span><span class="s2"> has too many masses set to zero. cannot enrich </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">. Current &quot;</span>
                        <span class="s2">&quot;mass fractions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="p">,</span> <span class="n">nuclideName</span><span class="p">,</span> <span class="n">massFraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="c1"># massDensities get normalized later when conserving atoms; these are just ratios</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="mi">1</span> <span class="o">-</span> <span class="n">massFraction</span>
                <span class="p">)</span>  <span class="c1"># there is only one other.</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">massFraction</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># derived from solving the following equation for enrchedWeight:</span>
                <span class="c1"># massFraction = enrichedWeight / (enrichedWeight + balanceWeight)</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">massFraction</span> <span class="o">*</span> <span class="n">balanceWeight</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">massFraction</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="c1"># ratio is set by here but atoms not conserved yet</span>

        <span class="n">updatedNucsMolesPerCC</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">/</span> <span class="n">atomicMasses</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">updatedNucsMolesPerCC</span> <span class="o">*=</span> <span class="p">(</span>
            <span class="n">molesPerCC</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">updatedNucsMolesPerCC</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># conserve atoms</span>
        <span class="n">molesPerCC</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="n">updatedNucsMolesPerCC</span>

        <span class="n">updatedMassDensities</span> <span class="o">=</span> <span class="n">molesPerCC</span> <span class="o">*</span> <span class="n">atomicMasses</span>
        <span class="n">updatedDensity</span> <span class="o">=</span> <span class="n">updatedMassDensities</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">massFracs</span> <span class="o">=</span> <span class="n">updatedMassDensities</span> <span class="o">/</span> <span class="n">updatedDensity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{</span><span class="n">nuc</span><span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nucsNames</span><span class="p">,</span> <span class="n">massFracs</span><span class="p">)}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>  <span class="c1"># don&#39;t update density if not assigned</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="n">updatedDensity</span></div>

<div class="viewcode-block" id="Material.volumetricExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.volumetricExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">volumetricExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.getTemperatureAtDensity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getTemperatureAtDensity">[docs]</a>    <span class="k">def</span> <span class="nf">getTemperatureAtDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetDensity</span><span class="p">,</span> <span class="n">temperatureGuessInC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the temperature at which the perturbed density occurs.&quot;&quot;&quot;</span>
        <span class="n">densFunc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="k">lambda</span> <span class="n">temp</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">temp</span><span class="p">)</span> <span class="o">-</span> <span class="n">targetDensity</span>
        <span class="p">)</span>  <span class="c1"># 0 at tempertature of targetDensity</span>
        <span class="n">tAtTargetDensity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">fsolve</span><span class="p">(</span><span class="n">densFunc</span><span class="p">,</span> <span class="n">temperatureGuessInC</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># is a numpy array if fsolve is called</span>
        <span class="k">return</span> <span class="n">tAtTargetDensity</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquidPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">liquidPorosity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gasPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">gasPorosity</span>

<div class="viewcode-block" id="Material.density"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return density that preserves mass when thermally expanded in 2D.</span>

<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        This density will not agree with the component density since this method only expands in 2 dimensions.</span>
<span class="sd">        The component has been manually expanded axially with the manually entered block hot height.</span>
<span class="sd">        The density returned by this should be a factor of 1 + dLL higher than the density on the component.</span>
<span class="sd">        density3 should be in agreement at both cold and hot temperatures as long as the block height is correct for</span>
<span class="sd">        the specified temperature.</span>
<span class="sd">        In the case of Fluids, density and density3 are the same as density is not driven by linear expansion, but</span>
<span class="sd">        rather an exilicit density function dependent on Temperature. linearExpansionPercent is zero for a fluid.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        armi.materials.density3:</span>
<span class="sd">            component density should be in agreement with this density</span>
<span class="sd">        armi.reactor.blueprints._applyBlockDesign:</span>
<span class="sd">            2D expansion and axial density reduction occurs here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> has no reference density&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No refD &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">dLL</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="c1"># dRhoOverRho = (1.0 - f)/f</span>
        <span class="c1"># rho = rho + dRho = (1 + dRho/rho) * rho</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span> <span class="o">/</span> <span class="n">f</span>  <span class="c1"># g/cm^3</span></div>

<div class="viewcode-block" id="Material.densityKgM3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.densityKgM3">[docs]</a>    <span class="k">def</span> <span class="nf">densityKgM3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return density that preserves mass when thermally expanded in 2D in units of kg/m^3</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        armi.materials.density:</span>
<span class="sd">            Arguments are forwarded to the g/cc version</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span></div>

<div class="viewcode-block" id="Material.density3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.density3">[docs]</a>    <span class="k">def</span> <span class="nf">density3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return density that preserves mass when thermally expanded in 3D.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Since refDens is specified at the material-dep reference case, we don&#39;t</span>
<span class="sd">        need to specify the reference temperature. It is already consistent with linearExpansion</span>
<span class="sd">        Percent.</span>
<span class="sd">        - p*(dp/p(T) + 1) =p*( p + dp(T) )/p = p + dp(T) = p(T)</span>
<span class="sd">        - dp/p = (1-(1 + dL/L)**3)/(1 + dL/L)**3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">)</span>
        <span class="n">refD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">refDens</span>
        <span class="k">if</span> <span class="n">refD</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> has no reference density&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No refD &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">dLL</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">dRhoOverRho</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">/</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">refD</span> <span class="o">*</span> <span class="p">(</span><span class="n">dRhoOverRho</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.density3KgM3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.density3KgM3">[docs]</a>    <span class="k">def</span> <span class="nf">density3KgM3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return density that preserves mass when thermally expanded in 3D in units of kg/m^3.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        armi.materials.density3:</span>
<span class="sd">            Arguments are forwarded to the g/cc version</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">density3</span><span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span></div>

<div class="viewcode-block" id="Material.getCorrosionRate"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getCorrosionRate">[docs]</a>    <span class="k">def</span> <span class="nf">getCorrosionRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        given a temperature, get the corrosion rate of the material</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.getLifeMetalCorrelation"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getLifeMetalCorrelation">[docs]</a>    <span class="k">def</span> <span class="nf">getLifeMetalCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">Tk</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        life-metal correlation calculates the wastage of the material due to fission products.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.getReverseLifeMetalCorrelation"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getReverseLifeMetalCorrelation">[docs]</a>    <span class="k">def</span> <span class="nf">getReverseLifeMetalCorrelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thicknessFCCIWastageMicrons</span><span class="p">,</span> <span class="n">Tk</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Life metal correlation reverse lookup.  Knowing wastage and Temperature</span>
<span class="sd">        determine the effective time at that temperature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.getLifeMetalConservativeFcciCoeff"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getLifeMetalConservativeFcciCoeff">[docs]</a>    <span class="k">def</span> <span class="nf">getLifeMetalConservativeFcciCoeff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coefficient to be used in the LIFE-METAL correlation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.yieldStrength"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.yieldStrength">[docs]</a>    <span class="k">def</span> <span class="nf">yieldStrength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns yield strength at given T in MPa</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">yieldStrength</span></div>

<div class="viewcode-block" id="Material.thermalConductivity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.thermalConductivity">[docs]</a>    <span class="k">def</span> <span class="nf">thermalConductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        thermal conductivity in given T in K</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">thermalConductivity</span></div>

<div class="viewcode-block" id="Material.getProperty"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getProperty">[docs]</a>    <span class="k">def</span> <span class="nf">getProperty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">propName</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;gets properties in a way that caches them. &quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>

        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getCached</span><span class="p">(</span><span class="n">propName</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span> <span class="ow">and</span> <span class="n">cached</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Tk</span><span class="p">:</span>
            <span class="c1"># only use cached value if the temperature at which it is cached is the same.</span>
            <span class="k">return</span> <span class="n">cached</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># go look it up from material properties.</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">propName</span><span class="p">)(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># cache only one value for each property. Prevents unbounded cache explosion.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setCache</span><span class="p">(</span><span class="n">propName</span><span class="p">,</span> <span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">val</span></div>

<div class="viewcode-block" id="Material.getMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">getMassFrac</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nucName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">elementSymbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">nucList</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">expandFissionProducts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return mass fraction of nucName.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nucName : str, optional</span>
<span class="sd">            Nuclide name to return (&#39;ZR&#39;,&#39;PU239&#39;,etc.)</span>

<span class="sd">        elementSymbol :str, optional</span>
<span class="sd">             Return mass fractions of all isotopes of this element (example: &#39;Pu&#39;, &#39;U&#39;)</span>

<span class="sd">        nucList : optional, list</span>
<span class="sd">            List of nuclides to sum up and return the total</span>

<span class="sd">        normalized : bool, optional</span>
<span class="sd">            Return the mass fraction such that the sum of all nuclides is sum to 1.0. Default True</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        self.p.massFrac are modified mass fractions that may not add up to 1.0</span>
<span class="sd">        (for instance, after a axial expansion, the modified mass fracs will sum to less than one.</span>
<span class="sd">        The alternative is to put a multiplier on the density. They&#39;re mathematically equivalent.</span>

<span class="sd">        This function returns the normalized mass fraction (they will add to 1.0) as long as</span>
<span class="sd">        the mass fracs are modified only by get and setMassFrac</span>

<span class="sd">        This is a performance-critical method as it is called millions of times in a</span>
<span class="sd">        typical ARMI run.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        setMassFrac</span>
<span class="sd">        getNDens</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.clearMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.clearMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">clearMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;zero out all nuclide mass fractions. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFracNorm</span> <span class="o">=</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.removeNucMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.removeNucMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">removeNucMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nuc</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMassFrac</span><span class="p">(</span><span class="n">nuc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># the nuc isn&#39;t in the mass Frac vector</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.removeLumpedFissionProducts"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.removeLumpedFissionProducts">[docs]</a>    <span class="k">def</span> <span class="nf">removeLumpedFissionProducts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;LF&quot;</span> <span class="ow">in</span> <span class="n">nuc</span><span class="p">:</span>
                <span class="c1"># this component has a lumped fission product to remove</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">removeNucMassFrac</span><span class="p">(</span><span class="n">nuc</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.getMassFracCopy"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getMassFracCopy">[docs]</a>    <span class="k">def</span> <span class="nf">getMassFracCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">massFrac</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.checkTempRange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.checkTempRange">[docs]</a>    <span class="k">def</span> <span class="nf">checkTempRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minV</span><span class="p">,</span> <span class="n">maxV</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the given temperature (val) is between the minV and maxV temperature limits supplied.</span>
<span class="sd">        Label identifies what material type or element is being evaluated in the check.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        minV, maxV : float</span>
<span class="sd">            The minimum and maximum values that val is allowed to have.</span>

<span class="sd">        val : float</span>
<span class="sd">            The value to check whether it is between minV and maxV.</span>

<span class="sd">        label : str</span>
<span class="sd">            The name of the function or property that is being checked.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">minV</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">maxV</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Temperature </span><span class="si">{0}</span><span class="s2"> out of range (</span><span class="si">{1}</span><span class="s2"> to </span><span class="si">{2}</span><span class="s2">) for </span><span class="si">{3}</span><span class="s2"> </span><span class="si">{4}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">val</span><span class="p">,</span> <span class="n">minV</span><span class="p">,</span> <span class="n">maxV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">label</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">FAIL_ON_RANGE</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">msg</span><span class="p">,</span>
                    <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T out of bounds for </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Material.isBeyondIncubationDose"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.isBeyondIncubationDose">[docs]</a>    <span class="k">def</span> <span class="nf">isBeyondIncubationDose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">totalDPA</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the materials is beyond is incubation dose. Passes if the material</span>
<span class="sd">        does not have an incubation dose assigned (self.modelConst[&#39;Rincu&#39;]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        totalDPA : float</span>
<span class="sd">            Total DPA accumulated in the material</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Bool indicating whether the material is beyond its incubation dose or not.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Material missing incubation dose&quot;</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Missing incubation dose&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">totalDPA</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Material.updateDeltaDPApastIncubation"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.updateDeltaDPApastIncubation">[docs]</a>    <span class="k">def</span> <span class="nf">updateDeltaDPApastIncubation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">totalDPA</span><span class="p">,</span> <span class="n">deltaDPA</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If a material has passed its incubation dose, this method updates deltaDPA. The concern</span>
<span class="sd">        here is when a step in DPA crosses the incubation threshold, the amount of DPA input into a</span>
<span class="sd">        calculation is more than is actually contributing to deformation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        totalDPA : float</span>
<span class="sd">            Total DPA accumulated in the material.</span>

<span class="sd">        deltaDPA : float</span>
<span class="sd">            Change in DPA over a time step.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        deltaDPA past the incubation dose of the material.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Material missing incubation dose&quot;</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Missing incubation dose&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">totalDPA</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">totalDPA</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">deltaDPA</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">totalDPA</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelConst</span><span class="p">[</span><span class="s2">&quot;Rincu&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deltaDPA</span></div>

<div class="viewcode-block" id="Material.densityTimesHeatCapacity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.densityTimesHeatCapacity">[docs]</a>    <span class="k">def</span> <span class="nf">densityTimesHeatCapacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return heat capacity * density at a temperature</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tk : float, optional</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        Tc : float, optional</span>
<span class="sd">            Temperature in degrees Celsius.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rhoCP : float</span>
<span class="sd">            Calculated value for the HT9 density* heat capacity</span>
<span class="sd">            unit (J/m^3-K)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tc</span> <span class="o">=</span> <span class="n">getTc</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>

        <span class="n">rhoCp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">heatCapacity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rhoCp</span></div>

<div class="viewcode-block" id="Material.getNuclides"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getNuclides">[docs]</a>    <span class="k">def</span> <span class="nf">getNuclides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Material.getNuclides is being deprecated.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">()</span></div>

<div class="viewcode-block" id="Material.getTempChangeForDensityChange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getTempChangeForDensityChange">[docs]</a>    <span class="k">def</span> <span class="nf">getTempChangeForDensityChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">densityFrac</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a temperature difference for a given density perturbation.&quot;&quot;&quot;</span>
        <span class="n">linearExpansion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansion</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">volFrac</span> <span class="o">=</span> <span class="n">densityFrac</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="n">deltaT</span> <span class="o">=</span> <span class="n">volFrac</span> <span class="o">/</span> <span class="n">linearExpansion</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;The linear expansion for </span><span class="si">{}</span><span class="s2"> at initial temperature of </span><span class="si">{}</span><span class="s2"> C is </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">A change in density of </span><span class="si">{}</span><span class="s2"> &quot;</span>
                <span class="s2">&quot;percent at would require a change in temperature of </span><span class="si">{}</span><span class="s2"> C.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
                    <span class="n">Tc</span><span class="p">,</span>
                    <span class="n">linearExpansion</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">densityFrac</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">,</span>
                    <span class="n">deltaT</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">deltaT</span></div>

<div class="viewcode-block" id="Material.heatCapacity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.heatCapacity">[docs]</a>    <span class="k">def</span> <span class="nf">heatCapacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&quot;Material {type(self).__name__} does not implement heatCapacity&quot;</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="Fluid"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid">[docs]</a><span class="k">class</span> <span class="nc">Fluid</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A material that fills its container. Could also be a gas.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Fluid&quot;</span>

<div class="viewcode-block" id="Fluid.getThermalExpansionDensityReduction"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.getThermalExpansionDensityReduction">[docs]</a>    <span class="k">def</span> <span class="nf">getThermalExpansionDensityReduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevTempInC</span><span class="p">,</span> <span class="n">newTempInC</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the factor required to update thermal expansion going from temperatureInC to temperatureInCNew.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rho0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">prevTempInC</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rho0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">newTempInC</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rho1</span> <span class="o">/</span> <span class="n">rho0</span></div>

<div class="viewcode-block" id="Fluid.linearExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.linearExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;for void, lets just not allow temperature changes to change dimensions</span>
<span class="sd">        since it is a liquid it will fill its space. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Fluid.getTempChangeForDensityChange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.getTempChangeForDensityChange">[docs]</a>    <span class="k">def</span> <span class="nf">getTempChangeForDensityChange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">densityFrac</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a temperature difference for a given density perturbation.&quot;&quot;&quot;</span>
        <span class="n">currentDensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">perturbedDensity</span> <span class="o">=</span> <span class="n">currentDensity</span> <span class="o">*</span> <span class="n">densityFrac</span>
        <span class="n">tAtPerturbedDensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTemperatureAtDensity</span><span class="p">(</span><span class="n">perturbedDensity</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span>
        <span class="n">deltaT</span> <span class="o">=</span> <span class="n">tAtPerturbedDensity</span> <span class="o">-</span> <span class="n">Tc</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;A change in density of </span><span class="si">{}</span><span class="s2"> percent in </span><span class="si">{}</span><span class="s2"> at an initial temperature of </span><span class="si">{}</span><span class="s2"> C would require &quot;</span>
                <span class="s2">&quot;a change in temperature of </span><span class="si">{}</span><span class="s2"> C.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">densityFrac</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">deltaT</span>
                <span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">deltaT</span></div>

<div class="viewcode-block" id="Fluid.density3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.density3">[docs]</a>    <span class="k">def</span> <span class="nf">density3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the density at the specified temperature for 3D expansion.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        for fluids, there is no such thing as 2 d expansion so density() is already 3D.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FuelMaterial"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.FuelMaterial">[docs]</a><span class="k">class</span> <span class="nc">FuelMaterial</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Material that is considered a nuclear fuel.</span>

<span class="sd">    All this really does is enable the special class 1/class 2 isotopics input option.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pDefs</span> <span class="o">=</span> <span class="n">materialParameters</span><span class="o">.</span><span class="n">getFuelMaterialParameterDefinitions</span><span class="p">()</span>

<div class="viewcode-block" id="FuelMaterial.applyInputParams"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.FuelMaterial.applyInputParams">[docs]</a>    <span class="k">def</span> <span class="nf">applyInputParams</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">class1_custom_isotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">class2_custom_isotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">class1_wt_frac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">customIsotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply optional class 1/class 2 custom enrichment input.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is often overridden to insert customized material modification parameters</span>
<span class="sd">        but then this parent should always be called at the end in case users want to</span>
<span class="sd">        use this style of custom input.</span>

<span class="sd">        This is only applied to materials considered fuel so we don&#39;t apply these</span>
<span class="sd">        kinds of parameters to coolants and structural material, which are often</span>
<span class="sd">        not parameterized with any kind of enrichment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Save class data for future reconstructions (e.g. in closed cycles)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">class1_wt_frac</span> <span class="o">=</span> <span class="n">class1_wt_frac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">class1_custom_isotopics</span> <span class="o">=</span> <span class="n">class1_custom_isotopics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">class2_custom_isotopics</span> <span class="o">=</span> <span class="n">class2_custom_isotopics</span>
        <span class="k">if</span> <span class="n">class1_wt_frac</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applyIsotopicsMixFromCustomIsotopicsInput</span><span class="p">(</span><span class="n">customIsotopics</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_applyIsotopicsMixFromCustomIsotopicsInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customIsotopics</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a Class 1/Class 2 mixture of custom isotopics at input.</span>

<span class="sd">        Only adjust heavy metal.</span>

<span class="sd">        This may also be needed for building charge assemblies during reprocessing, but</span>
<span class="sd">        will take input from the SFP rather than from the input external feeds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class1Isotopics</span> <span class="o">=</span> <span class="n">customIsotopics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">class1_custom_isotopics</span><span class="p">]</span>
        <span class="n">class2Isotopics</span> <span class="o">=</span> <span class="n">customIsotopics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">class2_custom_isotopics</span><span class="p">]</span>
        <span class="n">densityTools</span><span class="o">.</span><span class="n">applyIsotopicsMix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class1Isotopics</span><span class="p">,</span> <span class="n">class2Isotopics</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2009-2020, TerraPower, LLC
      <span class="lastupdated">
        Last updated on 2020-07-29.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>