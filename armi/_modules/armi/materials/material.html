<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>armi.materials.material &mdash; ARMI 0.4.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ARMI
              <img src="../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.4.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../armi.html">armi</a></li>
          <li class="breadcrumb-item"><a href="../materials.html">armi.materials</a></li>
      <li class="breadcrumb-item active">armi.materials.material</li>
  <li class="wy-breadcrumbs-aside">
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for armi.materials.material</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Base Material classes.</span>

<span class="sd">Most temperatures may be specified in either K or C and the functions will convert for you.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi.nucDirectory</span> <span class="kn">import</span> <span class="n">nuclideBases</span>
<span class="kn">from</span> <span class="nn">armi.reactor.flags</span> <span class="kn">import</span> <span class="n">TypeSpec</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">densityTools</span>
<span class="kn">from</span> <span class="nn">armi.utils.units</span> <span class="kn">import</span> <span class="n">getTk</span><span class="p">,</span> <span class="n">getTc</span>

<span class="c1"># globals</span>
<span class="n">FAIL_ON_RANGE</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="Material"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material">[docs]</a><span class="k">class</span> <span class="nc">Material</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A material is made up of elements or isotopes. It has bulk properties like density.</span>

<span class="sd">    .. impl:: The abstract material class.</span>
<span class="sd">        :id: I_ARMI_MAT_PROPERTIES</span>
<span class="sd">        :implements: R_ARMI_MAT_PROPERTIES</span>

<span class="sd">        The ARMI Materials library is based on the Object-Oriented Programming design approach, and</span>
<span class="sd">        uses this generic ``Material`` base class. In this class we define a large number of</span>
<span class="sd">        material properties like density, heat capacity, or linear expansion coefficient. Specific</span>
<span class="sd">        materials then subclass this base class to assign particular values to those properties.</span>

<span class="sd">    .. impl:: Materials generate nuclide mass fractions at instantiation.</span>
<span class="sd">        :id: I_ARMI_MAT_FRACS</span>
<span class="sd">        :implements: R_ARMI_MAT_FRACS</span>

<span class="sd">        An ARMI material is meant to be able to represent real world materials that might be used in</span>
<span class="sd">        the construction of a nuclear reactor. As such, they are not just individual nuclides, but</span>
<span class="sd">        practical materials like a particular concrete, steel, or water. One of the main things that</span>
<span class="sd">        will be needed to describe such a material is the exact nuclide fractions. As such, the</span>
<span class="sd">        constructor of every Material subclass attempts to set these mass fractions.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : Component</span>
<span class="sd">        The component to which this material belongs</span>
<span class="sd">    massFrac : dict</span>
<span class="sd">        Mass fractions for all nuclides in the material keyed on the nuclide symbols</span>
<span class="sd">    refDens : float</span>
<span class="sd">        A reference density used by some materials, for instance `SimpleSolid`\ s, during thermal</span>
<span class="sd">        expansion</span>
<span class="sd">    theoreticalDensityFrac : float</span>
<span class="sd">        Fraction of the material&#39;s density in reality, which is commonly different from 1.0 in solid</span>
<span class="sd">        materials due to the manufacturing process. Can often be set from the blueprints input via</span>
<span class="sd">        the TD_frac material modification. For programmatic setting, use `adjustTD()`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Specific material classes may have many more attributes specific to the implementation</span>
<span class="sd">    for that material.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DATA_SOURCE</span> <span class="o">=</span> <span class="s2">&quot;ARMI&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indication of where the material is loaded from (may be plugin name)&quot;&quot;&quot;</span>

    <span class="n">references</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The literature references {property : citation}&quot;&quot;&quot;</span>

    <span class="n">enrichedNuclide</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Name of enriched nuclide to be interpreted by enrichment modification methods&quot;&quot;&quot;</span>

    <span class="n">modelConst</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constants that may be used in intepolation functions for property lookups&quot;&quot;&quot;</span>

    <span class="n">propertyValidTemperature</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of valid temperatures over which the property models are valid in the format</span>
<span class="sd">    &#39;Property Name&#39;: ((Temperature_Lower_Limit, Temperature_Upper_Limit), Temperature_Units)&quot;&quot;&quot;</span>

    <span class="n">thermalScatteringLaws</span> <span class="o">=</span> <span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A tuple of :py:class:`~armi.nucDirectory.thermalScattering.ThermalScattering` instances</span>
<span class="sd">    with information about thermal scattering.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupCache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>

        <span class="c1"># call subclass implementations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultMassFracs</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;Material: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Getter for the private name attribute of this Material.</span>

<span class="sd">        .. impl:: The name of a material is accessible.</span>
<span class="sd">            :id: I_ARMI_MAT_NAME</span>
<span class="sd">            :implements: R_ARMI_MAT_NAME</span>

<span class="sd">            Every instance of an ARMI material must have a simple, human-readable string name. And,</span>
<span class="sd">            if possible, we want this string to match the class name. (This, of course, puts some</span>
<span class="sd">            limits on both the string and the class name.) These names are easily retrievable as a</span>
<span class="sd">            class property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nomen</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setter for the private name attribute of this Material.</span>

<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        Some code in ARMI expects the &quot;name&quot; of a meterial matches its class name. So you use this</span>
<span class="sd">        method at your own risk.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        armi.materials.resolveMaterialClassByName</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">nomen</span>

<div class="viewcode-block" id="Material.getName"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getName">[docs]</a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Duplicate of name property, kept for backwards compatibility.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span></div>

<div class="viewcode-block" id="Material.getChildren"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getChildren">[docs]</a>    <span class="k">def</span> <span class="nf">getChildren</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">includeMaterials</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return empty list, representing that materials have no children.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Material.getChildrenWithFlags"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getChildrenWithFlags">[docs]</a>    <span class="k">def</span> <span class="nf">getChildrenWithFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typeSpec</span><span class="p">:</span> <span class="n">TypeSpec</span><span class="p">,</span> <span class="n">exactMatch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return empty list, representing that this object has no children.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Material.backUp"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.backUp">[docs]</a>    <span class="k">def</span> <span class="nf">backUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create and store a backup of the state.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_backupCache</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cached</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupCache</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># don&#39;t .clear(), using reference above!</span></div>

<div class="viewcode-block" id="Material.restoreBackup"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.restoreBackup">[docs]</a>    <span class="k">def</span> <span class="nf">restoreBackup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paramsToApply</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Restore the parameters from previously created backup.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupCache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backupCache</span></div>

<div class="viewcode-block" id="Material.clearCache"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.clearCache">[docs]</a>    <span class="k">def</span> <span class="nf">clearCache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the cache so all new values are recomputed.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span> <span class="o">=</span> <span class="p">{}</span></div>

    <span class="k">def</span> <span class="nf">_getCached</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain a value from the cache.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cached</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setCache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a value in the cache.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _getCached : returns a previously-cached value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cached</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

<div class="viewcode-block" id="Material.duplicate"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.duplicate">[docs]</a>    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy without needing a deepcopy.&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

        <span class="n">m</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">m</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="n">m</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">m</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span>
        <span class="n">m</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span>

        <span class="k">return</span> <span class="n">m</span></div>

<div class="viewcode-block" id="Material.linearExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The instantaneous linear expansion coefficient (dL/L)/dT.</span>

<span class="sd">        This is used for reactivity coefficients, etc. but will not affect density or dimensions.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        linearExpansionPercent : average linear thermal expansion to affect dimensions and density</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> does not have a linear expansion property defined&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Material.linearExpansionPercent"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansionPercent">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansionPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Average thermal expansion dL/L. Used for computing hot dimensions and density.</span>

<span class="sd">        Defaults to 0.0 for materials that don&#39;t expand.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tk : float</span>
<span class="sd">            temperature in (K)</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Temperature in (C)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dLL(T) in % m/m/K</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        linearExpansion : handle instantaneous thermal expansion coefficients</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.linearExpansionFactor"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.linearExpansionFactor">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansionFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">T0</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a dL/L factor relative to T0 instead of the material-dependent reference temperature.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        For a detailed description of the linear expansion methodology, see</span>
<span class="sd">        :ref:`thermalExpansion` in the documentation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Current (hot) temperature in C</span>
<span class="sd">        T0 : float</span>
<span class="sd">            Cold temperature in C</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dLL: float</span>
<span class="sd">            The average thermal expansion between Tc and T0. If there is no dLL, it should return 0.0.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        linearExpansionPercent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dLLhot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">dLLcold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">T0</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">dLLhot</span> <span class="o">-</span> <span class="n">dLLcold</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">100.0</span> <span class="o">+</span> <span class="n">dLLcold</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.getThermalExpansionDensityReduction"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getThermalExpansionDensityReduction">[docs]</a>    <span class="k">def</span> <span class="nf">getThermalExpansionDensityReduction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">prevTempInC</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">newTempInC</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the factor required to update thermal expansion going from temperatureInC to temperatureInCNew.&quot;&quot;&quot;</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionFactor</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">newTempInC</span><span class="p">,</span> <span class="n">T0</span><span class="o">=</span><span class="n">prevTempInC</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dLL</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="Material.setDefaultMassFracs"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.setDefaultMassFracs">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultMassFracs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mass fractions.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.setMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.setMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">setMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">massFrac</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns the mass fraction of a nuclide within the material.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This will try to convert the provided ``massFrac`` into a float for assignment. If the</span>
<span class="sd">        conversion cannot occur then an error will be thrown.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">massFrac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">massFrac</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ee</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error in converting the mass fraction of </span><span class="si">{</span><span class="n">massFrac</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for nuclide </span><span class="si">{</span><span class="n">nucName</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> to a float. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Exception: </span><span class="si">{</span><span class="n">ee</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">massFrac</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">massFrac</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Mass fraction of </span><span class="si">{</span><span class="n">massFrac</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">nucName</span><span class="si">}</span><span class="s2"> is not between 0 and 1.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nucName</span><span class="p">]</span> <span class="o">=</span> <span class="n">massFrac</span></div>

<div class="viewcode-block" id="Material.applyInputParams"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.applyInputParams">[docs]</a>    <span class="k">def</span> <span class="nf">applyInputParams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply material-specific material input parameters.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.adjustMassEnrichment"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.adjustMassEnrichment">[docs]</a>    <span class="k">def</span> <span class="nf">adjustMassEnrichment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">massEnrichment</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust the enrichment of the material.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        adjustMassFrac</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjustMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enrichedNuclide</span><span class="p">,</span> <span class="n">massEnrichment</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.adjustMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.adjustMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">adjustMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nuclideName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">massFraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the mass fraction of the specified nuclide.</span>

<span class="sd">        This adjusts the mass fraction of a specified nuclide relative to other nuclides of the same</span>
<span class="sd">        element. If there are no other nuclides within the element, then it is enriched relative to</span>
<span class="sd">        the entire material. For example, enriching U235 in UZr would enrich U235 relative to U238</span>
<span class="sd">        and other naturally occurring uranium isotopes. Likewise, enriching ZR in UZr would enrich</span>
<span class="sd">        ZR relative to uranium.</span>

<span class="sd">        The method maintains a constant number of atoms, and adjusts ``refDens`` accordingly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nuclideName : str</span>
<span class="sd">            Name of nuclide to enrich.</span>

<span class="sd">        massFraction : float</span>
<span class="sd">            New mass fraction to achieve.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">massFraction</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">massFraction</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot enrich to massFraction of </span><span class="si">{}</span><span class="s2">, must be between 0 and 1&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">massFraction</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">nucsNames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="p">)</span>

        <span class="c1"># refDens could be zero, but cannot normalize to zero.</span>
        <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="ow">or</span> <span class="mf">1.0</span>
        <span class="n">massDensities</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">nucsNames</span><span class="p">])</span> <span class="o">*</span> <span class="n">density</span>
        <span class="n">atomicMasses</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">nucsNames</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in AMU</span>
        <span class="n">molesPerCC</span> <span class="o">=</span> <span class="n">massDensities</span> <span class="o">/</span> <span class="n">atomicMasses</span>  <span class="c1"># item-wise division</span>

        <span class="n">enrichedIndex</span> <span class="o">=</span> <span class="n">nucsNames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nuclideName</span><span class="p">)</span>
        <span class="n">isoAndEles</span> <span class="o">=</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuclideName</span><span class="p">]</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">nuclides</span>
        <span class="n">allIndicesUpdated</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">nucsNames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">nuc</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">isoAndEles</span> <span class="k">if</span> <span class="n">nuc</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allIndicesUpdated</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">nuclideBases</span><span class="o">.</span><span class="n">byName</span><span class="p">[</span><span class="n">nuclideName</span><span class="p">],</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">NaturalNuclideBase</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="n">nuclideBases</span><span class="o">.</span><span class="n">isMonoIsotopicElement</span><span class="p">(</span><span class="n">nuclideName</span><span class="p">):</span>
                <span class="c1"># If there are not any other nuclides, assume we are enriching an entire element.</span>
                <span class="c1"># Consequently, allIndicesUpdated is no longer the element&#39;s indices, but the</span>
                <span class="c1"># materials indices</span>
                <span class="n">allIndicesUpdated</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nucsNames</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># could be warning if problematic</span>
                    <span class="s2">&quot;Nuclide </span><span class="si">{}</span><span class="s2"> was to be enriched in material </span><span class="si">{}</span><span class="s2">, but there were no other &quot;</span>
                    <span class="s2">&quot;isotopes of that element. Could not assume the enrichment of the entire &quot;</span>
                    <span class="s2">&quot;element as there were other possible isotopes that did not exist in this &quot;</span>
                    <span class="s2">&quot;material.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclideName</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">massFraction</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">balanceWeight</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">balanceWeight</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">onlyOneOtherFracToDetermine</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">allIndicesUpdated</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">onlyOneOtherFracToDetermine</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Material </span><span class="si">{}</span><span class="s2"> has too many masses set to zero. cannot enrich </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">. &quot;</span>
                        <span class="s2">&quot;Current mass fractions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="p">,</span> <span class="n">nuclideName</span><span class="p">,</span> <span class="n">massFraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="c1"># massDensities get normalized later when conserving atoms; these are just ratios</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="mi">1</span> <span class="o">-</span> <span class="n">massFraction</span>
                <span class="p">)</span>  <span class="c1"># there is only one other.</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">massFraction</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># derived from solving the following equation for enrchedWeight:</span>
                <span class="c1"># massFraction = enrichedWeight / (enrichedWeight + balanceWeight)</span>
                <span class="n">massDensities</span><span class="p">[</span><span class="n">enrichedIndex</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">massFraction</span> <span class="o">*</span> <span class="n">balanceWeight</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">massFraction</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="c1"># ratio is set by here but atoms not conserved yet</span>

        <span class="n">updatedNucsMolesPerCC</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">massDensities</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">/</span> <span class="n">atomicMasses</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">updatedNucsMolesPerCC</span> <span class="o">*=</span> <span class="p">(</span>
            <span class="n">molesPerCC</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">updatedNucsMolesPerCC</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># conserve atoms</span>
        <span class="n">molesPerCC</span><span class="p">[</span><span class="n">allIndicesUpdated</span><span class="p">]</span> <span class="o">=</span> <span class="n">updatedNucsMolesPerCC</span>

        <span class="n">updatedMassDensities</span> <span class="o">=</span> <span class="n">molesPerCC</span> <span class="o">*</span> <span class="n">atomicMasses</span>
        <span class="n">updatedDensity</span> <span class="o">=</span> <span class="n">updatedMassDensities</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">massFracs</span> <span class="o">=</span> <span class="n">updatedMassDensities</span> <span class="o">/</span> <span class="n">updatedDensity</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">massFracs</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The mass fractions </span><span class="si">{</span><span class="n">massFracs</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> do not sum to 1.0.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{</span><span class="n">nuc</span><span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nucsNames</span><span class="p">,</span> <span class="n">massFracs</span><span class="p">)}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>  <span class="c1"># don&#39;t update density if not assigned</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="n">updatedDensity</span></div>

<div class="viewcode-block" id="Material.volumetricExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.volumetricExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">volumetricExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.getTemperatureAtDensity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getTemperatureAtDensity">[docs]</a>    <span class="k">def</span> <span class="nf">getTemperatureAtDensity</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">targetDensity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tempGuessInC</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the temperature at which the perturbed density occurs (in Celcius).&quot;&quot;&quot;</span>
        <span class="c1"># 0 at tempertature of targetDensity</span>
        <span class="n">densFunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">temp</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">temp</span><span class="p">)</span> <span class="o">-</span> <span class="n">targetDensity</span>
        <span class="c1"># is a numpy array if fsolve is called</span>
        <span class="n">tAtTargetDensity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">fsolve</span><span class="p">(</span><span class="n">densFunc</span><span class="p">,</span> <span class="n">tempGuessInC</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">tAtTargetDensity</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">liquidPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fraction of the material that is liquid void (unitless).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">liquidPorosity</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">gasPorosity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fraction of the material that is gas void (unitless).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">gasPorosity</span>

<div class="viewcode-block" id="Material.pseudoDensity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.pseudoDensity">[docs]</a>    <span class="k">def</span> <span class="nf">pseudoDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return density that preserves mass when thermally expanded in 2D (in g/cm^3).</span>

<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        This will not typically agree with ``Material.density()`` or ``Component.density()``</span>
<span class="sd">        since this method only expands in 2 dimensions. Depending on your use of</span>
<span class="sd">        ``inputHeightsConsideredHot`` and ``Component.temperatureInC``, ``Material.psuedoDensity()``</span>
<span class="sd">        may be a factor of (1+dLL) different than ``Material.density()`` or ``Component.density()``.</span>

<span class="sd">        In the case of fluids, density and pseudoDensity are the same as density is not driven by</span>
<span class="sd">        linear expansion, but  rather an explicit density function dependent on temperature.</span>
<span class="sd">        ``Material.linearExpansionPercent()`` is zero for a fluid.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        density</span>
<span class="sd">        armi.reactor.components.component.Component.density</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> has no reference density&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No refD &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">dLL</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">/</span> <span class="n">f</span></div>

<div class="viewcode-block" id="Material.pseudoDensityKgM3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.pseudoDensityKgM3">[docs]</a>    <span class="k">def</span> <span class="nf">pseudoDensityKgM3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return density that preserves mass when thermally expanded in 2D in units of kg/m^3.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        density:</span>
<span class="sd">            Arguments are forwarded to the g/cc version</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span></div>

<div class="viewcode-block" id="Material.density"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return density that preserves mass when thermally expanded in 3D (in g/cm^3).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Since refDens is specified at the material-dep reference case, we don&#39;t need to specify the</span>
<span class="sd">        reference temperature. It is already consistent with linearExpansion Percent.</span>
<span class="sd">        - p*(dp/p(T) + 1) =p*( p + dp(T) )/p = p + dp(T) = p(T)</span>
<span class="sd">        - dp/p = (1-(1 + dL/L)**3)/(1 + dL/L)**3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>
        <span class="n">dLL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansionPercent</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">)</span>
        <span class="n">refD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span>
        <span class="k">if</span> <span class="n">refD</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> has no reference density&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No refD &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">dLL</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="n">refD</span> <span class="o">/</span> <span class="n">f</span></div>

<div class="viewcode-block" id="Material.densityKgM3"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.densityKgM3">[docs]</a>    <span class="k">def</span> <span class="nf">densityKgM3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return density that preserves mass when thermally expanded in 3D in units of kg/m^3.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        density:</span>
<span class="sd">            Arguments are forwarded to the g/cc version</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span></div>

<div class="viewcode-block" id="Material.getCorrosionRate"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getCorrosionRate">[docs]</a>    <span class="k">def</span> <span class="nf">getCorrosionRate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a temperature, get the corrosion rate of the material (in microns/year).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Material.yieldStrength"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.yieldStrength">[docs]</a>    <span class="k">def</span> <span class="nf">yieldStrength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns yield strength at given T in MPa.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.thermalConductivity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.thermalConductivity">[docs]</a>    <span class="k">def</span> <span class="nf">thermalConductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thermal conductivity for given T (in units of W/m/K).&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.getProperty"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getProperty">[docs]</a>    <span class="k">def</span> <span class="nf">getProperty</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">propName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets properties in a way that caches them.&quot;&quot;&quot;</span>
        <span class="n">Tk</span> <span class="o">=</span> <span class="n">getTk</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>

        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getCached</span><span class="p">(</span><span class="n">propName</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span> <span class="ow">and</span> <span class="n">cached</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">Tk</span><span class="p">:</span>
            <span class="c1"># only use cached value if the temperature at which it is cached is the same.</span>
            <span class="k">return</span> <span class="n">cached</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># go look it up from material properties.</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">propName</span><span class="p">)(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># cache only one value for each property. Prevents unbounded cache explosion.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setCache</span><span class="p">(</span><span class="n">propName</span><span class="p">,</span> <span class="p">(</span><span class="n">Tk</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">val</span></div>

<div class="viewcode-block" id="Material.getMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">getMassFrac</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nucName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">expandFissionProducts</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return mass fraction of nucName.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nucName : str, optional</span>
<span class="sd">            Nuclide name to return (&#39;ZR&#39;,&#39;PU239&#39;,etc.)</span>

<span class="sd">        normalized : bool, optional</span>
<span class="sd">            Return the mass fraction such that the sum of all nuclides is sum to 1.0. Default True</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        self.massFrac are modified mass fractions that may not add up to 1.0 (for instance, after a</span>
<span class="sd">        axial expansion, the modified mass fracs will sum to less than one. The alternative is to</span>
<span class="sd">        put a multiplier on the density. They&#39;re mathematically equivalent.</span>

<span class="sd">        This function returns the normalized mass fraction (they will add to 1.0) as long as the</span>
<span class="sd">        mass fracs are modified only by get and setMassFrac</span>

<span class="sd">        This is a performance-critical method as it is called millions of times in a typical ARMI</span>
<span class="sd">        run.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        setMassFrac</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nucName</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.clearMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.clearMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">clearMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Zero out all nuclide mass fractions.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="Material.removeNucMassFrac"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.removeNucMassFrac">[docs]</a>    <span class="k">def</span> <span class="nf">removeNucMassFrac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nuc</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMassFrac</span><span class="p">(</span><span class="n">nuc</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># the nuc isn&#39;t in the mass Frac vector</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="Material.checkPropertyTempRange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.checkPropertyTempRange">[docs]</a>    <span class="k">def</span> <span class="nf">checkPropertyTempRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if the given property / value combination fall between the min and max valid</span>
<span class="sd">        temperatures provided in the propertyValidTemperature object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label : str</span>
<span class="sd">            The name of the function or property that is being checked.</span>

<span class="sd">        val : float</span>
<span class="sd">            The value to check whether it is between minT and maxT.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This was designed as a convience method for ``checkTempRange``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">minT</span><span class="p">,</span> <span class="n">maxT</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">propertyValidTemperature</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkTempRange</span><span class="p">(</span><span class="n">minT</span><span class="p">,</span> <span class="n">maxT</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></div>

<div class="viewcode-block" id="Material.checkTempRange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.checkTempRange">[docs]</a>    <span class="k">def</span> <span class="nf">checkTempRange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minT</span><span class="p">,</span> <span class="n">maxT</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the given temperature (val) is between the minT and maxT temperature limits</span>
<span class="sd">        supplied.</span>

<span class="sd">        Label identifies what material type or element is being evaluated in the check.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        minT, maxT : float</span>
<span class="sd">            The minimum and maximum values that val is allowed to have.</span>

<span class="sd">        val : float</span>
<span class="sd">            The value to check whether it is between minT and maxT.</span>

<span class="sd">        label : str</span>
<span class="sd">            The name of the function or property that is being checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">minT</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">maxT</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Temperature </span><span class="si">{0}</span><span class="s2"> out of range (</span><span class="si">{1}</span><span class="s2"> to </span><span class="si">{2}</span><span class="s2">) for </span><span class="si">{3}</span><span class="s2"> </span><span class="si">{4}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">val</span><span class="p">,</span> <span class="n">minT</span><span class="p">,</span> <span class="n">maxT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">label</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">FAIL_ON_RANGE</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">msg</span><span class="p">,</span>
                    <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;T out of bounds for </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Material.densityTimesHeatCapacity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.densityTimesHeatCapacity">[docs]</a>    <span class="k">def</span> <span class="nf">densityTimesHeatCapacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return heat capacity * density at a temperature.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tk : float, optional</span>
<span class="sd">            Temperature in Kelvin.</span>
<span class="sd">        Tc : float, optional</span>
<span class="sd">            Temperature in degrees Celsius</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rhoCP : float</span>
<span class="sd">            Calculated value for the HT9 density* heat capacity</span>
<span class="sd">            unit (J/m^3-K)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Tc</span> <span class="o">=</span> <span class="n">getTc</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Tk</span><span class="p">)</span>

        <span class="n">rhoCp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1000.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">heatCapacity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rhoCp</span></div>

<div class="viewcode-block" id="Material.getNuclides"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getNuclides">[docs]</a>    <span class="k">def</span> <span class="nf">getNuclides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return nuclides in the component that contains this Material.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method is the only reason Materials still have self.parent. Essentially, we want to</span>
<span class="sd">        change that, but right now the logic for finding nuclides in the Reactor is recursive and</span>
<span class="sd">        considers Materials first. The bulk of the work in finally removing this method will come in</span>
<span class="sd">        downstream repos, where users have fully embraced this method and call it directly in many,</span>
<span class="sd">        many places. Please do not use this method, as it is being deprecated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Material.getNuclides is being deprecated.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">getNuclides</span><span class="p">()</span></div>

<div class="viewcode-block" id="Material.getTempChangeForDensityChange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getTempChangeForDensityChange">[docs]</a>    <span class="k">def</span> <span class="nf">getTempChangeForDensityChange</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">densityFrac</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a temperature difference for a given density perturbation.&quot;&quot;&quot;</span>
        <span class="n">linearExpansion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linearExpansion</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">linearChange</span> <span class="o">=</span> <span class="n">densityFrac</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="n">deltaT</span> <span class="o">=</span> <span class="n">linearChange</span> <span class="o">/</span> <span class="n">linearExpansion</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The linear expansion for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="si">}</span><span class="s2"> at initial temperature of </span><span class="si">{</span><span class="n">Tc</span><span class="si">}</span><span class="s2"> C is &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">linearExpansion</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">A change in density of </span><span class="si">{</span><span class="p">(</span><span class="n">densityFrac</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="si">}</span><span class="s2"> percent &quot;</span>
                <span class="s2">&quot;at would require a change in temperature of </span><span class="si">{deltaT}</span><span class="s2"> C.&quot;</span><span class="p">,</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">deltaT</span></div>

<div class="viewcode-block" id="Material.heatCapacity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.heatCapacity">[docs]</a>    <span class="k">def</span> <span class="nf">heatCapacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns heat capacity in units of J/kg/C.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Material </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> does not implement heatCapacity&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Material.getTD"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.getTD">[docs]</a>    <span class="k">def</span> <span class="nf">getTD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the fraction of theoretical density for this material.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span></div>

<div class="viewcode-block" id="Material.adjustTD"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Material.adjustTD">[docs]</a>    <span class="k">def</span> <span class="nf">adjustTD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set or change the fraction of theoretical density for this material.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearCache</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Fluid"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid">[docs]</a><span class="k">class</span> <span class="nc">Fluid</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A material that fills its container. Could also be a gas.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Fluid.getThermalExpansionDensityReduction"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.getThermalExpansionDensityReduction">[docs]</a>    <span class="k">def</span> <span class="nf">getThermalExpansionDensityReduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prevTempInC</span><span class="p">,</span> <span class="n">newTempInC</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the factor required to update thermal expansion going from one temperature (in</span>
<span class="sd">        Celcius) to a new temperature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rho0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">prevTempInC</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rho0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">newTempInC</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rho1</span> <span class="o">/</span> <span class="n">rho0</span></div>

<div class="viewcode-block" id="Fluid.linearExpansion"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.linearExpansion">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For void, lets just not allow temperature changes to change dimensions</span>
<span class="sd">        since it is a liquid it will fill its space.</span>

<span class="sd">        .. impl:: Fluid materials are not thermally expandable.</span>
<span class="sd">            :id: I_ARMI_MAT_FLUID</span>
<span class="sd">            :implements: R_ARMI_MAT_FLUID</span>

<span class="sd">            ARMI does not model thermal expansion of fluids. The ``Fluid`` superclass therefore sets</span>
<span class="sd">            the thermal expansion coefficient to zero. All fluids subclassing  the ``Fluid``</span>
<span class="sd">            material will inherit this method which sets the linear expansion coefficient to zero at</span>
<span class="sd">            all temperatures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Fluid.getTempChangeForDensityChange"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.getTempChangeForDensityChange">[docs]</a>    <span class="k">def</span> <span class="nf">getTempChangeForDensityChange</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">densityFrac</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a temperature difference for a given density perturbation.&quot;&quot;&quot;</span>
        <span class="n">currentDensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>
        <span class="n">perturbedDensity</span> <span class="o">=</span> <span class="n">currentDensity</span> <span class="o">*</span> <span class="n">densityFrac</span>
        <span class="n">tAtPerturbedDensity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTemperatureAtDensity</span><span class="p">(</span><span class="n">perturbedDensity</span><span class="p">,</span> <span class="n">Tc</span><span class="p">)</span>
        <span class="n">deltaT</span> <span class="o">=</span> <span class="n">tAtPerturbedDensity</span> <span class="o">-</span> <span class="n">Tc</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;A change in density of </span><span class="si">{}</span><span class="s2"> percent in </span><span class="si">{}</span><span class="s2"> at an initial temperature of </span><span class="si">{}</span><span class="s2"> C would &quot;</span>
                <span class="s2">&quot;require a change in temperature of </span><span class="si">{}</span><span class="s2"> C.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">densityFrac</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">deltaT</span>
                <span class="p">),</span>
                <span class="n">single</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">deltaT</span></div>

<div class="viewcode-block" id="Fluid.density"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.Fluid.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the density at the specified temperature for 3D expansion (in g/cm^3).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        For fluids, there is no such thing as 2D expansion so pseudoDensity() is already 3D.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SimpleSolid"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.SimpleSolid">[docs]</a><span class="k">class</span> <span class="nc">SimpleSolid</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base material for a simple material that primarily defines density.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    armi.materials.pseudoDensity:</span>
<span class="sd">    armi.materials.density:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">refTempK</span> <span class="o">=</span> <span class="mi">300</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Material</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refTempK</span><span class="p">)</span>

<div class="viewcode-block" id="SimpleSolid.linearExpansionPercent"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.SimpleSolid.linearExpansionPercent">[docs]</a>    <span class="k">def</span> <span class="nf">linearExpansionPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Average thermal expansion dL/L. Used for computing hot dimensions and density.</span>

<span class="sd">        Defaults to 0.0 for materials that don&#39;t expand.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Tk : float</span>
<span class="sd">            temperature in (K)</span>
<span class="sd">        Tc : float</span>
<span class="sd">            Temperature in (C)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dLL(T) in % m/m/K</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This only method only works for Simple Solid Materials which assumes the density function</span>
<span class="sd">        returns &#39;free expansion&#39; density as a function temperature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">density1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">refTempK</span><span class="p">)</span>
        <span class="n">density2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">density1</span> <span class="o">==</span> <span class="n">density2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">((</span><span class="n">density1</span> <span class="o">/</span> <span class="n">density2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="SimpleSolid.density"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.SimpleSolid.density">[docs]</a>    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Material density (in g/cm^3).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="SimpleSolid.pseudoDensity"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.SimpleSolid.pseudoDensity">[docs]</a>    <span class="k">def</span> <span class="nf">pseudoDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Tc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The same method as the parent class, but with the ability to apply a</span>
<span class="sd">        non-unity theoretical density (in g/cm^3).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Material</span><span class="o">.</span><span class="n">pseudoDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tk</span><span class="o">=</span><span class="n">Tk</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTD</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="FuelMaterial"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.FuelMaterial">[docs]</a><span class="k">class</span> <span class="nc">FuelMaterial</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Material that is considered a nuclear fuel.</span>

<span class="sd">    All this really does is enable the special class 1/class 2 isotopics input option.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">class1_wt_frac</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">class1_custom_isotopics</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">class2_custom_isotopics</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">puFrac</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">uFrac</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">zrFrac</span> <span class="o">=</span> <span class="mf">0.0</span>

<div class="viewcode-block" id="FuelMaterial.applyInputParams"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.FuelMaterial.applyInputParams">[docs]</a>    <span class="k">def</span> <span class="nf">applyInputParams</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">class1_custom_isotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">class2_custom_isotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">class1_wt_frac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">customIsotopics</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply optional class 1/class 2 custom enrichment input.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is often overridden to insert customized material modification parameters but then this</span>
<span class="sd">        parent should always be called at the end in case users want to use this style of custom</span>
<span class="sd">        input.</span>

<span class="sd">        This is only applied to materials considered fuel so we don&#39;t apply these kinds of</span>
<span class="sd">        parameters to coolants and structural material, which are often not parameterized with any</span>
<span class="sd">        kind of enrichment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">class1_wt_frac</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">class1_wt_frac</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;class1_wt_frac must be between 0 and 1 (inclusive).&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; Right now it is </span><span class="si">{</span><span class="n">class1_wt_frac</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="n">validIsotopics</span> <span class="o">=</span> <span class="n">customIsotopics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">errMsg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> &#39;</span><span class="si">{}</span><span class="s2">&#39; not found in the defined custom isotopics.&quot;</span>
            <span class="k">if</span> <span class="n">class1_custom_isotopics</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">validIsotopics</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="n">errMsg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;class1_custom_isotopics&quot;</span><span class="p">,</span> <span class="n">class1_custom_isotopics</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">class2_custom_isotopics</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">validIsotopics</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                    <span class="n">errMsg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;class2_custom_isotopics&quot;</span><span class="p">,</span> <span class="n">class2_custom_isotopics</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">class1_custom_isotopics</span> <span class="o">==</span> <span class="n">class2_custom_isotopics</span><span class="p">:</span>
                <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;The custom isotopics specified for the class1/class2 materials are both &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">class1_custom_isotopics</span><span class="si">}</span><span class="s2">&#39;. You are not actually blending anything!&quot;</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">class1_wt_frac</span> <span class="o">=</span> <span class="n">class1_wt_frac</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">class1_custom_isotopics</span> <span class="o">=</span> <span class="n">class1_custom_isotopics</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">class2_custom_isotopics</span> <span class="o">=</span> <span class="n">class2_custom_isotopics</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_applyIsotopicsMixFromCustomIsotopicsInput</span><span class="p">(</span><span class="n">customIsotopics</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_applyIsotopicsMixFromCustomIsotopicsInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customIsotopics</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a Class 1/Class 2 mixture of custom isotopics at input.</span>

<span class="sd">        Only adjust heavy metal.</span>

<span class="sd">        This may also be needed for building charge assemblies during reprocessing, but will take</span>
<span class="sd">        input from the SFP rather than from the input external feeds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">class1Isotopics</span> <span class="o">=</span> <span class="n">customIsotopics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">class1_custom_isotopics</span><span class="p">]</span>
        <span class="n">class2Isotopics</span> <span class="o">=</span> <span class="n">customIsotopics</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">class2_custom_isotopics</span><span class="p">]</span>
        <span class="n">densityTools</span><span class="o">.</span><span class="n">applyIsotopicsMix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class1Isotopics</span><span class="p">,</span> <span class="n">class2Isotopics</span><span class="p">)</span>

<div class="viewcode-block" id="FuelMaterial.duplicate"><a class="viewcode-back" href="../../../.apidocs/armi.materials.material.html#armi.materials.material.FuelMaterial.duplicate">[docs]</a>    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy without needing a deepcopy.&quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

        <span class="n">m</span><span class="o">.</span><span class="n">massFrac</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">massFrac</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">m</span><span class="o">.</span><span class="n">massFrac</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="n">m</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="n">m</span><span class="o">.</span><span class="n">refDens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refDens</span>
        <span class="n">m</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theoreticalDensityFrac</span>

        <span class="n">m</span><span class="o">.</span><span class="n">class1_wt_frac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class1_wt_frac</span>
        <span class="n">m</span><span class="o">.</span><span class="n">class1_custom_isotopics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class1_custom_isotopics</span>
        <span class="n">m</span><span class="o">.</span><span class="n">class2_custom_isotopics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class2_custom_isotopics</span>
        <span class="n">m</span><span class="o">.</span><span class="n">puFrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">puFrac</span>
        <span class="n">m</span><span class="o">.</span><span class="n">uFrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">uFrac</span>
        <span class="n">m</span><span class="o">.</span><span class="n">zrFrac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zrFrac</span>

        <span class="k">return</span> <span class="n">m</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2024, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2024-08-15.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>