<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>armi.physics.neutronics.settings &mdash; ARMI 0.2.9 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            ARMI
              <img src="../../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../armi.html">armi</a></li>
          <li class="breadcrumb-item"><a href="../neutronics.html">armi.physics.neutronics</a></li>
      <li class="breadcrumb-item active">armi.physics.neutronics.settings</li>
  <li class="wy-breadcrumbs-aside">
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for armi.physics.neutronics.settings</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;Some generic neutronics-related settings.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi.operators</span> <span class="kn">import</span> <span class="n">settingsValidation</span>
<span class="kn">from</span> <span class="nn">armi.physics.neutronics.const</span> <span class="kn">import</span> <span class="n">NEUTRON</span>
<span class="kn">from</span> <span class="nn">armi.physics.neutronics.energyGroups</span> <span class="kn">import</span> <span class="n">GROUP_STRUCTURE</span>
<span class="kn">from</span> <span class="nn">armi.physics.neutronics</span> <span class="kn">import</span> <span class="n">LatticePhysicsFrequency</span>
<span class="kn">from</span> <span class="nn">armi.settings</span> <span class="kn">import</span> <span class="n">setting</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">directoryChangers</span>
<span class="kn">from</span> <span class="nn">armi.settings.fwSettings.globalSettings</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CONF_DETAILED_AXIAL_EXPANSION</span><span class="p">,</span>
    <span class="n">CONF_NON_UNIFORM_ASSEM_FLAGS</span><span class="p">,</span>
    <span class="n">CONF_RUN_TYPE</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">CONF_BC_COEFFICIENT</span> <span class="o">=</span> <span class="s2">&quot;bcCoefficient&quot;</span>
<span class="n">CONF_BOUNDARIES</span> <span class="o">=</span> <span class="s2">&quot;boundaries&quot;</span>
<span class="n">CONF_DPA_PER_FLUENCE</span> <span class="o">=</span> <span class="s2">&quot;dpaPerFluence&quot;</span>
<span class="n">CONF_EIGEN_PROB</span> <span class="o">=</span> <span class="s2">&quot;eigenProb&quot;</span>
<span class="n">CONF_EPS_EIG</span> <span class="o">=</span> <span class="s2">&quot;epsEig&quot;</span>
<span class="n">CONF_EPS_FSAVG</span> <span class="o">=</span> <span class="s2">&quot;epsFSAvg&quot;</span>
<span class="n">CONF_EPS_FSPOINT</span> <span class="o">=</span> <span class="s2">&quot;epsFSPoint&quot;</span>
<span class="n">CONF_EXISTING_FIXED_SOURCE</span> <span class="o">=</span> <span class="s2">&quot;existingFixedSource&quot;</span>
<span class="n">CONF_GEN_XS</span> <span class="o">=</span> <span class="s2">&quot;genXS&quot;</span>  <span class="c1"># gamma stuff and neutronics plugin/lattice physics</span>
<span class="n">CONF_GLOBAL_FLUX_ACTIVE</span> <span class="o">=</span> <span class="s2">&quot;globalFluxActive&quot;</span>
<span class="n">CONF_GROUP_STRUCTURE</span> <span class="o">=</span> <span class="s2">&quot;groupStructure&quot;</span>
<span class="n">CONF_INNERS_</span> <span class="o">=</span> <span class="s2">&quot;inners&quot;</span>
<span class="n">CONF_LOADING_FILE</span> <span class="o">=</span> <span class="s2">&quot;loadingFile&quot;</span>
<span class="n">CONF_NEUTRONICS_KERNEL</span> <span class="o">=</span> <span class="s2">&quot;neutronicsKernel&quot;</span>
<span class="n">CONF_NEUTRONICS_TYPE</span> <span class="o">=</span> <span class="s2">&quot;neutronicsType&quot;</span>
<span class="n">CONF_NUMBER_MESH_PER_EDGE</span> <span class="o">=</span> <span class="s2">&quot;numberMeshPerEdge&quot;</span>
<span class="n">CONF_OUTERS_</span> <span class="o">=</span> <span class="s2">&quot;outers&quot;</span>
<span class="n">CONF_RESTART_NEUTRONICS</span> <span class="o">=</span> <span class="s2">&quot;restartNeutronics&quot;</span>

<span class="c1"># Used for dpa/dose analysis.</span>
<span class="c1"># TODO: These should be relocated to more design-specific places</span>
<span class="n">CONF_ACLP_DOSE_LIMIT</span> <span class="o">=</span> <span class="s2">&quot;aclpDoseLimit&quot;</span>
<span class="n">CONF_DPA_XS_SET</span> <span class="o">=</span> <span class="s2">&quot;dpaXsSet&quot;</span>
<span class="n">CONF_GRID_PLATE_DPA_XS_SET</span> <span class="o">=</span> <span class="s2">&quot;gridPlateDpaXsSet&quot;</span>
<span class="n">CONF_LOAD_PAD_ELEVATION</span> <span class="o">=</span> <span class="s2">&quot;loadPadElevation&quot;</span>
<span class="n">CONF_LOAD_PAD_LENGTH</span> <span class="o">=</span> <span class="s2">&quot;loadPadLength&quot;</span>

<span class="n">CONF_OPT_DPA</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dpa_EBRII_INC600&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dpa_EBRII_INCX750&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dpa_EBRII_HT9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dpa_EBRII_PE16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dpa_EBRII_INC625&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># moved from xsSettings</span>
<span class="n">CONF_CLEAR_XS</span> <span class="o">=</span> <span class="s2">&quot;clearXS&quot;</span>
<span class="n">CONF_MINIMUM_FISSILE_FRACTION</span> <span class="o">=</span> <span class="s2">&quot;minimumFissileFraction&quot;</span>
<span class="n">CONF_MINIMUM_NUCLIDE_DENSITY</span> <span class="o">=</span> <span class="s2">&quot;minimumNuclideDensity&quot;</span>
<span class="n">CONF_INFINITE_DILUTE_CUTOFF</span> <span class="o">=</span> <span class="s2">&quot;infiniteDiluteCutoff&quot;</span>
<span class="n">CONF_TOLERATE_BURNUP_CHANGE</span> <span class="o">=</span> <span class="s2">&quot;tolerateBurnupChange&quot;</span>
<span class="n">CONF_XS_BLOCK_REPRESENTATION</span> <span class="o">=</span> <span class="s2">&quot;xsBlockRepresentation&quot;</span>
<span class="n">CONF_DISABLE_BLOCK_TYPE_EXCLUSION_IN_XS_GENERATION</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;disableBlockTypeExclusionInXsGeneration&quot;</span>
<span class="p">)</span>
<span class="n">CONF_XS_KERNEL</span> <span class="o">=</span> <span class="s2">&quot;xsKernel&quot;</span>
<span class="n">CONF_XS_SCATTERING_ORDER</span> <span class="o">=</span> <span class="s2">&quot;xsScatteringOrder&quot;</span>
<span class="n">CONF_XS_BUCKLING_CONVERGENCE</span> <span class="o">=</span> <span class="s2">&quot;xsBucklingConvergence&quot;</span>
<span class="n">CONF_XS_EIGENVALUE_CONVERGENCE</span> <span class="o">=</span> <span class="s2">&quot;xsEigenvalueConvergence&quot;</span>
<span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span> <span class="o">=</span> <span class="s2">&quot;latticePhysicsFrequency&quot;</span>


<div class="viewcode-block" id="defineSettings"><a class="viewcode-back" href="../../../../.apidocs/armi.physics.neutronics.settings.html#armi.physics.neutronics.settings.defineSettings">[docs]</a><span class="k">def</span> <span class="nf">defineSettings</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Standard function to define settings - for neutronics.</span>

<span class="sd">    .. impl:: Users to select if gamma cross sections are generated.</span>
<span class="sd">        :id: I_ARMI_GAMMA_XS</span>
<span class="sd">        :implements: R_ARMI_GAMMA_XS</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_GROUP_STRUCTURE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;ANL33&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of Energy Groups&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Energy group structure to use in neutronics simulations&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;ANL9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL33&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL70&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL116&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL230&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL703&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL1041&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANL2082&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ARMI33&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ARMI45&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CINDER63&quot;</span><span class="p">,</span>
                <span class="s2">&quot;348&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_GLOBAL_FLUX_ACTIVE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Neutron&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Global Flux Calculation&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Calculate the global flux at each timestep for the selected &quot;</span>
            <span class="s2">&quot;particle type(s) using the specified neutronics kernel (see Global Flux &quot;</span>
            <span class="s2">&quot;tab).&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutron&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutron and Gamma&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_GEN_XS</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multigroup Cross Sections Generation&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Generate multigroup cross sections for the selected particle &quot;</span>
            <span class="s2">&quot;type(s) using the specified lattice physics kernel (see Lattice Physics &quot;</span>
            <span class="s2">&quot;tab). When not set, the XS library will be auto-loaded from an existing ISOTXS &quot;</span>
            <span class="s2">&quot;within then working directory and fail if the ISOTXS does not exist.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutron&quot;</span><span class="p">,</span> <span class="s2">&quot;Neutron and Gamma&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_DPA_PER_FLUENCE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">4.01568627451e-22</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DPA Per Fluence&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A quick and dirty conversion that is used to get &quot;</span>
            <span class="s2">&quot;dpaPeak by multiplying the factor and fastFluencePeak&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_BC_COEFFICIENT</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parameter A for generalized BC&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Value for the parameter A of the generalized boundary &quot;</span>
            <span class="s2">&quot;condition.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_BOUNDARIES</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Extrapolated&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Neutronic BCs&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;External Neutronic Boundary Conditions. Reflective does not &quot;</span>
            <span class="s2">&quot;include axial.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Extrapolated&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Reflective&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Infinite&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ZeroSurfaceFlux&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ZeroInwardCurrent&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Generalized&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">enforcedOptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_NEUTRONICS_KERNEL</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Neutronics Kernel&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The neutronics / depletion solver for global flux solve.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">enforcedOptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_NEUTRONICS_TYPE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Neutronics Type&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The type of neutronics solution that is desired.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;real&quot;</span><span class="p">,</span> <span class="s2">&quot;adjoint&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_EIGEN_PROB</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalue Problem&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether this is a eigenvalue problem or a fixed source problem&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_EXISTING_FIXED_SOURCE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Existing fixed source input&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Specify an exiting fixed source input file.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;FIXSRC&quot;</span><span class="p">,</span> <span class="s2">&quot;VARSRC&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_NUMBER_MESH_PER_EDGE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of Mesh per Edge&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of mesh per block edge for finite-difference planar &quot;</span>
            <span class="s2">&quot;mesh refinement.&quot;</span><span class="p">,</span>
            <span class="n">oldNames</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;hexSideSubdivisions&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_EPS_EIG</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalue Epsilon&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence criteria for calculating the eigenvalue in the global flux solver&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_EPS_FSAVG</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FS Avg. epsilon&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence criteria for average fission source&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_EPS_FSPOINT</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FS Point epsilon&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence criteria for point fission source&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_LOAD_PAD_ELEVATION</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Load pad elevation (cm)&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;The elevation of the bottom of the above-core load pad (ACLP) in cm &quot;</span>
                <span class="s2">&quot;from the bottom of the upper grid plate. Used for calculating the load &quot;</span>
                <span class="s2">&quot;pad dose&quot;</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_LOAD_PAD_LENGTH</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Load pad length (cm)&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The length of the load pad. Used to compute average and peak dose.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_ACLP_DOSE_LIMIT</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ALCP dose limit&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Dose limit in dpa used to position the above-core load pad (if one exists)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_RESTART_NEUTRONICS</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Restart neutronics&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Restart global flux case using outputs from last time as a guess&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_OUTERS_</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max Outer Iterations&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;XY and Axial partial current sweep max outer iterations.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_INNERS_</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inner Iterations&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;XY and Axial partial current sweep inner iterations. 0 lets the neutronics code pick a default.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_GRID_PLATE_DPA_XS_SET</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;dpa_EBRII_HT9&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Grid plate DPA XS&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;The cross sections to use for grid plate blocks DPA when computing &quot;</span>
                <span class="s2">&quot;displacements per atom.&quot;</span>
            <span class="p">),</span>
            <span class="n">options</span><span class="o">=</span><span class="n">CONF_OPT_DPA</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_DPA_XS_SET</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;dpa_EBRII_HT9&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DPA Cross Sections&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The cross sections to use when computing displacements per atom.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="n">CONF_OPT_DPA</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_CLEAR_XS</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Clear XS&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Delete all cross section libraries before regenerating them.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_MINIMUM_FISSILE_FRACTION</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">0.045</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Minimum Fissile Fraction&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum fissile fraction (fissile number densities / heavy metal number densities).&quot;</span><span class="p">,</span>
            <span class="n">oldNames</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;mc2.minimumFissileFraction&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_MINIMUM_NUCLIDE_DENSITY</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Minimum nuclide density&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Density to use for nuclides and fission products at infinite dilution. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;This is also used as the minimum density considered for computing macroscopic cross &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;sections. It can also be passed to physics plugins.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_INFINITE_DILUTE_CUTOFF</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Infinite Dillute Cutoff&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Do not model nuclides with density less than this cutoff. Used with PARTISN and SERPENT.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_TOLERATE_BURNUP_CHANGE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cross Section Burnup Group Tolerance&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Burnup window for computing cross sections. If the prior cross sections were computed within the window, new cross sections will not be generated and the prior calculated cross sections will be used.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_XS_BLOCK_REPRESENTATION</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;Average&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cross Section Block Averaging Method&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The type of averaging to perform when creating cross sections for a group of blocks&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Median&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Average&quot;</span><span class="p">,</span>
                <span class="s2">&quot;FluxWeightedAverage&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ComponentAverage1DSlab&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_DISABLE_BLOCK_TYPE_EXCLUSION_IN_XS_GENERATION</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Include All Block Types in XS Generation&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Use all blocks in a cross section group when generating a representative block. When this is disabled only `fuel` blocks will be considered&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_XS_KERNEL</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;MC2v3&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Lattice Physics Kernel&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Method to determine broad group cross sections for assemblies&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;MC2v2&quot;</span><span class="p">,</span> <span class="s2">&quot;MC2v3&quot;</span><span class="p">,</span> <span class="s2">&quot;MC2v3-PARTISN&quot;</span><span class="p">,</span> <span class="s2">&quot;SERPENT&quot;</span><span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="s2">&quot;BOC&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Frequency of lattice physics updates&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Define the frequency at which cross sections are updated with new lattice physics interactions.&quot;</span><span class="p">,</span>
            <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">LatticePhysicsFrequency</span><span class="p">)],</span>
            <span class="n">enforcedOptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_XS_SCATTERING_ORDER</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scattering Order&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Scattering order for the lattice physics calculation&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_XS_BUCKLING_CONVERGENCE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Buckling Convergence Criteria&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence criteria for the buckling iteration if it is available in the lattice physics solver&quot;</span><span class="p">,</span>
            <span class="n">oldNames</span><span class="o">=</span><span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;mc2BucklingConvergence&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;bucklingConvergence&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">),</span>
        <span class="n">setting</span><span class="o">.</span><span class="n">Setting</span><span class="p">(</span>
            <span class="n">CONF_XS_EIGENVALUE_CONVERGENCE</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalue Convergence Criteria&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence criteria for the eigenvalue in the lattice physics kernel&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">settings</span></div>


<span class="k">def</span> <span class="nf">_blueprintsHasOldXSInput</span><span class="p">(</span><span class="n">inspector</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_LOADING_FILE</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">directoryChangers</span><span class="o">.</span><span class="n">DirectoryChanger</span><span class="p">(</span><span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">inputDirectory</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">path</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;cross sections:&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>


<div class="viewcode-block" id="getNeutronicsSettingValidators"><a class="viewcode-back" href="../../../../.apidocs/armi.physics.neutronics.settings.html#armi.physics.neutronics.settings.getNeutronicsSettingValidators">[docs]</a><span class="k">def</span> <span class="nf">getNeutronicsSettingValidators</span><span class="p">(</span><span class="n">inspector</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The standard helper method, to provide validators to neutronics settings.&quot;&quot;&quot;</span>
    <span class="n">queries</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">migrateXSOption</span><span class="p">(</span><span class="n">name0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `genXS` and `globalFluxActive` settings used to take True/False as inputs,</span>
<span class="sd">        this helper method migrates those to the new values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">name0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">NEUTRON</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;False&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">modified</span><span class="p">(</span><span class="n">newSettings</span><span class="o">=</span><span class="p">{</span><span class="n">name0</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">migrateXSOptionGenXS</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;pass-through to migrateXSOption(), because Query functions cannot take arguements.&quot;&quot;&quot;</span>
        <span class="n">migrateXSOption</span><span class="p">(</span><span class="n">CONF_GEN_XS</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">migrateXSOptionGlobalFluxActive</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;pass-through to migrateXSOption(), because Query functions cannot take arguements.&quot;&quot;&quot;</span>
        <span class="n">migrateXSOption</span><span class="p">(</span><span class="n">CONF_GLOBAL_FLUX_ACTIVE</span><span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GEN_XS</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">),</span>
            <span class="s2">&quot;The </span><span class="si">{0}</span><span class="s2"> setting cannot not take `True` or `False` as an exact value any more.&quot;</span><span class="p">,</span>
            <span class="s1">&#39;Would you like to auto-correct </span><span class="si">{0}</span><span class="s1"> to the correct value? (&quot;&quot; or </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_GEN_XS</span><span class="p">,</span> <span class="n">NEUTRON</span>
            <span class="p">),</span>
            <span class="n">migrateXSOptionGenXS</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GLOBAL_FLUX_ACTIVE</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">),</span>
            <span class="s2">&quot;The </span><span class="si">{0}</span><span class="s2"> setting cannot not take `True` or `False` as an exact value any more.&quot;</span><span class="p">,</span>
            <span class="s1">&#39;Would you like to auto-correct </span><span class="si">{0}</span><span class="s1"> to the correct value? (&quot;&quot; or </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_GLOBAL_FLUX_ACTIVE</span><span class="p">,</span> <span class="n">NEUTRON</span>
            <span class="p">),</span>
            <span class="n">migrateXSOptionGlobalFluxActive</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">migrateNormalBCSetting</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The `boundary` setting is migrated from `Normal` to `Extrapolated`.&quot;&quot;&quot;</span>
        <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">modified</span><span class="p">(</span>
            <span class="n">newSettings</span><span class="o">=</span><span class="p">{</span><span class="n">CONF_BOUNDARIES</span><span class="p">:</span> <span class="s2">&quot;Extrapolated&quot;</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_BOUNDARIES</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;The </span><span class="si">{0}</span><span class="s2"> setting now takes `Extrapolated` instead of `Normal` as a value.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_BOUNDARIES</span>
            <span class="p">),</span>
            <span class="s2">&quot;Would you like to auto-correct </span><span class="si">{0}</span><span class="s2"> from `Normal` to `Extrapolated`?&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_BOUNDARIES</span>
            <span class="p">),</span>
            <span class="n">migrateNormalBCSetting</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">updateXSGroupStructure</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trying to migrate to a valid XS group structure name.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GROUP_STRUCTURE</span><span class="p">]</span>
        <span class="n">newValue</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">newValue</span> <span class="ow">in</span> <span class="n">GROUP_STRUCTURE</span><span class="p">:</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Updating the cross section group structure from </span><span class="si">{}</span><span class="s2"> to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">value</span><span class="p">,</span> <span class="n">newValue</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newValue</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">getSetting</span><span class="p">(</span><span class="n">CONF_GROUP_STRUCTURE</span><span class="p">)</span><span class="o">.</span><span class="n">default</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Unable to automatically convert the </span><span class="si">{}</span><span class="s2"> setting of </span><span class="si">{}</span><span class="s2">. Defaulting to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">CONF_GROUP_STRUCTURE</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">newValue</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">modified</span><span class="p">(</span>
            <span class="n">newSettings</span><span class="o">=</span><span class="p">{</span><span class="n">CONF_GROUP_STRUCTURE</span><span class="p">:</span> <span class="n">newValue</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GROUP_STRUCTURE</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">GROUP_STRUCTURE</span><span class="p">,</span>
            <span class="s2">&quot;The given group structure </span><span class="si">{0}</span><span class="s2"> was not recognized.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GROUP_STRUCTURE</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="s2">&quot;Would you like to auto-correct the group structure value?&quot;</span><span class="p">,</span>
            <span class="n">updateXSGroupStructure</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">migrateDpa</span><span class="p">(</span><span class="n">name0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Migrating some common shortened names for dpa XS sets.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">name0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;dpaHT9_33&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;dpaHT9_ANL33_TwrBol&quot;</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;dpa_SS316&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;dpaSS316_ANL33_TwrBol&quot;</span>

        <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">modified</span><span class="p">(</span><span class="n">newSettings</span><span class="o">=</span><span class="p">{</span><span class="n">name0</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">migrateDpaDpaXsSet</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pass-through to migrateDpa(), because Query functions cannot take arguements.&quot;&quot;&quot;</span>
        <span class="n">migrateDpa</span><span class="p">(</span><span class="n">CONF_DPA_XS_SET</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">migrateDpaGridPlate</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pass-through to migrateDpa(), because Query functions cannot take arguements.&quot;&quot;&quot;</span>
        <span class="n">migrateDpa</span><span class="p">(</span><span class="n">CONF_GRID_PLATE_DPA_XS_SET</span><span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_DPA_XS_SET</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;dpaHT9_33&quot;</span><span class="p">,</span> <span class="s2">&quot;dpa_SS316&quot;</span><span class="p">),</span>
            <span class="s2">&quot;It appears you are using a shortened version of the </span><span class="si">{0}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_DPA_XS_SET</span>
            <span class="p">),</span>
            <span class="s2">&quot;Would you like to auto-correct this to the full name?&quot;</span><span class="p">,</span>
            <span class="n">migrateDpaDpaXsSet</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GRID_PLATE_DPA_XS_SET</span><span class="p">]</span>
            <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;dpaHT9_33&quot;</span><span class="p">,</span> <span class="s2">&quot;dpa_SS316&quot;</span><span class="p">),</span>
            <span class="s2">&quot;It appears you are using a shortened version of the </span><span class="si">{0}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">CONF_GRID_PLATE_DPA_XS_SET</span>
            <span class="p">),</span>
            <span class="s2">&quot;Would you like to auto-correct this to the full name?&quot;</span><span class="p">,</span>
            <span class="n">migrateDpaGridPlate</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_DETAILED_AXIAL_EXPANSION</span><span class="p">]</span>
            <span class="ow">and</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_NON_UNIFORM_ASSEM_FLAGS</span><span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;The use of </span><span class="si">{</span><span class="n">CONF_DETAILED_AXIAL_EXPANSION</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">CONF_NON_UNIFORM_ASSEM_FLAGS</span><span class="si">}</span><span class="s2"> is not supported.&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Automatically set non-uniform assembly treatment to its default?&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">_assignCS</span><span class="p">(</span>
                <span class="n">CONF_NON_UNIFORM_ASSEM_FLAGS</span><span class="p">,</span>
                <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">getSetting</span><span class="p">(</span><span class="n">CONF_NON_UNIFORM_ASSEM_FLAGS</span><span class="p">)</span><span class="o">.</span><span class="n">default</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">queryMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;A Snapshots case is selected but the `latticePhysicsFrequency` &quot;</span>
        <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> is less than `firstCoupledIteration`. `firstCoupledIteration`&quot;</span>
        <span class="s2">&quot; or `all` is recommended for Snapshots when they involve large changes &quot;</span>
        <span class="s2">&quot;in power or flow compared to the loaded state.&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span><span class="p">])</span>
    <span class="n">queryPrompt</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Would you like to update `latticePhysicsFrequency` from &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span><span class="p">]</span><span class="si">}</span><span class="s2"> to `firstCoupledIteration`?&quot;</span>
    <span class="p">)</span>
    <span class="n">queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">settingsValidation</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_RUN_TYPE</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Snapshots&quot;</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">LatticePhysicsFrequency</span><span class="p">[</span>
                <span class="n">inspector</span><span class="o">.</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="o">&gt;=</span> <span class="n">LatticePhysicsFrequency</span><span class="o">.</span><span class="n">firstCoupledIteration</span><span class="p">,</span>
            <span class="n">queryMsg</span><span class="p">,</span>
            <span class="n">queryPrompt</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">inspector</span><span class="o">.</span><span class="n">_assignCS</span><span class="p">(</span>
                <span class="n">CONF_LATTICE_PHYSICS_FREQUENCY</span><span class="p">,</span> <span class="s2">&quot;firstCoupledIteration&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">queries</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2023, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2023-12-04.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>