<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>armi.bookkeeping.report.reportingUtils &mdash; ARMI 0.2.9 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            ARMI
              <img src="../../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.2.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../../armi.html">armi</a></li>
          <li class="breadcrumb-item"><a href="../../bookkeeping.html">armi.bookkeeping</a></li>
          <li class="breadcrumb-item"><a href="../report.html">armi.bookkeeping.report</a></li>
      <li class="breadcrumb-item active">armi.bookkeeping.report.reportingUtils</li>
  <li class="wy-breadcrumbs-aside">
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for armi.bookkeeping.report.reportingUtils</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A collection of miscellaneous functions used by ReportInterface to generate</span>
<span class="sd">various reports.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">tabulate</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">context</span>
<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">interfaces</span>
<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>
<span class="kn">from</span> <span class="nn">armi.bookkeeping</span> <span class="kn">import</span> <span class="n">report</span>
<span class="kn">from</span> <span class="nn">armi.operators</span> <span class="kn">import</span> <span class="n">RunTypes</span>
<span class="kn">from</span> <span class="nn">armi.reactor.components</span> <span class="kn">import</span> <span class="n">ComponentType</span>
<span class="kn">from</span> <span class="nn">armi.reactor.flags</span> <span class="kn">import</span> <span class="n">Flags</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">getFileSHA1Hash</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">iterables</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">textProcessors</span>
<span class="kn">from</span> <span class="nn">armi.utils</span> <span class="kn">import</span> <span class="n">units</span>


<span class="c1"># Set to prevent the image and text from being too small to read.</span>
<span class="n">MAX_ASSEMS_PER_ASSEM_PLOT</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># String constants</span>
<span class="n">Operator_CaseTitle</span> <span class="o">=</span> <span class="s2">&quot;Case Title:&quot;</span>
<span class="n">Operator_TypeOfRun</span> <span class="o">=</span> <span class="s2">&quot;Run Type:&quot;</span>
<span class="n">Operator_NumProcessors</span> <span class="o">=</span> <span class="s2">&quot;Number of Processors:&quot;</span>
<span class="n">Operator_WorkingDirectory</span> <span class="o">=</span> <span class="s2">&quot;Working Directory:&quot;</span>
<span class="n">Operator_CurrentUser</span> <span class="o">=</span> <span class="s2">&quot;Current User:&quot;</span>
<span class="n">Operator_PythonInterperter</span> <span class="o">=</span> <span class="s2">&quot;Python Interpreter:&quot;</span>
<span class="n">Operator_ArmiCodebase</span> <span class="o">=</span> <span class="s2">&quot;ARMI Location:&quot;</span>
<span class="n">Operator_MasterMachine</span> <span class="o">=</span> <span class="s2">&quot;Master Machine:&quot;</span>
<span class="n">Operator_Date</span> <span class="o">=</span> <span class="s2">&quot;Date and Time:&quot;</span>
<span class="n">Operator_CaseDescription</span> <span class="o">=</span> <span class="s2">&quot;Case Description:&quot;</span>


<div class="viewcode-block" id="writeWelcomeHeaders"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.writeWelcomeHeaders">[docs]</a><span class="k">def</span> <span class="nf">writeWelcomeHeaders</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write welcome information using the Operator and the Case Settings.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_writeCaseInformation</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a table that contains basic case information.&quot;&quot;&quot;</span>
        <span class="n">caseInfo</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">Operator_CaseTitle</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span><span class="p">),</span>
            <span class="p">(</span>
                <span class="n">Operator_CaseDescription</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">],</span> <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="n">Operator_TypeOfRun</span><span class="p">,</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;runType&quot;</span><span class="p">],</span> <span class="n">o</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="n">Operator_CurrentUser</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">USER</span><span class="p">),</span>
            <span class="p">(</span><span class="n">Operator_ArmiCodebase</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">ROOT</span><span class="p">),</span>
            <span class="p">(</span><span class="n">Operator_WorkingDirectory</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()),</span>
            <span class="p">(</span><span class="n">Operator_PythonInterperter</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">),</span>
            <span class="p">(</span><span class="n">Operator_MasterMachine</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;COMPUTERNAME&quot;</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">)),</span>
            <span class="p">(</span><span class="n">Operator_NumProcessors</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">MPI_SIZE</span><span class="p">),</span>
            <span class="p">(</span><span class="n">Operator_Date</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">START_TIME</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">runLog</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;=========== Case Information ===========&quot;</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">caseInfo</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_listInputFiles</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers information about the input files of this case.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        inputInfo : list</span>
<span class="sd">            (label, fileName, shaHash) tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">armi.physics.neutronics.settings</span> <span class="kn">import</span> <span class="n">CONF_LOADING_FILE</span>

        <span class="n">pathToLoading</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">inputDirectory</span><span class="p">)</span> <span class="o">/</span> <span class="n">cs</span><span class="p">[</span><span class="n">CONF_LOADING_FILE</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">pathToLoading</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">includedBlueprints</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">inclusion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">inclusion</span> <span class="ow">in</span> <span class="n">textProcessors</span><span class="o">.</span><span class="n">findYamlInclusions</span><span class="p">(</span><span class="n">pathToLoading</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">includedBlueprints</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">inputInfo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">inputFiles</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;Case Settings&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span> <span class="o">+</span> <span class="s2">&quot;.yaml&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Blueprints&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="n">CONF_LOADING_FILE</span><span class="p">]),</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;Included blueprints&quot;</span><span class="p">,</span> <span class="n">inclBp</span><span class="p">)</span> <span class="k">for</span> <span class="n">inclBp</span> <span class="ow">in</span> <span class="n">includedBlueprints</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;Geometry&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;geomFile&quot;</span><span class="p">])]</span>
        <span class="p">)</span>

        <span class="n">activeInterfaces</span> <span class="o">=</span> <span class="n">interfaces</span><span class="o">.</span><span class="n">getActiveInterfaceInfo</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">klass</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">activeInterfaces</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="c1"># Don&#39;t consider disabled interfaces</span>
                <span class="k">continue</span>
            <span class="n">interfaceFileNames</span> <span class="o">=</span> <span class="n">klass</span><span class="o">.</span><span class="n">specifyInputs</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">fileNames</span> <span class="ow">in</span> <span class="n">interfaceFileNames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">fName</span> <span class="ow">in</span> <span class="n">fileNames</span><span class="p">:</span>
                    <span class="n">inputFiles</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">label</span><span class="p">,</span> <span class="n">fName</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;reloadDBName&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;runType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">RunTypes</span><span class="o">.</span><span class="n">SNAPSHOTS</span><span class="p">:</span>
            <span class="n">inputFiles</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;Database&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;reloadDBName&quot;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">fName</span> <span class="ow">in</span> <span class="n">inputFiles</span><span class="p">:</span>
            <span class="n">shaHash</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;MISSING&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">fName</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fName</span><span class="p">))</span>
                <span class="k">else</span> <span class="n">getFileSHA1Hash</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">inputInfo</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">label</span><span class="p">,</span> <span class="n">fName</span><span class="p">,</span> <span class="n">shaHash</span><span class="p">))</span>

        <span class="c1"># bonus: grab the files stored in the crossSectionControl section</span>
        <span class="k">for</span> <span class="n">fluxSection</span><span class="p">,</span> <span class="n">fluxData</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;crossSectionControl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">fluxData</span><span class="o">.</span><span class="n">xsFileLocation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;crossSectionControl-</span><span class="si">{</span><span class="n">fluxSection</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">fName</span> <span class="o">=</span> <span class="n">fluxData</span><span class="o">.</span><span class="n">xsFileLocation</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">fName</span> <span class="o">=</span> <span class="n">fName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">fName</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fName</span><span class="p">):</span>
                    <span class="n">shaHash</span> <span class="o">=</span> <span class="n">getFileSHA1Hash</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                    <span class="n">inputInfo</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">label</span><span class="p">,</span> <span class="n">fName</span><span class="p">,</span> <span class="n">shaHash</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">inputInfo</span>

    <span class="k">def</span> <span class="nf">_writeInputFileInformation</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a table that contains basic input file information.&quot;&quot;&quot;</span>
        <span class="n">inputFileData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">shaHash</span><span class="p">)</span> <span class="ow">in</span> <span class="n">_listInputFiles</span><span class="p">(</span><span class="n">cs</span><span class="p">):</span>
            <span class="n">inputFileData</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">label</span><span class="p">,</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">shaHash</span><span class="p">))</span>

        <span class="n">runLog</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;=========== Input File Information ===========&quot;</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span>
                <span class="n">inputFileData</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Input Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;SHA-1 Hash&quot;</span><span class="p">],</span>
                <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_writeMachineInformation</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a table that contains basic machine and rank information.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">MPI_SIZE</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">processorNames</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">MPI_NODENAMES</span>
            <span class="n">uniqueNames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">processorNames</span><span class="p">)</span>
            <span class="n">nodeMappingData</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">uniqueName</span> <span class="ow">in</span> <span class="n">uniqueNames</span><span class="p">:</span>
                <span class="n">matchingProcs</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="n">procName</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">processorNames</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">procName</span> <span class="o">==</span> <span class="n">uniqueName</span>
                <span class="p">]</span>
                <span class="n">numProcessors</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matchingProcs</span><span class="p">))</span>
                <span class="n">nodeMappingData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">uniqueName</span><span class="p">,</span> <span class="n">numProcessors</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">matchingProcs</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;=========== Machine Information ===========&quot;</span><span class="p">)</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span>
                    <span class="n">nodeMappingData</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of Processors&quot;</span><span class="p">,</span> <span class="s2">&quot;Ranks&quot;</span><span class="p">],</span>
                    <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_writeReactorCycleInformation</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify that all the operating parameters are defined for the same number of cycles.&quot;&quot;&quot;</span>
        <span class="n">operatingData</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;Reactor Thermal Power (MW):&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;power&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">WATTS_PER_MW</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Number of Cycles:&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;nCycles&quot;</span><span class="p">]),</span>
        <span class="p">]</span>
        <span class="n">operatingParams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Cycle Lengths:&quot;</span><span class="p">:</span> <span class="n">o</span><span class="o">.</span><span class="n">cycleLengths</span><span class="p">,</span>
            <span class="s2">&quot;Availability Factors:&quot;</span><span class="p">:</span> <span class="n">o</span><span class="o">.</span><span class="n">availabilityFactors</span><span class="p">,</span>
            <span class="s2">&quot;Power Fractions:&quot;</span><span class="p">:</span> <span class="n">o</span><span class="o">.</span><span class="n">powerFractions</span><span class="p">,</span>
            <span class="s2">&quot;Step Lengths (days):&quot;</span><span class="p">:</span> <span class="n">o</span><span class="o">.</span><span class="n">stepLengths</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">operatingParams</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">paramStr</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">param</span><span class="p">]</span>
            <span class="n">operatingData</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paramStr</span><span class="p">))))</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;=========== Reactor Cycle Information ===========&quot;</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">operatingData</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">MPI_RANK</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>  <span class="c1"># prevent the worker nodes from printing the same thing</span>

    <span class="n">_writeCaseInformation</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span>
    <span class="n">_writeInputFileInformation</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
    <span class="n">_writeMachineInformation</span><span class="p">()</span>
    <span class="n">_writeReactorCycleInformation</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">cs</span><span class="p">)</span></div>


<div class="viewcode-block" id="getInterfaceStackSummary"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.getInterfaceStackSummary">[docs]</a><span class="k">def</span> <span class="nf">getInterfaceStackSummary</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">interfaces</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{:02d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">),</span>
                <span class="n">i</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Interface&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                <span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">i</span><span class="o">.</span><span class="n">function</span><span class="p">,</span>
                <span class="s2">&quot;Yes&quot;</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">enabled</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;No&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Reversed&quot;</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">reverseAtEOL</span> <span class="k">else</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yes&quot;</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">bolForce</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;No&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Function&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Enabled&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EOL order&quot;</span><span class="p">,</span>
            <span class="s2">&quot;BOL forced&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
    <span class="k">return</span> <span class="n">text</span></div>


<div class="viewcode-block" id="writeTightCouplingConvergenceSummary"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.writeTightCouplingConvergenceSummary">[docs]</a><span class="k">def</span> <span class="nf">writeTightCouplingConvergenceSummary</span><span class="p">(</span><span class="n">convergenceSummary</span><span class="p">):</span>
    <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Tight Coupling Convergence Summary&quot;</span><span class="p">)</span>
    <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span>
            <span class="n">convergenceSummary</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;keys&quot;</span><span class="p">,</span> <span class="n">showindex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;armi&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="writeAssemblyMassSummary"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.writeAssemblyMassSummary">[docs]</a><span class="k">def</span> <span class="nf">writeAssemblyMassSummary</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print out things like Assembly weights to the runLog.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    r : armi.reactor.reactors.Reactor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">massSum</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemblies</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">mass</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">hmMass</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">fissileMass</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">coolantMass</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># to calculate wet vs. dry weight.</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="c1"># get masses in kg</span>
            <span class="c1"># skip stationary blocks (grid plate doesn&#39;t count)</span>
            <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">hasFlags</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">GRID_PLATE</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">mass</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">getMass</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">hmMass</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">getHMMass</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">fissileMass</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">getFissileMass</span><span class="p">()</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">coolants</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponents</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">COOLANT</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponents</span><span class="p">(</span>
                <span class="n">Flags</span><span class="o">.</span><span class="n">INTERCOOLANT</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">coolantMass</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">coolant</span><span class="o">.</span><span class="n">getMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">coolant</span> <span class="ow">in</span> <span class="n">coolants</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>

            <span class="n">blockType</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getType</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">blockType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blockType</span><span class="p">)</span>
        <span class="c1"># if the BOL fuel assem is in the center of the core, its area is 1/3 of the full area b/c it&#39;s a sliced assem.</span>
        <span class="c1"># bug: mass came out way high for a case once. 265 MT vs. 92 MT hm.</span>

        <span class="c1"># count assemblies</span>
        <span class="n">core</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">core</span>
        <span class="n">thisTypeList</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getChildrenOfType</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getType</span><span class="p">())</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">thisTypeList</span><span class="p">:</span>
            <span class="n">ring</span><span class="p">,</span> <span class="n">_pos</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">spatialLocator</span><span class="o">.</span><span class="n">getRingPos</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ring</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># only count center location once.</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># add 3 if it&#39;s 1/3 core, etc.</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="n">core</span><span class="o">.</span><span class="n">powerMultiplier</span>

        <span class="c1"># Get the dominant materials</span>
        <span class="n">pinMaterialKey</span> <span class="o">=</span> <span class="s2">&quot;pinMaterial&quot;</span>
        <span class="n">pinMaterialObj</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getDominantMaterial</span><span class="p">([</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">,</span> <span class="n">Flags</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">pinMaterialObj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pinMaterialObj</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getDominantMaterial</span><span class="p">()</span>
            <span class="n">pinMaterialKey</span> <span class="o">=</span> <span class="s2">&quot;dominantMaterial&quot;</span>
            <span class="n">pinMaterial</span> <span class="o">=</span> <span class="n">pinMaterialObj</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pinMaterial</span> <span class="o">=</span> <span class="n">pinMaterialObj</span><span class="o">.</span><span class="n">name</span>

        <span class="n">struct</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getDominantMaterial</span><span class="p">([</span><span class="n">Flags</span><span class="o">.</span><span class="n">CLAD</span><span class="p">,</span> <span class="n">Flags</span><span class="o">.</span><span class="n">DUCT</span><span class="p">,</span> <span class="n">Flags</span><span class="o">.</span><span class="n">SHIELD</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">struct</span><span class="p">:</span>
            <span class="n">structuralMaterial</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">structuralMaterial</span> <span class="o">=</span> <span class="s2">&quot;[None]&quot;</span>
        <span class="n">cool</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getDominantMaterial</span><span class="p">([</span><span class="n">Flags</span><span class="o">.</span><span class="n">COOLANT</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cool</span><span class="p">:</span>
            <span class="n">coolantMaterial</span> <span class="o">=</span> <span class="n">cool</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">coolantMaterial</span> <span class="o">=</span> <span class="s2">&quot;[None]&quot;</span>

        <span class="c1"># Get pins per assembly</span>
        <span class="n">pinsPerAssembly</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">,</span> <span class="n">Flags</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">,</span> <span class="n">Flags</span><span class="o">.</span><span class="n">SHIELD</span><span class="p">):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getFirstBlock</span><span class="p">(</span><span class="n">candidate</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">pinsPerAssembly</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getNumPins</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pinsPerAssembly</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">massSum</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">getType</span><span class="p">(),</span>
                <span class="s2">&quot;wetMass&quot;</span><span class="p">:</span> <span class="n">mass</span><span class="p">,</span>
                <span class="s2">&quot;hmMass&quot;</span><span class="p">:</span> <span class="n">hmMass</span><span class="p">,</span>
                <span class="s2">&quot;fissileMass&quot;</span><span class="p">:</span> <span class="n">fissileMass</span><span class="p">,</span>
                <span class="s2">&quot;dryMass&quot;</span><span class="p">:</span> <span class="n">mass</span> <span class="o">-</span> <span class="n">coolantMass</span><span class="p">,</span>
                <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
                <span class="s2">&quot;components&quot;</span><span class="p">:</span> <span class="n">types</span><span class="p">,</span>
                <span class="n">pinMaterialKey</span><span class="p">:</span> <span class="n">pinMaterial</span><span class="p">,</span>
                <span class="s2">&quot;structuralMaterial&quot;</span><span class="p">:</span> <span class="n">structuralMaterial</span><span class="p">,</span>
                <span class="s2">&quot;coolantMaterial&quot;</span><span class="p">:</span> <span class="n">coolantMaterial</span><span class="p">,</span>
                <span class="s2">&quot;pinsPerAssembly&quot;</span><span class="p">:</span> <span class="n">pinsPerAssembly</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="n">_makeBOLAssemblyMassSummary</span><span class="p">(</span><span class="n">massSum</span><span class="p">))</span>
    <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="n">_makeTotalAssemblyMassSummary</span><span class="p">(</span><span class="n">massSum</span><span class="p">))</span></div>


<span class="k">def</span> <span class="nf">_makeBOLAssemblyMassSummary</span><span class="p">(</span><span class="n">massSum</span><span class="p">):</span>
    <span class="n">str_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;--- BOL Assembly Mass Summary (kg) ---&quot;</span><span class="p">]</span>
    <span class="n">dataLabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wetMass&quot;</span><span class="p">,</span> <span class="s2">&quot;dryMass&quot;</span><span class="p">,</span> <span class="s2">&quot;fissileMass&quot;</span><span class="p">,</span> <span class="s2">&quot;hmMass&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]</span>
    <span class="c1"># print header for the printout of each assembly type</span>
    <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{0:25s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">massSum</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dataLabels</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">massSum</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{0:&lt;25.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">val</span><span class="p">])</span>
        <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:12s}{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>

    <span class="c1"># print blocks in this assembly</span>
    <span class="c1"># up to 10</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">12</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">massSum</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{0:25s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">25</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\S&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>  <span class="c1"># \S matches any non-whitespace character.</span>
            <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_makeTotalAssemblyMassSummary</span><span class="p">(</span><span class="n">massSum</span><span class="p">):</span>
    <span class="n">massLabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;wetMass&quot;</span><span class="p">,</span> <span class="s2">&quot;dryMass&quot;</span><span class="p">,</span> <span class="s2">&quot;fissileMass&quot;</span><span class="p">,</span> <span class="s2">&quot;hmMass&quot;</span><span class="p">]</span>
    <span class="n">totals</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">str_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;--Totals--&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">massLabels</span><span class="p">:</span>
        <span class="n">totals</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">assemSum</span> <span class="ow">in</span> <span class="n">massSum</span><span class="p">:</span>
            <span class="n">totals</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">+=</span> <span class="n">assemSum</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">*</span> <span class="n">assemSum</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="n">assemSum</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
        <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:12s}</span><span class="s2"> </span><span class="si">{1:.2f}</span><span class="s2"> MT&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">totals</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">))</span>
    <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Total assembly count: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span> <span class="o">//</span> <span class="nb">len</span><span class="p">(</span><span class="n">massLabels</span><span class="p">)))</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_</span><span class="p">)</span>


<div class="viewcode-block" id="writeCycleSummary"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.writeCycleSummary">[docs]</a><span class="k">def</span> <span class="nf">writeCycleSummary</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints a cycle summary to the runLog.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core:  armi.reactor.reactors.Core</span>
<span class="sd">    cs: armi.settings.caseSettings.Settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># would io be worth considering for this?</span>
    <span class="n">cycle</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">cycle</span>
    <span class="n">str_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="s2">&quot;Cycle </span><span class="si">{0}</span><span class="s2"> Summary:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cycle</span><span class="p">))</span>
    <span class="n">avgBu</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;percentBu&quot;</span><span class="p">,</span> <span class="n">typeSpec</span><span class="o">=</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Core Average Burnup: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgBu</span><span class="p">))</span>
    <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Idealized Outlet Temperature </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">THoutletTempIdeal</span><span class="p">))</span>
    <span class="n">str_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;End of Cycle </span><span class="si">{0:02d}</span><span class="s2">. Timestamp: </span><span class="si">{1}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cycle</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">()))</span>

    <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_</span><span class="p">))</span></div>


<div class="viewcode-block" id="setNeutronBalancesReport"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.setNeutronBalancesReport">[docs]</a><span class="k">def</span> <span class="nf">setNeutronBalancesReport</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines the various neutron balances over the full core.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core  : armi.reactor.reactors.Core</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">getFirstBlock</span><span class="p">()</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">rateCap</span><span class="p">:</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;No rate information (rateCap, rateAbs, etc.) available &quot;</span>
            <span class="s2">&quot;on the blocks. Skipping balance summary.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="n">cap</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;rateCap&quot;</span><span class="p">,</span> <span class="n">volumeAveraged</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">absorb</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;rateAbs&quot;</span><span class="p">,</span> <span class="n">volumeAveraged</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fis</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;rateFis&quot;</span><span class="p">,</span> <span class="n">volumeAveraged</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">n2nProd</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;rateProdN2n&quot;</span><span class="p">,</span> <span class="n">volumeAveraged</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fisProd</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;rateProdFis&quot;</span><span class="p">,</span> <span class="n">volumeAveraged</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">leak</span> <span class="o">=</span> <span class="n">n2nProd</span> <span class="o">+</span> <span class="n">fisProd</span> <span class="o">-</span> <span class="n">absorb</span>

    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Fission&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fisProd</span><span class="p">,</span> <span class="n">fisProd</span> <span class="o">/</span> <span class="p">(</span><span class="n">fisProd</span> <span class="o">+</span> <span class="n">n2nProd</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_PROD</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;n, 2n&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n2nProd</span><span class="p">,</span> <span class="n">n2nProd</span> <span class="o">/</span> <span class="p">(</span><span class="n">fisProd</span> <span class="o">+</span> <span class="n">n2nProd</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_PROD</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Capture&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cap</span><span class="p">,</span> <span class="n">cap</span> <span class="o">/</span> <span class="p">(</span><span class="n">absorb</span> <span class="o">+</span> <span class="n">leak</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_LOSS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Fission&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fis</span><span class="p">,</span> <span class="n">fis</span> <span class="o">/</span> <span class="p">(</span><span class="n">absorb</span> <span class="o">+</span> <span class="n">leak</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_LOSS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Absorption&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">absorb</span><span class="p">,</span> <span class="n">absorb</span> <span class="o">/</span> <span class="p">(</span><span class="n">absorb</span> <span class="o">+</span> <span class="n">leak</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_LOSS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Leakage&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{0:.5e}</span><span class="s2"> (</span><span class="si">{1:.2%}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="n">leak</span> <span class="o">/</span> <span class="p">(</span><span class="n">absorb</span> <span class="o">+</span> <span class="n">leak</span><span class="p">)),</span>
        <span class="n">report</span><span class="o">.</span><span class="n">NEUT_LOSS</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">ALL</span><span class="p">[</span><span class="n">report</span><span class="o">.</span><span class="n">NEUT_PROD</span><span class="p">])</span>
    <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">ALL</span><span class="p">[</span><span class="n">report</span><span class="o">.</span><span class="n">NEUT_LOSS</span><span class="p">])</span></div>


<div class="viewcode-block" id="summarizePinDesign"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.summarizePinDesign">[docs]</a><span class="k">def</span> <span class="nf">summarizePinDesign</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints out some information about the pin assembly/duct design.</span>

<span class="sd">    Handles multiple types of dimensions simplistically by taking the average.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core : armi.reactor.reactors.Core</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">designInfo</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">getBlocks</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">):</span>
            <span class="n">fuel</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span>
            <span class="n">duct</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">DUCT</span><span class="p">)</span>
            <span class="n">clad</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">CLAD</span><span class="p">)</span>
            <span class="n">wire</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getComponent</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">WIRE</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;hot sd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getSmearDensity</span><span class="p">(</span><span class="n">cold</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;sd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getSmearDensity</span><span class="p">())</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;ductThick&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">duct</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">duct</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">))</span> <span class="o">*</span> <span class="mf">5.0</span>
            <span class="p">)</span>  <span class="c1"># convert to mm and divide by 2</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;cladThick&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">clad</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;od&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">clad</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span> <span class="o">*</span> <span class="mf">5.0</span>
            <span class="p">)</span>
            <span class="n">pinOD</span> <span class="o">=</span> <span class="n">clad</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;od&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>
            <span class="n">wireOD</span> <span class="o">=</span> <span class="n">wire</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;od&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>
            <span class="n">pitch</span> <span class="o">=</span> <span class="n">pinOD</span> <span class="o">+</span> <span class="n">wireOD</span>  <span class="c1"># pitch has half a wire on each side.</span>
            <span class="n">assemPitch</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getPitch</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># convert cm to mm.</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;pinOD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pinOD</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;wireOD&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wireOD</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;pin pitch&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span>
            <span class="n">pinToDuctGap</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">getPinToDuctGap</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pinToDuctGap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;pinToDuct&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getPinToDuctGap</span><span class="p">()</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;assemPitch&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assemPitch</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;duct gap&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assemPitch</span> <span class="o">-</span> <span class="n">duct</span><span class="o">.</span><span class="n">getDimension</span><span class="p">(</span><span class="s2">&quot;op&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;nPins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">nPins</span><span class="p">)</span>
            <span class="n">designInfo</span><span class="p">[</span><span class="s2">&quot;zrFrac&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fuel</span><span class="o">.</span><span class="n">getMassFrac</span><span class="p">(</span><span class="s2">&quot;ZR&quot;</span><span class="p">))</span>

        <span class="c1"># assumption made that all lists contain only numerical data</span>
        <span class="n">designInfo</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">designInfo</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">dimensionless</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sd&quot;</span><span class="p">,</span> <span class="s2">&quot;hot sd&quot;</span><span class="p">,</span> <span class="s2">&quot;zrFrac&quot;</span><span class="p">,</span> <span class="s2">&quot;nPins&quot;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">average_value</span> <span class="ow">in</span> <span class="n">designInfo</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">average_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dimensionless</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">+=</span> <span class="s2">&quot; mm&quot;</span>
            <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">PIN_ASSEM_DESIGN</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">refAssem</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Fuel Height (cm):&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getHeight</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)),</span>
            <span class="n">report</span><span class="o">.</span><span class="n">PIN_ASSEM_DESIGN</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Plenum Height (cm):&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">getHeight</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">PLENUM</span><span class="p">)),</span>
            <span class="n">report</span><span class="o">.</span><span class="n">PIN_ASSEM_DESIGN</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">ALL</span><span class="p">[</span><span class="n">report</span><span class="o">.</span><span class="n">PIN_ASSEM_DESIGN</span><span class="p">])</span>

        <span class="n">first_fuel_block</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getFirstBlock</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Design &amp; component information for first fuel block </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">first_fuel_block</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">first_fuel_block</span><span class="o">.</span><span class="n">setAreaFractionsReport</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">component_</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">first_fuel_block</span><span class="p">):</span>
            <span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">component_</span><span class="o">.</span><span class="n">setDimensionReport</span><span class="p">())</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Pin summarization failed to work&quot;</span><span class="p">)</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error</span><span class="p">)</span></div>


<div class="viewcode-block" id="summarizePowerPeaking"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.summarizePowerPeaking">[docs]</a><span class="k">def</span> <span class="nf">summarizePowerPeaking</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints reactor Fz, Fxy, Fq.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core : armi.reactor.reactors.Core</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fz is the axial peaking of the highest power assembly</span>
    <span class="n">_maxPow</span><span class="p">,</span> <span class="n">maxPowBlock</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getMaxParam</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">,</span> <span class="n">returnObj</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">generationNum</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">maxPowAssem</span> <span class="o">=</span> <span class="n">maxPowBlock</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">avgPDens</span> <span class="o">=</span> <span class="n">maxPowAssem</span><span class="o">.</span><span class="n">calcAvgParam</span><span class="p">(</span><span class="s2">&quot;pdens&quot;</span><span class="p">)</span>
    <span class="n">peakPDens</span> <span class="o">=</span> <span class="n">maxPowAssem</span><span class="o">.</span><span class="n">getMaxParam</span><span class="p">(</span><span class="s2">&quot;pdens&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">avgPDens</span><span class="p">:</span>
        <span class="c1"># protect against divide-by-zero. Peaking doesnt make sense if there is no</span>
        <span class="c1"># power.</span>
        <span class="k">return</span>
    <span class="n">axPeakF</span> <span class="o">=</span> <span class="n">peakPDens</span> <span class="o">/</span> <span class="n">avgPDens</span>

    <span class="c1"># Fxy is the radial peaking factor, looking at ALL assemblies with axially integrated powers.</span>
    <span class="n">power</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
        <span class="n">power</span> <span class="o">+=</span> <span class="n">a</span><span class="o">.</span><span class="n">calcTotalParam</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">,</span> <span class="n">typeSpec</span><span class="o">=</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span>
    <span class="n">avgPow</span> <span class="o">=</span> <span class="n">power</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">radPeakF</span> <span class="o">=</span> <span class="n">maxPowAssem</span><span class="o">.</span><span class="n">calcTotalParam</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">,</span> <span class="n">typeSpec</span><span class="o">=</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span> <span class="o">/</span> <span class="n">avgPow</span>

    <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span>
        <span class="s2">&quot;Power Peaking: Fz= </span><span class="si">{0:.3f}</span><span class="s2"> Fxy= </span><span class="si">{1:.3f}</span><span class="s2"> Fq= </span><span class="si">{2:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">axPeakF</span><span class="p">,</span> <span class="n">radPeakF</span><span class="p">,</span> <span class="n">axPeakF</span> <span class="o">*</span> <span class="n">radPeakF</span>
        <span class="p">)</span>
    <span class="p">)</span></div>


<div class="viewcode-block" id="summarizePower"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.summarizePower">[docs]</a><span class="k">def</span> <span class="nf">summarizePower</span><span class="p">(</span><span class="n">core</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide an edit showing where the power is based on assembly types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core : armi.reactor.reactors.Core</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sums</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">pmult</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">powerMultiplier</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">core</span><span class="p">:</span>
        <span class="n">sums</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">getType</span><span class="p">()]</span> <span class="o">+=</span> <span class="n">a</span><span class="o">.</span><span class="n">calcTotalParam</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">pmult</span>

    <span class="c1"># calculate total power</span>
    <span class="n">tot</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sums</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
    <span class="c1"># NOTE: if tot is 0.0, set to infinity to prevent ZeroDivisionError</span>

    <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span><span class="s2">&quot;Power summary&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">atype</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sums</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">runLog</span><span class="o">.</span><span class="n">important</span><span class="p">(</span>
            <span class="s2">&quot; Power in </span><span class="si">{0:35s}</span><span class="s2">: </span><span class="si">{1:0.3E}</span><span class="s2"> Watts, </span><span class="si">{2:0.5f}</span><span class="s2">%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">atype</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">val</span> <span class="o">/</span> <span class="n">tot</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="makeCoreDesignReport"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.makeCoreDesignReport">[docs]</a><span class="k">def</span> <span class="nf">makeCoreDesignReport</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">cs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds report to summarize core design inputs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    core:  armi.reactor.reactors.Core</span>
<span class="sd">    cs: armi.settings.caseSettings.Settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coreDesignTable</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
        <span class="s2">&quot;SUMMARY OF CORE: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="n">coreDesignTable</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Input Parameter&quot;</span><span class="p">]</span>

    <span class="c1"># Change the ordering of the core design table in the report relative to the other data</span>
    <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">groupsOrderFirst</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">componentWellGroups</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">)</span>

    <span class="n">_setGeneralCoreDesignData</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">)</span>
    <span class="n">_setGeneralCoreParametersData</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">)</span>
    <span class="n">_setGeneralSimulationData</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_setGeneralCoreDesignData</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">armi.physics.fuelCycle.settings</span> <span class="kn">import</span> <span class="n">CONF_SHUFFLE_LOGIC</span>
    <span class="kn">from</span> <span class="nn">armi.physics.neutronics.settings</span> <span class="kn">import</span> <span class="n">CONF_LOADING_FILE</span>

    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Case Title&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span><span class="p">),</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Run Type&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;runType&quot;</span><span class="p">]),</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Geometry File&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;geomFile&quot;</span><span class="p">]),</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Loading File&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_LOADING_FILE</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Fuel Shuffling Logic File&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_SHUFFLE_LOGIC</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Reactor State Loading&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;loadStyle&quot;</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;loadStyle&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fromDB&quot;</span><span class="p">:</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Database File&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;reloadDBName&quot;</span><span class="p">]),</span>
            <span class="n">coreDesignTable</span><span class="p">,</span>
            <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Starting Cycle&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;startCycle&quot;</span><span class="p">]),</span>
            <span class="n">coreDesignTable</span><span class="p">,</span>
            <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Starting Node&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;startNode&quot;</span><span class="p">]),</span>
            <span class="n">coreDesignTable</span><span class="p">,</span>
            <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">_setGeneralCoreParametersData</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">):</span>
    <span class="n">blocks</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getBlocks</span><span class="p">()</span>
    <span class="n">totalMass</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">)</span>
    <span class="n">fissileMass</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getFissileMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">)</span>
    <span class="n">heavyMetalMass</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getHMMass</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">)</span>
    <span class="n">totalVolume</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Core Power&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> MWth&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;power&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">WATTS_PER_MW</span><span class="p">),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Base Capacity Factor&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;availabilityFactor&quot;</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># note this doesn&#39;t consider availabilityFactors</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Cycle Length&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> days&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;cycleLength&quot;</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># note this doesn&#39;t consider cycleLengths</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Burnup Cycles&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;nCycles&quot;</span><span class="p">]),</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Burnup Steps per Cycle&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;burnSteps&quot;</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># note this doesn&#39;t consider the detailed cycle input option</span>
    <span class="n">corePowerMult</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">powerMultiplier</span><span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Core Total Volume&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> cc&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">totalVolume</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Core Fissile Mass&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> kg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fissileMass</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">G_PER_KG</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Core Heavy Metal Mass&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> kg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heavyMetalMass</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">G_PER_KG</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Core Total Mass&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2"> kg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">totalMass</span> <span class="o">/</span> <span class="n">units</span><span class="o">.</span><span class="n">G_PER_KG</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Assembly Rings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getNumRings</span><span class="p">()),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Assemblies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getAssemblies</span><span class="p">()</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">)),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Fuel Assemblies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getAssemblies</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">FUEL</span><span class="p">)</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">)),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Control Assemblies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getAssemblies</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">)),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Reflector Assemblies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getAssemblies</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">REFLECTOR</span><span class="p">)</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">)),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Number of Shield Assemblies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getAssemblies</span><span class="p">(</span><span class="n">Flags</span><span class="o">.</span><span class="n">SHIELD</span><span class="p">)</span> <span class="o">*</span> <span class="n">corePowerMult</span><span class="p">)),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_setGeneralSimulationData</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">armi.physics.neutronics.settings</span> <span class="kn">import</span> <span class="n">CONF_GEN_XS</span>
    <span class="kn">from</span> <span class="nn">armi.physics.neutronics.settings</span> <span class="kn">import</span> <span class="n">CONF_GLOBAL_FLUX_ACTIVE</span>

    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Full Core Model&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">isFullCore</span><span class="p">),</span> <span class="n">coreDesignTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Tight Physics Coupling Enabled&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="s2">&quot;tightCoupling&quot;</span><span class="p">])),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Lattice Physics Enabled for&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GEN_XS</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Neutronics Enabled for&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="p">[</span><span class="n">CONF_GLOBAL_FLUX_ACTIVE</span><span class="p">]),</span>
        <span class="n">coreDesignTable</span><span class="p">,</span>
        <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
    <span class="p">)</span>


<div class="viewcode-block" id="makeBlockDesignReport"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.makeBlockDesignReport">[docs]</a><span class="k">def</span> <span class="nf">makeBlockDesignReport</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Summarize the block designs from the loading file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    r : armi.reactor.reactors.Reactor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">bDesign</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">blockDesigns</span><span class="p">:</span>
        <span class="n">loadingFileTable</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
            <span class="s2">&quot;SUMMARY OF BLOCK: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bDesign</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">loadingFileTable</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Input Parameter&quot;</span><span class="p">]</span>

        <span class="c1"># Change the ordering of the loading file table in the report relative to the other data</span>
        <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">groupsOrderFirst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loadingFileTable</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">componentWellGroups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loadingFileTable</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
            <span class="s2">&quot;Number of Components&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">bDesign</span><span class="p">)],</span> <span class="n">loadingFileTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cDesign</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bDesign</span><span class="p">):</span>
            <span class="n">cType</span> <span class="o">=</span> <span class="n">cDesign</span><span class="o">.</span><span class="n">name</span>
            <span class="n">componentSplitter</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">componentSplitter</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">loadingFileTable</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">)</span>
            <span class="n">dimensions</span> <span class="o">=</span> <span class="n">_getComponentInputDimensions</span><span class="p">(</span><span class="n">cDesign</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">values</span>
                <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cType</span><span class="p">,</span> <span class="n">label</span><span class="p">),</span>
                    <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">),</span>
                    <span class="n">loadingFileTable</span><span class="p">,</span>
                    <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span><span class="p">,</span>
                <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_getComponentInputDimensions</span><span class="p">(</span><span class="n">cDesign</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the input dimensions of a component and place them in a dictionary with labels and units.&quot;&quot;&quot;</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
    <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;Shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDesign</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;Material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDesign</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;Cold Temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDesign</span><span class="o">.</span><span class="n">Tinput</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span>
    <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;Hot Temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDesign</span><span class="o">.</span><span class="n">Thot</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cDesign</span><span class="o">.</span><span class="n">isotopics</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;Custom Isotopics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDesign</span><span class="o">.</span><span class="n">isotopics</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dimName</span> <span class="ow">in</span> <span class="n">ComponentType</span><span class="o">.</span><span class="n">TYPES</span><span class="p">[</span><span class="n">cDesign</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span><span class="o">.</span><span class="n">DIMENSION_NAMES</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cDesign</span><span class="p">,</span> <span class="n">dimName</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if not default, add it to the report</span>
            <span class="n">dims</span><span class="p">[</span><span class="n">dimName</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">cDesign</span><span class="p">,</span> <span class="n">dimName</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;cm&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dims</span>


<div class="viewcode-block" id="makeCoreAndAssemblyMaps"><a class="viewcode-back" href="../../../../.apidocs/armi.bookkeeping.report.reportingUtils.html#armi.bookkeeping.report.reportingUtils.makeCoreAndAssemblyMaps">[docs]</a><span class="k">def</span> <span class="nf">makeCoreAndAssemblyMaps</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">generateFullCoreMap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showBlockAxMesh</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create core and assembly design plots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    r : armi.reactor.reactors.Reactor</span>
<span class="sd">    cs: armi.settings.caseSettings.Settings</span>
<span class="sd">    generateFullCoreMap : bool, default False</span>
<span class="sd">    showBlockAxMesh : bool, default True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">assemsInCore</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemblies</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">core</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">core</span>
    <span class="k">for</span> <span class="n">plotNum</span><span class="p">,</span> <span class="n">assemBatch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="n">iterables</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">assemsInCore</span><span class="p">,</span> <span class="n">MAX_ASSEMS_PER_ASSEM_PLOT</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">):</span>
        <span class="n">assemPlotImage</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">ASSEM_TYPES</span><span class="p">)</span>
        <span class="n">assemPlotImage</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">assemPlotImage</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plotNum</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">groupsOrderFirst</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">assemPlotImage</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Report</span><span class="o">.</span><span class="n">componentWellGroups</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">assemPlotImage</span><span class="p">)</span>
        <span class="n">assemPlotName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">core</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">AssemblyTypes</span><span class="si">{</span><span class="n">plotNum</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
        <span class="n">plotting</span><span class="o">.</span><span class="n">plotAssemblyTypes</span><span class="p">(</span>
            <span class="n">core</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">blueprints</span><span class="p">,</span>
            <span class="n">assemPlotName</span><span class="p">,</span>
            <span class="n">assemBatch</span><span class="p">,</span>
            <span class="n">maxAssems</span><span class="o">=</span><span class="n">MAX_ASSEMS_PER_ASSEM_PLOT</span><span class="p">,</span>
            <span class="n">showBlockAxMesh</span><span class="o">=</span><span class="n">showBlockAxMesh</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Create radial core map</span>
    <span class="k">if</span> <span class="n">generateFullCoreMap</span><span class="p">:</span>
        <span class="n">core</span><span class="o">.</span><span class="n">growToFullCore</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">assemDesign</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">getChildrenOfType</span><span class="p">(</span><span class="n">assemDesign</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">assemDesign</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemDesigns</span>
    <span class="p">}</span>
    <span class="c1"># assemDesigns.keys is ordered based on input, assemOrder only contains types that are in the core</span>
    <span class="n">assemOrder</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">aType</span> <span class="k">for</span> <span class="n">aType</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemDesigns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">counts</span><span class="p">[</span><span class="n">aType</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">assemOrder</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">core</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemDesigns</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">specifier</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">core</span><span class="p">]</span>
    <span class="n">legendMap</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="n">ai</span><span class="p">,</span>
            <span class="n">assemDesign</span><span class="o">.</span><span class="n">specifier</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">assemDesign</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">counts</span><span class="p">[</span><span class="n">assemDesign</span><span class="o">.</span><span class="n">name</span><span class="p">]),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">ai</span><span class="p">,</span> <span class="n">assemDesign</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">blueprints</span><span class="o">.</span><span class="n">assemDesigns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">counts</span><span class="p">[</span><span class="n">assemDesign</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">]</span>

    <span class="n">fName</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span><span class="p">,</span> <span class="s2">&quot;RadialCoreMap.&quot;</span><span class="p">,</span> <span class="n">cs</span><span class="p">[</span><span class="s2">&quot;outputFileExtension&quot;</span><span class="p">]])</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plotFaceMap</span><span class="p">(</span>
        <span class="n">core</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> Radial Core Map&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">caseTitle</span><span class="p">),</span>
        <span class="n">fName</span><span class="o">=</span><span class="n">fName</span><span class="p">,</span>
        <span class="n">cmapName</span><span class="o">=</span><span class="s2">&quot;RdYlBu&quot;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">legendMap</span><span class="o">=</span><span class="n">legendMap</span><span class="p">,</span>
        <span class="n">axisEqual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">bare</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">titleSize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">fontSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">report</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span>
        <span class="s2">&quot;Radial Core Map&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">fName</span><span class="p">),</span> <span class="n">report</span><span class="o">.</span><span class="n">FACE_MAP</span><span class="p">,</span> <span class="n">report</span><span class="o">.</span><span class="n">DESIGN</span>
    <span class="p">)</span></div>


<span class="n">COMPONENT_INFO</span> <span class="o">=</span> <span class="s2">&quot;Component Information&quot;</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2023, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2023-12-01.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>