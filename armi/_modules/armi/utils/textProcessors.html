<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>armi.utils.textProcessors &mdash; ARMI 0.3.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ARMI
              <img src="../../../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../../armi.html">armi</a></li>
          <li class="breadcrumb-item"><a href="../utils.html">armi.utils</a></li>
      <li class="breadcrumb-item active">armi.utils.textProcessors</li>
  <li class="wy-breadcrumbs-aside">
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for armi.utils.textProcessors</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 TerraPower, LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="sd">&quot;&quot;&quot;Utility classes and functions for manipulating text files.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">TextIO</span>

<span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>


<span class="n">_INCLUDE_CTOR</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">_INCLUDE_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^([^#]*\s+)?!include\s+(.*)\n?$&quot;</span><span class="p">)</span>
<span class="n">_INDENT_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[\s\-\?:]*([^\s\-\?:].*)?$&quot;</span><span class="p">)</span>

<span class="c1"># String constants</span>
<span class="n">SCIENTIFIC_PATTERN</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[+-]?\d*\.\d+[eEdD][+-]\d+&quot;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Matches:</span>
<span class="sd">* code:` 1.23e10`</span>
<span class="sd">* code:`-1.23Ee10`</span>
<span class="sd">* code:`+1.23d10`</span>
<span class="sd">* code:`  .23D10`</span>
<span class="sd">* code:` 1.23e-10`</span>
<span class="sd">* code:` 1.23e+1`</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">FLOATING_PATTERN</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[+-]?\d+\.*\d*&quot;</span>
<span class="sd">&quot;&quot;&quot;Matches 1, 100, 1.0, -1.2, +12.234&quot;&quot;&quot;</span>

<span class="n">DECIMAL_PATTERN</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[+-]?\d*\.\d+&quot;</span>
<span class="sd">&quot;&quot;&quot;Matches .1, 1.213423, -23.2342, +.023&quot;&quot;&quot;</span>


<div class="viewcode-block" id="FileMark"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.FileMark">[docs]</a><span class="k">class</span> <span class="nc">FileMark</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fName</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">relativeTo</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">fName</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column</span> <span class="o">=</span> <span class="n">column</span>
        <span class="c1"># if the path is relative, where is it relative to? We need this to be able to</span>
        <span class="c1"># normalize relative paths to a root file.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relativeTo</span> <span class="o">=</span> <span class="n">relativeTo</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, line </span><span class="si">{}</span><span class="s2">, column </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">column</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_processIncludes</span><span class="p">(</span>
    <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="n">out</span><span class="p">,</span>
    <span class="n">includes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">FileMark</span><span class="p">]],</span>
    <span class="n">root</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">indentation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">currentFile</span><span class="o">=</span><span class="s2">&quot;&lt;stream&gt;&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the workhorse of ``resolveMarkupInclusions`` and friends.</span>

<span class="sd">    Recursively inserts the contents of !included YAML files into the output stream,</span>
<span class="sd">    keeping track of indentation and a list of included files along the way.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_beginningOfContent</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the position of the first &quot;content&quot; character.</span>

<span class="sd">        This follows the YAML spec at https://yaml.org/spec/current.html#id2519916</span>

<span class="sd">        In short, it will return the position of the first character that is not</span>
<span class="sd">        whitespace or one of the special &quot;block collection&quot; markers (&quot;-&quot;, &quot;?&quot;, and &quot;:&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">_INDENT_RE</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="n">indentSpace</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indentation</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s2">&quot;getvalue&quot;</span><span class="p">):</span>
        <span class="c1"># assume stringIO</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ln</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># assume file stream or TextIOBase, and it has a readlines attr</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="n">leadingSpace</span> <span class="o">=</span> <span class="n">indentSpace</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">_INCLUDE_RE</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="c1"># this line has an !include on it</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">leadingSpace</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">fName</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">root</span> <span class="o">/</span> <span class="n">fName</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The !included file, `</span><span class="si">{}</span><span class="s2">` does not exist from </span><span class="si">{}</span><span class="s2">!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">fName</span><span class="p">,</span> <span class="n">root</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="n">includes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fName</span><span class="p">,</span> <span class="n">FileMark</span><span class="p">(</span><span class="n">currentFile</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">root</span><span class="p">)))</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">includedFile</span><span class="p">:</span>
                <span class="n">firstCharacterPos</span> <span class="o">=</span> <span class="n">_beginningOfContent</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">newIndent</span> <span class="o">=</span> <span class="n">indentation</span> <span class="o">+</span> <span class="n">firstCharacterPos</span>
                <span class="n">_processIncludes</span><span class="p">(</span>
                    <span class="n">includedFile</span><span class="p">,</span>
                    <span class="n">out</span><span class="p">,</span>
                    <span class="n">includes</span><span class="p">,</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                    <span class="n">indentation</span><span class="o">=</span><span class="n">newIndent</span><span class="p">,</span>
                    <span class="n">currentFile</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">leadingSpace</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>


<div class="viewcode-block" id="resolveMarkupInclusions"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.resolveMarkupInclusions">[docs]</a><span class="k">def</span> <span class="nf">resolveMarkupInclusions</span><span class="p">(</span>
    <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process a text stream, appropriately handling ``!include`` tags.</span>

<span class="sd">    This will take the passed IO stream or file path, replacing any instances of</span>
<span class="sd">    ``!include [path]`` with the appropriate contents of the ``!include`` file.</span>

<span class="sd">    What is returned is a new text stream, containing the contents of all of the files</span>
<span class="sd">    stitched together.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    src : StringIO or TextIOBase/Path</span>
<span class="sd">        If a Path is provided, read text from there. If is stream is provided, consume</span>
<span class="sd">        text from the stream. If a stream is provided, ``root`` must also be provided.</span>
<span class="sd">    root : Optional Path</span>
<span class="sd">        The root directory to use for resolving relative paths in !include tags. If a</span>
<span class="sd">        stream is provided for ``src``, ``root`` must be provided. Otherwise, the</span>
<span class="sd">        directory containing the ``src`` path will be used by default.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    While the use of ``!include`` appears as though it would invoke some sort of special</span>
<span class="sd">    custom YAML constructor code, this does not do that. Processing these inclusions as</span>
<span class="sd">    part of the document parsing/composition that comes with ruamel.yaml could</span>
<span class="sd">    work, but has a number of prohibitive drawbacks (or at least reasons why it might</span>
<span class="sd">    not be worth doing). Using a custom constructor is more-or-less supported by</span>
<span class="sd">    ruamel.yaml (which we do use, as it is what underpins the yamlize package), but it</span>
<span class="sd">    carries limitations about how anchors and aliases can cross included-file</span>
<span class="sd">    boundaries. Getting around this requires either monkey-patching ruamel.yaml, or</span>
<span class="sd">    subclassing it, which in turn would require monkey-patching yamlize.</span>

<span class="sd">    Instead, we treat the ``!include``\ s as a sort of pre-processor directive, which</span>
<span class="sd">    essentially pastes the contents of the ``!include``\ d file into the location of the</span>
<span class="sd">    ``!include``. The result is a text stream containing the entire contents, with all</span>
<span class="sd">    ``!include``\ s resolved. The only degree of sophistication lies in how indentation</span>
<span class="sd">    is handled; since YAML cares about indentation to keep track of object hierarchy,</span>
<span class="sd">    care must be taken that the included file contents are indented appropriately.</span>

<span class="sd">    To precisely describe how the indentation works, it helps to have some definitions:</span>

<span class="sd">     - Included file: The file specified in the ``!include [Included file]``</span>
<span class="sd">     - Including line: The line that actually contains the ``!include [Included file]``</span>
<span class="sd">     - Meaningful YAML content: Text in a YAML file that is not either indentation or a</span>
<span class="sd">       special character like &quot;-&quot;, &quot;:&quot; or &quot;?&quot;.</span>

<span class="sd">    The contents of the included file will be indented such that that the first</span>
<span class="sd">    character of each line in the included file will be found at the first column in the</span>
<span class="sd">    including line that contains meaningful YAML content. The only exception is the</span>
<span class="sd">    first line of the included file, which starts at the location of the ``!include``</span>
<span class="sd">    itself and is not deliberately indented.</span>

<span class="sd">    In the future, we may wish to do the more sophisticated processing of the</span>
<span class="sd">    ``!include``\ s as part of the YAML parse. For future reference, there is some pure</span>
<span class="sd">    gold on that topic here:</span>
<span class="sd">    https://stackoverflow.com/questions/44910886/pyyaml-include-file-and-yaml-aliases-anchors-references</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_resolveMarkupInclusions</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">root</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">_getRootFromSrc</span><span class="p">(</span>
    <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="ow">or</span> <span class="n">src</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A stream was provided without a root directory.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unsupported source type: `</span><span class="si">{}</span><span class="s2">`!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">src</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">root</span>


<div class="viewcode-block" id="findYamlInclusions"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.findYamlInclusions">[docs]</a><span class="k">def</span> <span class="nf">findYamlInclusions</span><span class="p">(</span>
    <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">FileMark</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a list containing all of the !included YAML files from a root file.</span>

<span class="sd">    This will attempt to &quot;normalize&quot; relative paths to the passed root. If that is not</span>
<span class="sd">    possible, then an absolute path will be used instead. For example, if a file (A)</span>
<span class="sd">    !includes another file (B) by an absolute path, which in turn !includes more files</span>
<span class="sd">    relative to (B), all of (B)&#39;s relative includes will be turned into absolute paths</span>
<span class="sd">    from the perspective of the root file (A).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">includes</span> <span class="o">=</span> <span class="n">_resolveMarkupInclusions</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">root</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">_getRootFromSrc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
    <span class="n">normalizedIncludes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">mark</span> <span class="ow">in</span> <span class="n">includes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">mark</span><span class="o">.</span><span class="n">relativeTo</span> <span class="o">/</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="n">root</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># Can&#39;t make a relative path. IMO, pathlib gives up a little too early,</span>
                <span class="c1"># but we still probably want to decay to absolute paths if the files</span>
                <span class="c1"># arent in the same tree.</span>
                <span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">mark</span><span class="o">.</span><span class="n">relativeTo</span> <span class="o">/</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

        <span class="n">normalizedIncludes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">path</span><span class="p">,</span> <span class="n">mark</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">normalizedIncludes</span></div>


<span class="k">def</span> <span class="nf">_resolveMarkupInclusions</span><span class="p">(</span>
    <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TextIO</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span> <span class="n">root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">FileMark</span><span class="p">]]]:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">_getRootFromSrc</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">):</span>
        <span class="c1"># this is inefficient, but avoids having to play with io buffers</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rootFile</span><span class="p">:</span>
            <span class="n">src</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">rootFile</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">includes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_processIncludes</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">includes</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>

    <span class="n">out</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># be kind; rewind</span>
    <span class="n">src</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out</span><span class="p">,</span> <span class="n">includes</span>


<div class="viewcode-block" id="SequentialReader"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader">[docs]</a><span class="k">class</span> <span class="nc">SequentialReader</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fast sequential reader that must be used within a with statement.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    line : str</span>
<span class="sd">        value of the current line</span>
<span class="sd">    match : re.match</span>
<span class="sd">        value of the current match</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This reader will sequentially search a file for a regular expression pattern or</span>
<span class="sd">    string depending on the method used. When the pattern/string is matched/found, the</span>
<span class="sd">    reader will stop, return :code:`True`, and set the attributes :code:`line` and</span>
<span class="sd">    :code:`match`.</span>

<span class="sd">    This pattern makes it easy to cycle through repetitive output in a very fast manner.</span>
<span class="sd">    For example, if you had a text file with consistent chuncks of information that</span>
<span class="sd">    always started with the same text followed by information, you could do something</span>
<span class="sd">    like this:</span>

<span class="sd">    &gt;&gt;&gt; with SequentialReader(&#39;somefile&#39;) as sr:</span>
<span class="sd">    ...     data = []</span>
<span class="sd">    ...     while sr.searchForText(&#39;start of data chunk&#39;):</span>
<span class="sd">    ...         # this needs to repeat for as many chunks as there are.</span>
<span class="sd">    ...         if sr.searchForPatternOnNextLine(&#39;some-(?P&lt;data&gt;\w+)-pattern&#39;):</span>
<span class="sd">    ...             data.append(sr.match[&#39;data&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filePath</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filePath</span> <span class="o">=</span> <span class="n">filePath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textErrors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textWarnings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patternErrors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignoreAllErrors</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="SequentialReader.issueWarningOnFindingText"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.issueWarningOnFindingText">[docs]</a>    <span class="k">def</span> <span class="nf">issueWarningOnFindingText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">warning</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a text search for every line of the file, if the text is found the specified warning will be issued.</span>

<span class="sd">        This is important for determining if issues occurred while searching for text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            text to find within the file</span>

<span class="sd">        warning : str</span>
<span class="sd">            An warning message to issue.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        raiseErrorOnFindingText</span>
<span class="sd">        raiseErrorOnFindingPattern</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">warning</span><span class="p">))</span></div>

<div class="viewcode-block" id="SequentialReader.raiseErrorOnFindingText"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.raiseErrorOnFindingText">[docs]</a>    <span class="k">def</span> <span class="nf">raiseErrorOnFindingText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a text search for every line of the file, if the text is found the specified error will be raised.</span>

<span class="sd">        This is important for determining if errors occurred while searching for text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            text to find within the file</span>

<span class="sd">        error : Exception</span>
<span class="sd">            An exception to raise.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        raiseErrorOnFindingPattern</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_textErrors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">error</span><span class="p">))</span></div>

<div class="viewcode-block" id="SequentialReader.raiseErrorOnFindingPattern"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.raiseErrorOnFindingPattern">[docs]</a>    <span class="k">def</span> <span class="nf">raiseErrorOnFindingPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a pattern search for every line of the file, if the pattern is found the specified error will be raised.</span>

<span class="sd">        This is important for determining if errors occurred while searching for text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pattern : str</span>
<span class="sd">            regular expression pattern</span>

<span class="sd">        error : Exception</span>
<span class="sd">            An exception to raise.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        raiseErrorOnFindingText</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patternErrors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">),</span> <span class="n">error</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_filePath</span><span class="p">,</span>
            <span class="s2">&quot;open&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;closed&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filePath</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s2">&quot;Cannot open non-existing file </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filePath</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filePath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="c1"># if checking for errors, we need to keep reading</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">exc_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreAllErrors</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_patternErrors</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textErrors</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readLine</span><span class="p">():</span>  <span class="c1"># all lines have &#39;\n&#39; terminators</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: bare-except</span>
                <span class="c1"># We really don&#39;t care if anything fails here, plus an exception in exit is ignored anyway</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="SequentialReader.searchForText"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.searchForText">[docs]</a>    <span class="k">def</span> <span class="nf">searchForText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Search the file for the next occurrence of :code:`text`, and set the</span>
<span class="sd">        :code:`self.line` attribute to that line&#39;s value if it matched.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This will search the file line by line until it finds the text.  This sets the</span>
<span class="sd">        attribute :code:`self.line`. If the previous :code:`_searchFor*` method did not</span>
<span class="sd">        match, the last line it did not match will be searched first.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matched : bool</span>
<span class="sd">            Boolean inidcating whether or not the pattern matched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readLine</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="SequentialReader.searchForPattern"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.searchForPattern">[docs]</a>    <span class="k">def</span> <span class="nf">searchForPattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Search the file for the next occurece of :code:`pattern` and set the :code:`self.line` attribute to that</span>
<span class="sd">        line&#39;s value if it matched.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This will search the file line by line until it finds the pattern.</span>
<span class="sd">        This sets the attribute :code:`self.line`. If the previous :code:`_searchFor*`</span>
<span class="sd">        method did not match, the last line it did not match will be searched first.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matched : bool</span>
<span class="sd">            Boolean inidcating whether or not the pattern matched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readLine</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="SequentialReader.searchForPatternOnNextLine"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.searchForPatternOnNextLine">[docs]</a>    <span class="k">def</span> <span class="nf">searchForPatternOnNextLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Search the next line for a given pattern, and set the :code:`self.line` attribute to that line&#39;s value if it</span>
<span class="sd">        matched.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This sets the attribute :code:`self.line`. If the previous :code:`_searchFor*`</span>
<span class="sd">        method did not match, the last line it did not match will be searched first.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matched : bool</span>
<span class="sd">            Boolean inidcating whether or not the pattern matched</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readLine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_readLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignoreAllErrors</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textErrors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">error</span>
            <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">warning</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_textWarnings</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">runLog</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">regex</span><span class="p">,</span> <span class="n">error</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patternErrors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">error</span>
        <span class="k">return</span> <span class="n">line</span>

<div class="viewcode-block" id="SequentialReader.consumeLine"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialReader.consumeLine">[docs]</a>    <span class="k">def</span> <span class="nf">consumeLine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Consumes the line.</span>

<span class="sd">        This is necessary when searching for the same pattern repetitively, because</span>
<span class="sd">        otherwise searchForPatternOnNextLine would not work.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="SequentialStringIOReader"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SequentialStringIOReader">[docs]</a><span class="k">class</span> <span class="nc">SequentialStringIOReader</span><span class="p">(</span><span class="n">SequentialReader</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fast sequential reader that must be used within a with statement.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    line : str</span>
<span class="sd">        value of the current line</span>
<span class="sd">    match : re.match</span>
<span class="sd">        value of the current match</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This reader will sequentially search a file for a regular expression pattern or</span>
<span class="sd">    string depending on the method used. When the pattern/string is matched/found, the</span>
<span class="sd">    reader will stop, return :code:`True`, and set the attributes :code:`line` and</span>
<span class="sd">    :code:`match`.</span>

<span class="sd">    This pattern makes it easy to cycle through repetitive output in a very fast manner.</span>
<span class="sd">    For example, if you had a text file with consistent chuncks of information that</span>
<span class="sd">    always started with the same text followed by information, you could do something</span>
<span class="sd">    like this:</span>

<span class="sd">    &gt;&gt;&gt; with SequentialReader(&#39;somefile&#39;) as sr:</span>
<span class="sd">    ...     data = []</span>
<span class="sd">    ...     while sr.searchForText(&#39;start of data chunk&#39;):</span>
<span class="sd">    ...         # this needs to repeat for as many chunks as there are.</span>
<span class="sd">    ...         if sr.searchForPatternOnNextLine(&#39;some-(?P&lt;data&gt;\\w+)-pattern&#39;):</span>
<span class="sd">    ...             data.append(sr.match[&#39;data&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stringIO</span><span class="p">):</span>
        <span class="n">SequentialReader</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;StringIO&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="n">stringIO</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override to prevent trying to open/reopen a StringIO object.</span>

<span class="sd">        We don&#39;t need to override :code:`__exit__`, because it doesn&#39;t care if closing</span>
<span class="sd">        the object fails.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="TextProcessor"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.TextProcessor">[docs]</a><span class="k">class</span> <span class="nc">TextProcessor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A general text processing object that extends python&#39;s abilities to scan through huge files.</span>

<span class="sd">    Use this instead of a raw file object to read data out of output files, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scipat</span> <span class="o">=</span> <span class="n">SCIENTIFIC_PATTERN</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">FLOATING_PATTERN</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="n">DECIMAL_PATTERN</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">highMem</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eChecking</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Preserve python 2-like behavior for unit tests that pass None and provide</span>
        <span class="c1"># their own text data (in py2, passing None to abspath yields cwd; py3 raises)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">fname</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># need this not to fail for detecting when RXSUM doesn&#39;t exist, etc.</span>
                <span class="c1"># note: Could make it check before instantiating...</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">highMem</span><span class="p">:</span>
            <span class="c1"># keep the file on disk, read as necessary</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># read all of f into memory and set up a list that remembers where it is.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">SmartList</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<div class="viewcode-block" id="TextProcessor.reset"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.TextProcessor.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rewinds the file so you can search through it again.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;Text file at </span><span class="si">{0}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="TextProcessor.errorChecking"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.TextProcessor.errorChecking">[docs]</a>    <span class="k">def</span> <span class="nf">errorChecking</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checkForErrors</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eChecking</span> <span class="o">=</span> <span class="n">checkForErrors</span></div>

<div class="viewcode-block" id="TextProcessor.checkErrors"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.TextProcessor.checkErrors">[docs]</a>    <span class="k">def</span> <span class="nf">checkErrors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="TextProcessor.fsearch"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.TextProcessor.fsearch">[docs]</a>    <span class="k">def</span> <span class="nf">fsearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">killOn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">textFlag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches file f for pattern and displays msg when found. Returns line in which</span>
<span class="sd">        pattern is found or FALSE if no pattern is found.</span>
<span class="sd">        Stops searching if finds killOn first.</span>

<span class="sd">        If you specify textFlag=True, the search won&#39;t use a regular expression (and</span>
<span class="sd">        can&#39;t). The basic result is you get less powerful matching capabilities at a</span>
<span class="sd">        huge speedup (10x or so probably, but that&#39;s just a guess.) pattern and killOn</span>
<span class="sd">        must be pure text if you do this.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">textFlag</span><span class="p">:</span>
            <span class="c1"># fast, text-only mode</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eChecking</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">checkErrors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">line</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">killOn</span> <span class="ow">and</span> <span class="n">killOn</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># slower regular expression mode</span>
            <span class="n">cpat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">killOn</span><span class="p">:</span>
                <span class="n">kpat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">killOn</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eChecking</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">checkErrors</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">killOn</span><span class="p">:</span>
                    <span class="n">kill</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">kpat</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">kill</span><span class="p">:</span>
                        <span class="c1"># the kill phrase was found first, so die.</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">break</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">cpat</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">current</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">line</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">current</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">result</span></div></div>


<div class="viewcode-block" id="SmartList"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SmartList">[docs]</a><span class="k">class</span> <span class="nc">SmartList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A list that does stuff like files do i.e. remembers where it was, can seek, etc.</span>
<span class="sd">    Actually this is pretty slow. so much for being smart. nice idea though.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span>

<div class="viewcode-block" id="SmartList.next"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SmartList.next">[docs]</a>    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">c</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)</span>

<div class="viewcode-block" id="SmartList.seek"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SmartList.seek">[docs]</a>    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">line</span></div>

<div class="viewcode-block" id="SmartList.close"><a class="viewcode-back" href="../../../.apidocs/armi.utils.textProcessors.html#armi.utils.textProcessors.SmartList.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2024, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2024-06-15.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>