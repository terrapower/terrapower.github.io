

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta property="og:title" content="9. Tooling and Infrastructure" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://terrapower.github.io/armi/developer/tooling.html" />
  <meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
  <meta property="og:description" content="Good Commit Messages: The ARMI project follows a few basic rules for “good” commit messages: The purpose of the message is to explain to the changes you made to a stranger 5 years from now., Keep y..." />
  <meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
  <meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>9. Tooling and Infrastructure &mdash; ARMI 0.2.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/assets/jsonview.bundle.js"></script>
        <script src="../_static/assets/jsonview_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables.min.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Notes" href="../release/index.html" />
    <link rel="prev" title="8. Standards and Practices for Coding" href="standards_and_practices.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >
          

          
            <a href="../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="guide.html">1. Framework Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="making_armi_based_apps.html">2. Making ARMI-based Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="entrypoints.html">3. Entry Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="documenting.html">4. Documenting ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel_coding.html">5. Parallel Code in ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">6. Profiling ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reports.html">7. Reports in ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="standards_and_practices.html">8. Standards and Practices for Coding</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9. Tooling and Infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#good-commit-messages">9.1. Good Commit Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#good-pull-requests">9.2. Good Pull Requests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#one-idea-one-pr">9.2.1. One Idea = One PR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#don-t-open-until-it-is-ready">9.2.2. Don’t open until it is ready</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-it">9.2.3. Test It</a></li>
<li class="toctree-l4"><a class="reference internal" href="#document-it">9.2.4. Document It</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#packaging-and-dependency-management">9.3. Packaging and dependency management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup-py">9.3.1. setup.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements-txt">9.3.2. requirements.txt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#third-party-licensing">9.3.3. Third-Party Licensing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#releasing-a-new-version-of-armi">9.4. Releasing a New Version of ARMI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-level-logging">9.5. Module-Level Logging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements/index.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.apidocs/modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Developer Docs</a> &raquo;</li>
        
      <li><span class="section-number">9. </span>Tooling and Infrastructure</li>
    
    
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tooling-and-infrastructure">
<h1><span class="section-number">9. </span>Tooling and Infrastructure<a class="headerlink" href="#tooling-and-infrastructure" title="Permalink to this headline">¶</a></h1>
<div class="section" id="good-commit-messages">
<h2><span class="section-number">9.1. </span>Good Commit Messages<a class="headerlink" href="#good-commit-messages" title="Permalink to this headline">¶</a></h2>
<p>The ARMI project follows a few basic rules for “good” commit messages:</p>
<ul class="simple">
<li><p>The purpose of the message is to explain to the changes you made to a stranger 5 years from now.</p></li>
<li><p>Keep your writing short and to the point.</p></li>
<li><p>The first line of each commit must be shorter than 50 characters.</p></li>
<li><p>Commit messages should be active voice, present tense.</p></li>
<li><p>Multi-line comments are allowed, but make sure the second line of the commit is blank:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adding</span> <span class="n">this</span> <span class="n">commit</span> <span class="k">for</span> <span class="n">REASONS</span><span class="o">.</span>

<span class="n">Here</span> <span class="ow">is</span> <span class="n">some</span> <span class="nb">super</span> <span class="n">important</span> <span class="n">extra</span> <span class="n">info</span><span class="o">.</span>
<span class="n">Oh</span><span class="p">,</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">so</span> <span class="n">much</span> <span class="n">extra</span> <span class="n">info</span><span class="o">.</span>
<span class="n">This</span> <span class="n">section</span>
<span class="o">*</span> <span class="ow">is</span>
<span class="o">*</span> <span class="n">totally</span>
<span class="o">*</span> <span class="n">optional</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="good-pull-requests">
<h2><span class="section-number">9.2. </span>Good Pull Requests<a class="headerlink" href="#good-pull-requests" title="Permalink to this headline">¶</a></h2>
<p>A good commit is like a sentence; it expresses one complete thought. In that context, a good
Pull Request (PR) is like a paragraph; it contains a few sentences that contain one larger
thought. A good PR is <em>not</em> a chapter or an entire book! It should not contain multiple
independent ideas.</p>
<div class="section" id="one-idea-one-pr">
<h3><span class="section-number">9.2.1. </span>One Idea = One PR<a class="headerlink" href="#one-idea-one-pr" title="Permalink to this headline">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you <em>can</em> break a PR into smaller PRs, containing unrelated changes, please do.</p>
</div>
<p>It is a discourtesy to your reviewers to make them review a PR with multiple, unrelated changes.
It forces them to look at every line of diff in your PR and figure out which change it belongs to.
They are busy people, and it will save them time and effort if your PR only has one main idea.
If your PRs are smaller, you will notice a great increase in the quality of the reviews you get.</p>
</div>
<div class="section" id="don-t-open-until-it-is-ready">
<h3><span class="section-number">9.2.2. </span>Don’t open until it is ready<a class="headerlink" href="#don-t-open-until-it-is-ready" title="Permalink to this headline">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Wait until your PR is complete to open it.</p>
</div>
<p>Your PR isn’t complete when the code works, it is complete when the code is polished and all the
tests are written and working. The idea here is: as soon as you open a PR, people will start
spending their time looking at it. And their time is valuable. An exception to this rule is that
GitHub allows you to <a class="reference external" href="https://github.blog/2019-02-14-introducing-draft-pull-requests/">open a Draft PR</a>
which is a nice option if you need to open your PR early for some reason (usually testing). You
can also convert any open PR to Draft if you decide it needs more work.</p>
</div>
<div class="section" id="test-it">
<h3><span class="section-number">9.2.3. </span>Test It<a class="headerlink" href="#test-it" title="Permalink to this headline">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If a PR doesn’t have any changes to testing, it probably isn’t complete.</p>
</div>
<p>Unless a PR is just documentation or linting, it almost certainly needs testing to be complete.
For example:</p>
<ul class="simple">
<li><p>If a PR adds new code, that code needs new tests to prove it is working.</p></li>
<li><p>If a PR changes existing code, there needs to be test changes to prove the code still works.</p></li>
<li><p>If a PR fixes a bug, there needs to be a test to prove the bug is fixed.</p></li>
</ul>
<p>If the changes in the PR are worth the time to make, they are worth the time to test. Help your
reviewer by proving your code works.</p>
</div>
<div class="section" id="document-it">
<h3><span class="section-number">9.2.4. </span>Document It<a class="headerlink" href="#document-it" title="Permalink to this headline">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If it isn’t documented, it doesn’t exist.</p>
</div>
<p>We auto-document the API, so don’t worry about that. But when it comes to documentation, write
it for somebody who is new to the code base 3 years from now, who needs to understand it in
nitty-gritty detail to fix a bug without you. Think about variable names, comments, and docstrings.
Also consider (if you are making a major change) that you might be making something in the docs
out-of-date.</p>
</div>
</div>
<div class="section" id="packaging-and-dependency-management">
<h2><span class="section-number">9.3. </span>Packaging and dependency management<a class="headerlink" href="#packaging-and-dependency-management" title="Permalink to this headline">¶</a></h2>
<p>The process of packaging Python projects and managing their dependencies is somewhat
challenging and nuanced. The contents of our <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> follow existing conventions as
much as possible. In particular, we follow <a class="reference external" href="https://caremad.io/posts/2013/07/setup-vs-requirement/">this fantastic article</a> about dependecy management in
Python projects.</p>
<div class="section" id="setup-py">
<h3><span class="section-number">9.3.1. </span>setup.py<a class="headerlink" href="#setup-py" title="Permalink to this headline">¶</a></h3>
<p>The packages listed in the <code class="docutils literal notranslate"><span class="pre">install_requires</span></code> argument to <code class="docutils literal notranslate"><span class="pre">setup()</span></code> are meant to
express, as abstractly as possible, the packages that need to be installed <strong>somehow</strong>
for the package to work. In addition, <code class="docutils literal notranslate"><span class="pre">extras_require</span></code> are used to specify other
packages that are not strictly required, but if installed enable extra functionality,
like unit testing or building documentation.</p>
</div>
<div class="section" id="requirements-txt">
<h3><span class="section-number">9.3.2. </span>requirements.txt<a class="headerlink" href="#requirements-txt" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">requirements***.txt</span></code> files exist to describe a complete environment more
specifically. If specific versions of packages are required, they should be defined here.
Any extra arguments to <code class="docutils literal notranslate"><span class="pre">pip</span></code> will also be placed here. For instance, there is a <code class="docutils literal notranslate"><span class="pre">-e</span></code>
that tells <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install ARMI itself and defer to <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> for a version-agnostic
list of dependencies. We also have multiple requirements files for different needs, like
testing.</p>
</div>
<div class="section" id="third-party-licensing">
<h3><span class="section-number">9.3.3. </span>Third-Party Licensing<a class="headerlink" href="#third-party-licensing" title="Permalink to this headline">¶</a></h3>
<p>Be careful when including any dependency in ARMI (say in a requirements.txt file) not
to include anything with a license that superceeds our Apache license. For instance,
any third-party Python library included in ARMI with a GPL license will make the whole
project fall under the GPL license. But a lot of potential users of ARMI will want to
keep some of their work private, so we can’t allow any GPL tools.</p>
<p>For that reason, it is generally considered best-practice in the ARMI ecosystem to
only use third-party Python libraries that have MIT or BSD licenses.</p>
</div>
</div>
<div class="section" id="releasing-a-new-version-of-armi">
<h2><span class="section-number">9.4. </span>Releasing a New Version of ARMI<a class="headerlink" href="#releasing-a-new-version-of-armi" title="Permalink to this headline">¶</a></h2>
<p>In ARMI, we use the common <code class="docutils literal notranslate"><span class="pre">major.minor.bump</span></code> version scheme where a version string
might look like <code class="docutils literal notranslate"><span class="pre">0.1.7</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0.0</span></code>, or <code class="docutils literal notranslate"><span class="pre">1.2.123</span></code>. Each number has a specific meaning:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">major</span></code> - Revved for NRC-sanctioned release or at the end of a long development cycle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minor</span></code> - Revved when we decide the code or our API has reached a stable point;
this might happen once a year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bump</span></code> - Revved every time we modify the API, or at will; any time we want.</p></li>
</ul>
<p>NOTE: Changes to documenation or testing probably do not deserve a version bump.</p>
<p><strong>Any change to a major or minor version is considered a release.</strong></p>
<p>Only a core member of the ARMI team may release a new version, or add a tag of any kind to
the repository. The rule is <em>the only tags in the ARMI repo are for official versions</em>. If
you want to release a version of ARMI, you will need admin privileges to multiple TerraPower
repos on GitHub.</p>
<p>Every release should follow this process:</p>
<ol class="arabic simple">
<li><p>Ensure all unit tests pass and the documentation is building correctly.</p></li>
<li><p>Bump the <code class="docutils literal notranslate"><span class="pre">__version__</span></code> string in <code class="docutils literal notranslate"><span class="pre">armi/meta.py</span></code>.</p></li>
<li><p>Add release notes to the documentation:
<a class="reference external" href="https://github.com/terrapower/armi/tree/main/doc/release">here</a>.</p></li>
<li><p>Tag the commit after it goes into the repo:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>From this commit: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">-a</span> <span class="pre">1.0.0</span> <span class="pre">-m</span> <span class="pre">&quot;Release</span> <span class="pre">v1.0.0&quot;</span></code></p></li>
<li><p>Or from another commit: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">&lt;commit-hash&gt;</span> <span class="pre">1.0.0</span> <span class="pre">-m</span> <span class="pre">&quot;Release</span> <span class="pre">v1.0.0&quot;</span></code></p></li>
<li><p>Pushing to the repo: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">1.0.0</span></code></p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Also add the release notes on <a class="reference external" href="https://github.com/terrapower/armi/releases">the GitHub UI</a>.</p></li>
<li><p>Follow the instructions <a class="reference external" href="https://github.com/terrapower/terrapower.github.io">here</a> to
archive the new documentation.</p></li>
<li><p>Tell everyone!</p></li>
</ol>
</div>
<div class="section" id="module-level-logging">
<h2><span class="section-number">9.5. </span>Module-Level Logging<a class="headerlink" href="#module-level-logging" title="Permalink to this headline">¶</a></h2>
<p>In most of the modules in <code class="docutils literal notranslate"><span class="pre">armi</span></code>, you will see logging using the <code class="docutils literal notranslate"><span class="pre">runLog</span></code> module.
This is a custom, global logging object provided by the import:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">armi</span> <span class="kn">import</span> <span class="n">runLog</span>
</pre></div>
</div>
<p>If you want a logger specific to a single module, say to provide debug logging for only
one module, that functionality is provided by what might look like a bare Python logging
import, but is actually calling the same underlying <code class="docutils literal notranslate"><span class="pre">armi</span></code> logging tooling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">runLog</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>In either case, you can then log using the same, easy interface:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">runLog</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;information here&#39;</span><span class="p">)</span>
<span class="n">runLog</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;extra error info here&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, you can change the logging level in either above scenario by doing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">runLog</span><span class="o">.</span><span class="n">setVerbosity</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">runLog</span><span class="o">.</span><span class="n">setVerbosity</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../release/index.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="standards_and_practices.html" class="btn btn-neutral float-left" title="8. Standards and Practices for Coding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2022, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2022-09-19.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>