

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="1. Framework Architecture" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://terrapower.github.io/armi/developer/guide.html" />
<meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
<meta property="og:description" content="What follows is a discussion of the high-level elements of the ARMI framework. Throughout, links to the API docs will be provided for additional details. The Reactor Data Model: The ARMI framework ..." />
<meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
<meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
<meta name="description" content="What follows is a discussion of the high-level elements of the ARMI framework. Throughout, links to the API docs will be provided for additional details. The Reactor Data Model: The ARMI framework ..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Framework Architecture &mdash; ARMI 0.5.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme_fixes.css?v=2b77b304" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=e5fbc548" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_style.css?v=678fb11e" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-test-results/common.css?v=9ec2c1d5" />

  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b9afe91b"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
      <script src="../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
      <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Making ARMI-based Apps" href="making_armi_based_apps.html" />
    <link rel="prev" title="Developer Docs" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../index.html" class="icon icon-home">
            ARMI
              <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. Framework Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-reactor-data-model">1.1. The Reactor Data Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#finding-objects-in-a-model">1.1.1. Finding objects in a model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">1.1.2. Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converters">1.1.3. Converters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#blueprints">1.1.4. Blueprints</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#operators">1.2. Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-standard-operator">1.2.1. The Standard Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-snapshots-operator">1.2.2. The Snapshots Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-interface-stack">1.2.3. The Interface Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interface-interaction-hooks">1.2.4. Interface Interaction Hooks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-a-new-interface">1.2.5. Adding a new interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-interfaces-get-called">1.2.6. How interfaces get called</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plugins">1.3. Plugins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#entry-points">1.3.1. Entry Points</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="making_armi_based_apps.html">2. Making ARMI-based Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="entrypoints.html">3. Entry Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="documenting.html">4. Documenting ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel_coding.html">5. Parallel Code in ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">6. Profiling ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="first_time_contributors.html">7. First Time Contributors Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="standards_and_practices.html">8. Standards and Practices for Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="tooling.html">9. Tooling and Infrastructure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qa_docs/index.html">QA Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Developer Docs</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1. </span>Framework Architecture</li>
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="framework-architecture">
<h1><span class="section-number">1. </span>Framework Architecture<a class="headerlink" href="#framework-architecture" title="Link to this heading"></a></h1>
<p>What follows is a discussion of the high-level elements of the ARMI framework. Throughout, links to
the API docs will be provided for additional details.</p>
<section id="the-reactor-data-model">
<h2><span class="section-number">1.1. </span>The Reactor Data Model<a class="headerlink" href="#the-reactor-data-model" title="Link to this heading"></a></h2>
<p>The ARMI framework represents a nuclear reactor via a reactor data model, which is defined in the
<a class="reference internal" href="../.apidocs/armi.reactor.html#module-armi.reactor" title="armi.reactor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">reactor</span></code></a> package. Each physical piece of the nuclear reactor is defined by a Python
object, called an <a class="reference internal" href="../.apidocs/armi.reactor.composites.html#armi.reactor.composites.ArmiObject" title="armi.reactor.composites.ArmiObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArmiObject</span></code></a>. Each <code class="docutils literal notranslate"><span class="pre">ArmiObject</span></code>
has associated data like: shape, material, or other physical values. The physical values can be
nearly anything, and are attached to the data model via ARMI’s
<a class="reference internal" href="../.apidocs/armi.reactor.parameters.html#module-armi.reactor.parameters" title="armi.reactor.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Parameter</span></code></a> system. Example parameters might be: <code class="docutils literal notranslate"><span class="pre">keff</span></code>,
<code class="docutils literal notranslate"><span class="pre">flow</span> <span class="pre">rates</span></code>, <code class="docutils literal notranslate"><span class="pre">power</span></code>, <code class="docutils literal notranslate"><span class="pre">flux</span></code>, etc.</p>
<p>The reactor data model is a hierarchical model, following the <a class="reference external" href="http://en.wikipedia.org/wiki/Composite_pattern">Composite Design Pattern</a>. The top of the data model is the
<a class="reference internal" href="../.apidocs/armi.reactor.reactors.html#armi.reactor.reactors.Reactor" title="armi.reactor.reactors.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Reactor</span></code></a>, which contains one
<a class="reference internal" href="../.apidocs/armi.reactor.cores.html#armi.reactor.cores.Core" title="armi.reactor.cores.Core"><code class="xref py py-class docutils literal notranslate"><span class="pre">Core</span></code></a> object and a collection of zero or more
<a class="reference internal" href="../.apidocs/armi.reactor.excoreStructure.html#armi.reactor.excoreStructure.ExcoreStructure" title="armi.reactor.excoreStructure.ExcoreStructure"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExcoreStructures</span></code></a>. An example
<code class="docutils literal notranslate"><span class="pre">ExcoreStructure</span></code> might be a <a class="reference internal" href="../.apidocs/armi.reactor.spentFuelPool.html#armi.reactor.spentFuelPool.SpentFuelPool" title="armi.reactor.spentFuelPool.SpentFuelPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpentFuelPool</span></code></a>.</p>
<p>For now, the <code class="docutils literal notranslate"><span class="pre">Core</span></code> object in ARMI assumes it contains <strong>Assembly</strong> objects, which are in turn
made up as a collection of <strong>Block</strong> objects. The leaves of the the Composite Model in the ARMI
framework are called <a class="reference internal" href="../.apidocs/armi.reactor.components.component.html#armi.reactor.components.component.Component" title="armi.reactor.components.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>.</p>
<figure class="align-center" id="id1">
<img alt="../_images/armi_reactor_objects.png" src="../_images/armi_reactor_objects.png" />
<figcaption>
<p><span class="caption-text">The primary data containers in ARMI</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Time-evolving the parameters on the reactor composite hierarchy is what most modelers and analysts
will want from the ARMI framework.</p>
<p>Review the data model <a class="reference internal" href="../tutorials/index.html#armi-tutorials"><span class="std std-ref">Tutorials</span></a> section for examples exploring a populated instance of
the <code class="docutils literal notranslate"><span class="pre">Reactor</span></code> data model.</p>
<section id="finding-objects-in-a-model">
<h3><span class="section-number">1.1.1. </span>Finding objects in a model<a class="headerlink" href="#finding-objects-in-a-model" title="Link to this heading"></a></h3>
<p>Under most circumstances a <a class="reference internal" href="../.apidocs/armi.reactor.reactors.html#armi.reactor.reactors.Reactor" title="armi.reactor.reactors.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.reactors.Reactor</span></code></a> instance will have a
<code class="docutils literal notranslate"><span class="pre">.core</span></code> attribute, which is an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.reactors.Core</span></code>. While the
Composite pattern discussed above can be used very generally, the <code class="docutils literal notranslate"><span class="pre">Core</span></code> class
enforces a couple of constraints that can be very useful:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">Core</span></code> is a 2-D arrangement of <a class="reference internal" href="../.apidocs/armi.reactor.assemblies.html#armi.reactor.assemblies.Assembly" title="armi.reactor.assemblies.Assembly"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.assemblies.Assembly</span></code></a>
objects.</p></li>
<li><p>Each <code class="docutils literal notranslate"><span class="pre">Assembly</span></code> is a 1-D arrangement of <a class="reference internal" href="../.apidocs/armi.reactor.blocks.html#armi.reactor.blocks.Block" title="armi.reactor.blocks.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.blocks.Block</span></code></a>
objects.</p></li>
<li><p>Blocks are <a class="reference internal" href="../.apidocs/armi.reactor.composites.html#armi.reactor.composites.Composite" title="armi.reactor.composites.Composite"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.composites.Composite</span></code></a> objects with some extra
parameter bindings, utility functions, and other implementation details that let
them play nicely with their containing <code class="docutils literal notranslate"><span class="pre">Assembly</span></code>.</p></li>
</ul>
<p>In many scenarios, one wants to access specific assemblies or blocks from a core. There
are a few ways to get the objects that you’re interested in:</p>
<ul>
<li><p>The <cite>r.core.childrenByLocator</cite> dictionary maps
<code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.grids.IndexLocation</span></code> objects to whichever assembly is at
that location. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">spatialGrid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">childrenByLocator</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span>
</pre></div>
</div>
<p>To access the <code class="docutils literal notranslate"><span class="pre">k</span></code> -th block in an assembly, try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p><cite>r.core.getAssemblies()</cite> loops through all assemblies in the core for when you
need to do something to all assemblies.</p></li>
</ul>
</section>
<section id="parameters">
<h3><span class="section-number">1.1.2. </span>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<p>One of the main benefits to ARMI is that it enables simple interfaces to extract data
from the reactor, do something with it, and add new results to the reactor. This enables
specialized developers to write code that uses ARMI as input and output.</p>
<p>Most data is stored in ARMI as <a class="reference internal" href="../.apidocs/armi.reactor.parameters.html#module-armi.reactor.parameters" title="armi.reactor.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parameters</span></code></a>. Most parameters will
become persistent, meaning they will be saved to the database during database
interactions, and therefore it will also be loaded when a database is loaded.</p>
<p>Details of the use and design can be found at <a class="reference internal" href="../.apidocs/armi.reactor.parameters.html#module-armi.reactor.parameters" title="armi.reactor.parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parameters</span></code></a>.</p>
</section>
<section id="converters">
<h3><span class="section-number">1.1.3. </span>Converters<a class="headerlink" href="#converters" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../.apidocs/armi.reactor.converters.html#module-armi.reactor.converters" title="armi.reactor.converters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">converters</span></code></a> subpackage contains a variety of utilities that
can convert a reactor model in various ways. Some converters change designs at the block
level, adjusting pin dimensions or fuel composition. Others adjust the reactor geometry
at large, changing a 1/3-symmetric model to a full core, or changing a hexagonal
geometry to a R-Z geometry. Converters are used for parameter sweeps as well as during
various physics operations.</p>
<p>For example, some lattice physics routines convert the full core to a 2D R-Z model and
compute flux with thousands of energy groups to properly capture the spectral-spatial
coupling in a core/reflector interface. The converters are used heavily in these operations.</p>
</section>
<section id="blueprints">
<h3><span class="section-number">1.1.4. </span>Blueprints<a class="headerlink" href="#blueprints" title="Link to this heading"></a></h3>
<p>As seen in the User Guide, <a class="reference internal" href="../.apidocs/armi.reactor.blueprints.html#module-armi.reactor.blueprints" title="armi.reactor.blueprints"><code class="xref py py-mod docutils literal notranslate"><span class="pre">blueprints</span></code></a> are how reactor models are
defined. During a run, they can be used to create new instances of reactor model pieces,
such as when a new assembly is fabricated during a fuel management operation in a later
cycle.</p>
</section>
</section>
<section id="operators">
<h2><span class="section-number">1.2. </span>Operators<a class="headerlink" href="#operators" title="Link to this heading"></a></h2>
<p>Operators conduct the execution sequence of an ARMI run. They basically contain the main
loop. When any operator is instantiated, several actions occur:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Some environmental detail is printed out,</p></li>
<li><p>A Reactor object is instantiated</p></li>
<li><p>Loading and geometry input files are processed and the reactor object is
populated with assemblies,</p></li>
<li><p>The <strong>interfaces</strong> are instantiated
and placed in the <strong>Interface Stack</strong> during the <code class="xref py py-meth docutils literal notranslate"><span class="pre">createInterfaces</span>
<span class="pre">method</span></code> call,</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">interactInit</span></code> method is called on all interfaces, and</p></li>
<li><p>Restart information is processed (if this is a restart run).</p></li>
</ol>
</div></blockquote>
<p>After that, depending on the type of Operator at hand, one of several operational loops
will begin via <code class="docutils literal notranslate"><span class="pre">operate()</span></code>. Operator types are chosen by the <code class="docutils literal notranslate"><span class="pre">runType</span></code> setting,
which is featured on the first tab of the ARMI GUI.</p>
<section id="the-standard-operator">
<h3><span class="section-number">1.2.1. </span>The Standard Operator<a class="headerlink" href="#the-standard-operator" title="Link to this heading"></a></h3>
<p>The two primary types of operators are the Standard Operator (along with its parallel
version, the <code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorMPI</span></code>), and the
<code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorSnapshots</span></code>. The former runs a
typical operational loop, which calls all the interfaces through their interaction hooks
in a sequential manner, marching from beginning-of-life through the number of cycles
requested. This is how most quasistatic fuel cycle calculations are performed, which
inform much of the analysis done during reactor design. The main code for this loop is
found in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">mainOperate</span> <span class="pre">method</span></code>. This
operator supports restart/continuation of past runs from an arbitrary time step.</p>
</section>
<section id="the-snapshots-operator">
<h3><span class="section-number">1.2.2. </span>The Snapshots Operator<a class="headerlink" href="#the-snapshots-operator" title="Link to this heading"></a></h3>
<p>Alternatively, OperatorSnapshots is designed to allow for additional analyses at
specific time steps. It simply loops through all snapshots that have been requested via
the Snapshot Request functionality (Lists -&gt; Edit snapshot requests in the GUI). At each
snapshot request, the state is loaded from a previous case, as determined by the
<code class="docutils literal notranslate"><span class="pre">reloadDBName</span></code> setting and then the BOC, EveryNode, and EOC interaction hooks are
executed from all the interfaces. Snapshots are intended to analyze an exact reactor
configuration. Therefore, interfaces which would significantly change the reactor
configuration (such as Fuel management, and depletion) are disabled.</p>
</section>
<section id="the-interface-stack">
<h3><span class="section-number">1.2.3. </span>The Interface Stack<a class="headerlink" href="#the-interface-stack" title="Link to this heading"></a></h3>
<p><em>Interfaces</em> (<a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface" title="armi.interfaces.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.interfaces.Interface</span></code></a>) operate upon the Reactor Model to
do analysis. They’re designed to allow expansion of the code in a natural and
well-organized manner. Interfaces are useful to link external codes to ARMI as well for
adding new internal physics into the rest of the system. As a result, very many aspects
of ARMI are contained within interfaces.</p>
<p>The flow of any ARMI calculation depends on the order of the interfaces, which is set at
initialization according to the user settings and the corresponding <code class="docutils literal notranslate"><span class="pre">ORDER</span></code> attributes
in interface modules. The collection of the interfaces is known as the <strong>Interface
Stack</strong> and is prominently featured at the beginning of the standard output of each run,
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="o">----------------------------------------------------------</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span>          <span class="o">***</span>  <span class="n">Interface</span> <span class="n">Stack</span> <span class="n">Report</span>  <span class="o">***</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="n">NUM</span> <span class="n">TYPE</span>               <span class="n">NAME</span>         <span class="n">ENABLED</span> <span class="n">BOL</span>  <span class="n">EOL</span> <span class="n">ORDER</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="o">----------------------------------------------------------</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">00</span>  <span class="n">Main</span>               <span class="n">main</span>         <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Reversed</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">01</span>  <span class="n">Software</span> <span class="n">Testing</span>   <span class="n">tests</span>        <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Reversed</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">02</span>  <span class="n">ReportInterface</span>    <span class="n">report</span>       <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Reversed</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">03</span>  <span class="n">FuelHandler</span>        <span class="n">fuelHandler</span>  <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">04</span>  <span class="n">Depletion</span>          <span class="n">depletion</span>    <span class="n">Yes</span>     <span class="n">Yes</span>  <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">05</span>  <span class="n">MC2</span><span class="o">-</span><span class="mi">2</span>              <span class="n">mc2</span>          <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">06</span>  <span class="n">DIF3D</span>              <span class="n">dif3d</span>        <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">07</span>  <span class="n">Thermo</span>             <span class="n">thermo</span>       <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">08</span>  <span class="n">OrificedOptimized</span>  <span class="n">orificer</span>     <span class="n">Yes</span>     <span class="n">Yes</span>  <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">09</span>  <span class="n">AlchemyLite</span>        <span class="n">alchemyLite</span>  <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">10</span>  <span class="n">Alchemy</span>            <span class="n">alchemy</span>      <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">11</span>  <span class="n">Economics</span>          <span class="n">economics</span>    <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">12</span>  <span class="n">History</span>            <span class="n">history</span>      <span class="n">Yes</span>     <span class="n">No</span>   <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="mi">13</span>  <span class="n">Database</span>           <span class="n">database</span>     <span class="n">Yes</span>     <span class="n">Yes</span>  <span class="n">Normal</span>
<span class="p">[</span><span class="n">R</span> <span class="mi">0</span><span class="p">]</span> <span class="o">----------------------------------------------------------</span>
</pre></div>
</div>
<p>Any interface that exists on the interface stack is accessible from the <code class="docutils literal notranslate"><span class="pre">operator</span></code> or
from any other interface object through the <code class="xref py py-meth docutils literal notranslate"><span class="pre">getInterface</span> <span class="pre">method</span></code>.</p>
</section>
<section id="interface-interaction-hooks">
<h3><span class="section-number">1.2.4. </span>Interface Interaction Hooks<a class="headerlink" href="#interface-interaction-hooks" title="Link to this heading"></a></h3>
<p>Various interfaces need to interact with ARMI at various times. The point at which
routines are called during a run set by developers in interface <em>hooks</em>, as seen below.
At each point in the flow chart, interfaces are interacted with one-by-one as the
interface stack is traversed in order.</p>
<figure class="align-center" id="id2">
<img alt="../_images/armi_general_flowchart.png" src="../_images/armi_general_flowchart.png" />
<figcaption>
<p><span class="caption-text">The computational flow of the interface hooks</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>For example, input checking routines would run at beginning-of-life (BOL), calculation
modules might run at every time node, etc. To accommodate these various needs, interface
hooks include:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactInit" title="armi.interfaces.Interface.interactInit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactInit</span></code></a> occurs right after
all interfaces are initialized.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactBOL" title="armi.interfaces.Interface.interactBOL"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactBOL</span></code></a> – Beginning of life.
Happens once as the run is starting up.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactBOC" title="armi.interfaces.Interface.interactBOC"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactBOC</span></code></a> – Beginning of cycle.
Happens once per cycle.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactEveryNode" title="armi.interfaces.Interface.interactEveryNode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactEveryNode</span></code></a> – Happens
after every node step/flux calculation.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactEOC" title="armi.interfaces.Interface.interactEOC"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactEOC</span></code></a> – End of cycle.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactEOL" title="armi.interfaces.Interface.interactEOL"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactEOL</span></code></a> – End of life.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactError" title="armi.interfaces.Interface.interactError"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactError</span></code></a> – When an error
occurs, this can run to clean up or print debugging info.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.interfaces.html#armi.interfaces.Interface.interactCoupled" title="armi.interfaces.Interface.interactCoupled"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interactCoupled</span></code></a> – Happens
after every node step/flux calculation, if tight physics coupling is active.</p></li>
</ul>
<p>These interaction points are optional in every interface, and you may override one or
more of them to suit your needs. You should not change the arguments to the hooks,
which are integers.</p>
<p>Each interface has a <code class="docutils literal notranslate"><span class="pre">enabled</span></code> flag. If this is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, then the interface’s
hook code will not be called even though the interface exists in the problem. This is
useful for interfaces that use code from other interfaces. For example, if <code class="docutils literal notranslate"><span class="pre">subchan</span></code>
is activated, it still uses some code in the <code class="docutils literal notranslate"><span class="pre">thermo</span></code> module to compute the fuel
temperatures, so the <code class="docutils literal notranslate"><span class="pre">thermo</span></code> interface must be available in a <code class="docutils literal notranslate"><span class="pre">getInterface</span></code> call.</p>
</section>
<section id="adding-a-new-interface">
<h3><span class="section-number">1.2.5. </span>Adding a new interface<a class="headerlink" href="#adding-a-new-interface" title="Link to this heading"></a></h3>
<p>When using the Operators that come with ARMI, Interfaces are discovered using the
<a class="reference internal" href="../.apidocs/armi.plugins.html#module-armi.plugins" title="armi.plugins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">API</span></code></a> and inserted into the interface stack during the
<a class="reference internal" href="../.apidocs/armi.operators.operator.html#armi.operators.operator.Operator.createInterfaces" title="armi.operators.operator.Operator.createInterfaces"><code class="xref py py-meth docutils literal notranslate"><span class="pre">createInterfaces</span></code></a> method.</p>
</section>
<section id="how-interfaces-get-called">
<h3><span class="section-number">1.2.6. </span>How interfaces get called<a class="headerlink" href="#how-interfaces-get-called" title="Link to this heading"></a></h3>
<p>The hooks of interfaces are called during the main loop in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.operators.Operator.mainOperate()</span></code>. There are a few special operator calls
in there to methods like <code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.operators.Operator.interactAllBOL()</span></code> that loop
through the interface stack and call each enabled interface’s <code class="docutils literal notranslate"><span class="pre">interactBOL()</span></code> method.
If you override <code class="docutils literal notranslate"><span class="pre">mainOperate</span></code> in a custom operator, you will need to add these calls
as deemed necessary to have the interfaces work properly.</p>
<p>To use interfaces in parallel, please refer to <a class="reference internal" href="../.apidocs/armi.mpiActions.html#module-armi.mpiActions" title="armi.mpiActions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">armi.mpiActions</span></code></a>.</p>
</section>
</section>
<section id="plugins">
<h2><span class="section-number">1.3. </span>Plugins<a class="headerlink" href="#plugins" title="Link to this heading"></a></h2>
<p>Plugins are higher-level objects that can add things to the simulations like Interfaces, settings
definitions, parameters, validations, etc. They are documented in <a class="reference internal" href="making_armi_based_apps.html#armi-app-making"><span class="std std-ref">Making ARMI-based Apps</span></a> and
<a class="reference internal" href="../.apidocs/armi.plugins.html#module-armi.plugins" title="armi.plugins"><code class="xref py py-mod docutils literal notranslate"><span class="pre">armi.plugins</span></code></a>.</p>
<section id="entry-points">
<h3><span class="section-number">1.3.1. </span>Entry Points<a class="headerlink" href="#entry-points" title="Link to this heading"></a></h3>
<p>ARMI has a set of <a class="reference internal" href="../.apidocs/armi.cli.entryPoint.html#armi.cli.entryPoint.EntryPoint" title="armi.cli.entryPoint.EntryPoint"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Entry</span> <span class="pre">Points</span></code></a> that can run
cases, launch the GUI, and perform various testing and utility operations. When you
invoke ARMI with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">armi</span> <span class="pre">run</span></code>, the <code class="docutils literal notranslate"><span class="pre">__main__.py</span></code> file is loaded and all
valid Entry Points are dynamically loaded. The proper entry point (in this case,
<a class="reference internal" href="../.apidocs/armi.cli.run.html#armi.cli.run.RunEntryPoint" title="armi.cli.run.RunEntryPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.cli.run.RunEntryPoint</span></code></a>) is invoked. As ARMI initializes itself, settings
are loaded into a <a class="reference internal" href="../.apidocs/armi.settings.caseSettings.html#armi.settings.caseSettings.Settings" title="armi.settings.caseSettings.Settings"><code class="xref py py-class docutils literal notranslate"><span class="pre">Settings</span></code></a>
object. From those settings, an <a class="reference internal" href="../.apidocs/armi.operators.operator.html#armi.operators.operator.Operator" title="armi.operators.operator.Operator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operator</span></code></a>
subclass is built by a factory and its <code class="docutils literal notranslate"><span class="pre">operate</span></code> method is called. This fires up the
main ARMI analysis loop and its interface stack is looped over as indicated by user input.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Developer Docs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="making_armi_based_apps.html" class="btn btn-neutral float-right" title="2. Making ARMI-based Apps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2025, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2025-03-24.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>