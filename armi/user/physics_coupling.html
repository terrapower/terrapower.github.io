<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="10. Physics Coupling" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://terrapower.github.io/armi/user/physics_coupling.html" />
<meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
<meta property="og:description" content="Loose Coupling: ARMI supports loose and tight coupling. Loose coupling is interpreted as one-way coupling between physics for a single time node. For example, a power distribution in cycle 0 node 0..." />
<meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
<meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
<meta name="description" content="Loose Coupling: ARMI supports loose and tight coupling. Loose coupling is interpreted as one-way coupling between physics for a single time node. For example, a power distribution in cycle 0 node 0..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. Physics Coupling &mdash; ARMI 0.4.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme_fixes.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Radial and Axial Expansion and Contraction" href="radial_and_axial_expansion.html" />
    <link rel="prev" title="9. Block Parameters" href="block_parameters_report.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../index.html" class="icon icon-home">
            ARMI
              <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.4.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="user_install.html">1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputs.html">2. Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html">3. Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual_data_access.html">4. Accessing Data in ARMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="reactor_parameters_report.html">5. Reactor Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_parameters_report.html">6. Core Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="component_parameters_report.html">7. Component Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="assembly_parameters_report.html">8. Assembly Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="block_parameters_report.html">9. Block Parameters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">10. Physics Coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loose-coupling">10.1. Loose Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tight-coupling">10.2. Tight Coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#eigenvalue">10.2.1. Eigenvalue</a></li>
<li class="toctree-l4"><a class="reference internal" href="#block-wise-power">10.2.2. Block-wise Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-global-flux-interface">10.2.3. The Global Flux Interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="radial_and_axial_expansion.html">11. Radial and Axial Expansion and Contraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="accessingEntryPoints.html">12. Accessing Entry Points</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">User Docs</a></li>
      <li class="breadcrumb-item active"><span class="section-number">10. </span>Physics Coupling</li>
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="physics-coupling">
<h1><span class="section-number">10. </span>Physics Coupling<a class="headerlink" href="#physics-coupling" title="Permalink to this heading"></a></h1>
<section id="loose-coupling">
<h2><span class="section-number">10.1. </span>Loose Coupling<a class="headerlink" href="#loose-coupling" title="Permalink to this heading"></a></h2>
<p>ARMI supports loose and tight coupling. Loose coupling is interpreted as one-way coupling between physics for a single time node. For example, a power distribution in cycle 0 node 0 is used to calculate a temperature distribution in cycle 0 node 0. This temperature is then used in cycle 0 node 1 to compute new cross sections and a new power distribution. This process repeats itself for the lifetime of the simulation.</p>
<div class="graphviz"><img src="../_images/graphviz-388ad503314f62fbd951843b5e60798c723fc243.png" alt="digraph looseCoupling {
        label=&quot;Loose Coupling&quot;
        layout=&quot;dot&quot;;
        rankdir=TB;
        a [label=&quot;Temp.&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        a1 [label=&quot;Temp.&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        a2 [label=&quot;Temp.&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b [label=&quot;Power&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b1 [label=&quot;Power&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b2 [label=&quot;Power&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c [label=&quot;Cross Sections&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c1 [label=&quot;Cross Sections&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c2 [label=&quot;Cross Sections&quot;, shape=&quot;Rec&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        d [label=&quot;...&quot;, shape=&quot;plaintext&quot;]

        subgraph cluster_c00n00{
            label=&quot;Cycle 0, Node 0&quot;;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c -&gt; b
            b -&gt; a [constraint=false]
        }
        a -&gt; c1 //[constraint=false]
        subgraph cluster_c00n01{
            label=&quot;Cycle 0, Node 1&quot;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c1 -&gt; b1
            b1 -&gt; a1 [constraint=false]
        }
        a1 -&gt; c2 //[constraint=false]
        subgraph cluster_c00n02{
            label=&quot;Cycle 0, Node 2&quot;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c2 -&gt; b2
            b2 -&gt; a2 [constraint=false]
        }
        a2 -&gt; d //[constraint=false]
}" class="graphviz" /></div>
<p>Loose coupling is enabled by default in ARMI simulations.</p>
</section>
<section id="tight-coupling">
<h2><span class="section-number">10.2. </span>Tight Coupling<a class="headerlink" href="#tight-coupling" title="Permalink to this heading"></a></h2>
<p>Tight coupling is interpreted as two-way communication between physics within a given time node. Revisiting our previous example, enabling tight coupling results in the temperature distribution being used to generate updated cross sections (new temperatures induce changes such as Doppler broadening feedback) and ultimately an updated power distribution. This process is repeated iteratively until a numerical convergence criteria is met.</p>
<div class="graphviz"><img src="../_images/graphviz-e63088676299312b57c59ce3186f1db43c5b29a3.png" alt="digraph tightCoupling {
        label=&quot;Tight Coupling&quot;
        layout=&quot;dot&quot;;
        rankdir=TB;
        e [label=&quot;Converged?&quot;, shape=&quot;diamond&quot;, style=&quot;filled&quot;, color=&quot;white&quot;]
        e1 [label=&quot;Converged?&quot;, shape=&quot;diamond&quot;, style=&quot;filled&quot;, color=&quot;white&quot;]
        e2 [label=&quot;Converged?&quot;, shape=&quot;diamond&quot;, style=&quot;filled&quot;, color=&quot;white&quot;]
        a [label=&quot;Temp.&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        a1 [label=&quot;Temp.&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        a2 [label=&quot;Temp.&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b [label=&quot;Power&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b1 [label=&quot;Power&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        b2 [label=&quot;Power&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c [label=&quot;Cross Sections&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c1 [label=&quot;Cross Sections&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        c2 [label=&quot;Cross Sections&quot;, shape=&quot;Rectangle&quot;, style=&quot;rounded,filled&quot;, color=&quot;white&quot;]
        d [label=&quot;...&quot;, shape=&quot;plaintext&quot;]

        subgraph cluster_c00n00{
            label=&quot;Cycle 0, Node 0&quot;;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c -&gt; b 
            b -&gt; a 
            a -&gt; e [constraint=false]
            e -&gt; c [constraint=false, label=&quot;no&quot;]
        }
        e -&gt; c1 [label=&quot;yes&quot;]
        subgraph cluster_c00n01{
            label=&quot;Cycle 0, Node 1&quot;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c1 -&gt; b1
            b1 -&gt; a1
            a1 -&gt; e1 [constraint=false]
            e1 -&gt; c1 [constraint=false, label=&quot;no&quot;]
        }
        e1 -&gt; c2 [label=&quot;yes&quot;]
        subgraph cluster_c00n02{
            label=&quot;Cycle 0, Node 2&quot;
            style=&quot;rounded,filled&quot;;
            color=lightblue;
            c2 -&gt; b2
            b2 -&gt; a2
            a2 -&gt; e2 [constraint=false]
            e2 -&gt; c2 [constraint=false, label=&quot;no&quot;]
        }
        e2 -&gt; d [label=&quot;yes&quot;]
}" class="graphviz" /></div>
<p>The following settings are involved with enabling tight coupling in ARMI:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tightCoupling</span></code>: When <code class="docutils literal notranslate"><span class="pre">True</span></code>, tight coupling is enabled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tightCouplingSettings</span></code>: Used to specify which parameters and convergence criteria will be used to measure the convergence of a given interface.</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tightCoupling</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">tightCouplingSettings</span><span class="p">:</span>
<span class="w">  </span><span class="nt">globalFlux</span><span class="p">:</span>
<span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">power</span>
<span class="w">    </span><span class="nt">convergence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-4</span>
<span class="w">  </span><span class="nt">thermalHydraulics</span><span class="p">:</span>
<span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">THaverageCladTemperature</span>
<span class="w">    </span><span class="nt">convergence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e-2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tightCouplingSettings</span></code> settings interact with the interfaces available in ARMI (or an ARMI app). The interface headers (i.e., “globalFlux” and “thermalHydraulics”) must match the value prescribed for <code class="xref py py-attr docutils literal notranslate"><span class="pre">Interface.function</span></code>. The option, <code class="docutils literal notranslate"><span class="pre">parameter</span></code>, can be a registered parameter. The <code class="docutils literal notranslate"><span class="pre">convergence</span></code> option is expected to be any float value. In the current implementation, different interfaces may have different developer intended restrictions. For example, the global flux interface currently only allows the eigenvalue (i.e. <span class="math notranslate nohighlight">\(k_{\text{eff}}\)</span>) or block-wise power to be valid <code class="docutils literal notranslate"><span class="pre">parameter</span></code> values.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The inherent limitations of the above interface-based tight coupling settings have been documented and a new and improved user-interface is currently being developed.</p>
</div>
<p>In the global flux interface, the following norms are used to compute the convergence of <span class="math notranslate nohighlight">\(k_{\text{eff}}\)</span> and block-wise power.</p>
<section id="eigenvalue">
<h3><span class="section-number">10.2.1. </span>Eigenvalue<a class="headerlink" href="#eigenvalue" title="Permalink to this heading"></a></h3>
<p>The convergence of the eigenvalue is measured through an L2-norm.</p>
<div class="math notranslate nohighlight">
\[\epsilon = \| k_\text{eff} \|_2 = \left( \left( k_\text{eff,old} - k_\text{eff,new} \right)^2 \right) ^ \frac{1}{2}\]</div>
</section>
<section id="block-wise-power">
<h3><span class="section-number">10.2.2. </span>Block-wise Power<a class="headerlink" href="#block-wise-power" title="Permalink to this heading"></a></h3>
<p>The block-wise power can be used as a convergence mechanism to avoid the integral effects of <span class="math notranslate nohighlight">\(k_{\text{eff}}\)</span> (i.e., over and under predictions cancelling each other out) and in turn, can have a different convergence rate. To measure the convergence of the power distribution with the prescribed tolerances (e.g., 1e-4), the power is scaled in the following manner (otherwise the calculation struggles to converge).</p>
<p>For an assembly, <span class="math notranslate nohighlight">\(a\)</span>, we compute the total power of the assembly,</p>
<div class="math notranslate nohighlight">
\[a_{\text{power},i} = \sum_{j}b_{\text{power},(i,j)},\]</div>
<p>where <span class="math notranslate nohighlight">\(i\)</span> is the <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span> assembly and <span class="math notranslate nohighlight">\(j\)</span> is the <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span> block within assembly, <span class="math notranslate nohighlight">\(i\)</span>. With the assembly power, we scale the block power and obtain an array of scaled block powers for a given assembly, <span class="math notranslate nohighlight">\(\mathbf{b}_{i}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\mathbf{b}_{i} = \left\lbrace \frac{b_{\text{power},(i,j)}}{a_{\text{power},i}} \right\rbrace, \quad \forall j \in a_i.\]</div>
<p>We can now calculate a convergence parameter for each assembly,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\epsilon_i &amp;= \| \textbf{b}_{i,\text{old}} - \textbf{b}_{i,\text{new}} \|_2 \\
           &amp;=\sqrt{\sum_{i}\left( \textbf{b}_{i,\text{old}} - \textbf{b}_{i,\text{new}} \right)^2}.\end{split}\]</div>
<p>These assembly-wise convergence parameters are then stored in an array of convergence values,</p>
<div class="math notranslate nohighlight">
\[\xi = \left\lbrace \epsilon_i \right\rbrace,\quad \forall i \in \text{Core}.\]</div>
<p>The total convergence of the power distribution is finally measured through the infinity norm (i.e, the max) of <span class="math notranslate nohighlight">\(\xi\)</span>,</p>
<div class="math notranslate nohighlight">
\[\epsilon = \| \xi \|_{\inf} = \max \xi.\]</div>
</section>
<section id="the-global-flux-interface">
<h3><span class="section-number">10.2.3. </span>The Global Flux Interface<a class="headerlink" href="#the-global-flux-interface" title="Permalink to this heading"></a></h3>
<p>The <a class="reference internal" href="../.apidocs/armi.physics.neutronics.globalFlux.globalFluxInterface.html#armi.physics.neutronics.globalFlux.globalFluxInterface.GlobalFluxInterface" title="armi.physics.neutronics.globalFlux.globalFluxInterface.GlobalFluxInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">Global</span> <span class="pre">Flux</span> <span class="pre">Interface</span></code></a>
class will attempt to set its own <code class="docutils literal notranslate"><span class="pre">TightCoupler</span></code> based on <code class="docutils literal notranslate"><span class="pre">keff</span></code>. To see the specifics, see:
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_setTightCouplingDefaults</span></code>.
If you want to change the tight coupling performance of the <code class="docutils literal notranslate"><span class="pre">GlobalFluxInterface</span></code>, it would be
easiest to just sublass the interface and over-write the <cite>_setTightCouplingDefaults</cite> method.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="block_parameters_report.html" class="btn btn-neutral float-left" title="9. Block Parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="radial_and_axial_expansion.html" class="btn btn-neutral float-right" title="11. Radial and Axial Expansion and Contraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2024, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2024-08-28.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>