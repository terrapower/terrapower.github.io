

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta property="og:title" content="armi.bookkeeping.db package" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://terrapower.github.io/armi/.apidocs/armi.bookkeeping.db.html" />
  <meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
  <meta property="og:description" content="The db package is responsible for reading and writing the state of the reactor to/from disk. As an ARMI run progresses, this is periodically updated as the primary output file. It can also be an in..." />
  <meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
  <meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>armi.bookkeeping.db package &mdash; ARMI 0.1.7 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="armi.bookkeeping.db.compareDB3 module" href="armi.bookkeeping.db.compareDB3.html" />
    <link rel="prev" title="armi.bookkeeping package" href="armi.bookkeeping.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >
          

          
            <a href="../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blog/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="armi.html">armi package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="armi.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="armi.bookkeeping.html">armi.bookkeeping package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.cases.html">armi.cases package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.cli.html">armi.cli package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.materials.html">armi.materials package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.nucDirectory.html">armi.nucDirectory package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.nuclearDataIO.html">armi.nuclearDataIO package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.operators.html">armi.operators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.physics.html">armi.physics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.reactor.html">armi.reactor package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.scripts.html">armi.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.settings.html">armi.settings package</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.utils.html">armi.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="armi.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">armi</a> &raquo;</li>
        
          <li><a href="armi.html">armi package</a> &raquo;</li>
        
          <li><a href="armi.bookkeeping.html">armi.bookkeeping package</a> &raquo;</li>
        
      <li>armi.bookkeeping.db package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/terrapower/armi/blob/master/doc/.apidocs/armi.bookkeeping.db.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-armi.bookkeeping.db">
<span id="armi-bookkeeping-db-package"></span><h1>armi.bookkeeping.db package<a class="headerlink" href="#module-armi.bookkeeping.db" title="Permalink to this headline">¶</a></h1>
<p>The db package is responsible for reading and writing the state of the reactor to/from disk.</p>
<p>As an ARMI run progresses, this is periodically updated as the primary output file.
It can also be an input file for follow-on analysis or restart runs.</p>
<p>The database can be visualized through various tools such as XTVIEW.</p>
<p>This module contains factories for selecting and building DB-related objects.</p>
<div class="section" id="some-notes-on-versions">
<h2>Some notes on versions<a class="headerlink" href="#some-notes-on-versions" title="Permalink to this headline">¶</a></h2>
<p>Persistent storage of ARMI models has seen many changes throughout the years.
Calculation results were originally stored on a SQL database (version 1), which has been
fully deprecated at this point.</p>
<p>Version 2 was the first to use HDF5 as the primary storage format. This was beneficial,
as it did not rely on any external infrastructure to operate, and benefited from the
suite of tools that help interact with HDF5 files. It was eventually replaced because
it did not store a complete model of the reactor, but rather a ghost of assembly, block,
and reactor parameters that could be applied to an existing reactor model (so long as
the dimensions were consistent!). This led to loading reactors being inconvenient and
error-prone, and also posed a limitation for representing more complex systems that have
non-core components.</p>
<p>Version 3 was created to make the schema more flexible and to permit storing the entire
reactor model within the HDF5 file. All objects in the ARMI Composite Model are written
to the database, and the model can be recovered in its entirety just from the HDF5 file.
Since it’s inception, it has seen a number of tweaks to improve its functionality and
fix bugs.</p>
<p>Being a serialization format, the code associated with reading and writing database
files may not benefit from Don’t Repeat Yourself (DRY) practices in the same way as
other code. Therefore, we do not share much, if any, code between different major
versions of the databases. As such, new major-versioned database implementations should
exist in their own modules. Minor revisions (e.g. M.(N+1)) to the database structure
should be simple enough that specialized logic can be used to support all minor versions
without posing a maintenance burden. A detailed change log should be maintained of each
minor revision.</p>
<dl class="class">
<dt id="armi.bookkeeping.db.Database3">
<em class="property">class </em><code class="sig-prename descclassname">armi.bookkeeping.db.</code><code class="sig-name descname">Database3</code><span class="sig-paren">(</span><em class="sig-param">fileName: os.PathLike</em>, <em class="sig-param">permission: str</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="armi.bookkeeping.db.database.html#armi.bookkeeping.db.database.Database" title="armi.bookkeeping.db.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.bookkeeping.db.database.Database</span></code></a></p>
<p>Version 3 of the ARMI Database, handling serialization and loading of Reactor states.</p>
<p>This implementation of the database pushes all objects in the Composite Reactor
Model into the database. This process is aided by the <code class="docutils literal notranslate"><span class="pre">Layout</span></code> class, which
handles the packing and unpacking of the structure of the objects, their
relationships, and their non-parameter attributes.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><cite>doc/user/outputs/database</cite> for more details.</p>
</div>
<p>Create a new Database3 object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> – name of the file</p></li>
<li><p><strong>permission</strong> – file permissions, write (“w”) or read (“r”)</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="armi.bookkeeping.db.Database3.timeNodeGroupPattern">
<code class="sig-name descname">timeNodeGroupPattern</code><em class="property"> = re.compile('^c(\\d\\d)n(\\d\\d)$')</em><a class="headerlink" href="#armi.bookkeeping.db.Database3.timeNodeGroupPattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.version">
<em class="property">property </em><code class="sig-name descname">version</code><a class="headerlink" href="#armi.bookkeeping.db.Database3.version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.versionMajor">
<em class="property">property </em><code class="sig-name descname">versionMajor</code><a class="headerlink" href="#armi.bookkeeping.db.Database3.versionMajor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.versionMinor">
<em class="property">property </em><code class="sig-name descname">versionMinor</code><a class="headerlink" href="#armi.bookkeeping.db.Database3.versionMinor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.open">
<code class="sig-name descname">open</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.open" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.grabLocalCommitHash">
<em class="property">static </em><code class="sig-name descname">grabLocalCommitHash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.grabLocalCommitHash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.grabLocalCommitHash" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to determine the local Git commit.</p>
<p>We have to be sure to handle the errors where the code is run on a system that
doesn’t have Git installed. Or if the code is simply not run from inside a repo.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The commit hash if it exists, otherwise “unknown”.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><em class="sig-param">completedSuccessfully=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the DB and perform cleanups and auto-conversions.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.splitDatabase">
<code class="sig-name descname">splitDatabase</code><span class="sig-paren">(</span><em class="sig-param">keepTimeSteps: Sequence[Tuple[int, int]], label: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.splitDatabase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.splitDatabase" title="Permalink to this definition">¶</a></dt>
<dd><p>Discard all data except for specific time steps, retaining old data in a separate file.</p>
<p>This is useful when performing more exotic analyses, where each “time step” may
not represent a specific point in time, but something more nuanced. For example,
equilibrium cases store a new “cycle” for each iteration as it attempts to
converge the equilibrium cycle. At the end of the run, the last “cycle” is the
converged equilibrium cycle, whereas the previous cycles constitute the path to
convergence, which we typically wish to discard before further analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keepTimeSteps</strong> – A collection of the time steps to retain</p></li>
<li><p><strong>label</strong> – An informative label for the backed-up database. Usually something like
“-all-iterations”. Will be interposed between the source name and the “.h5”
extension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of the new, backed-up database file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.fileName">
<em class="property">property </em><code class="sig-name descname">fileName</code><a class="headerlink" href="#armi.bookkeeping.db.Database3.fileName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.loadCS">
<code class="sig-name descname">loadCS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.loadCS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.loadCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to load settings from the database file</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>There are no guarantees here. If the database was written from a different version of ARMI than you are using,
these results may not be usable. For instance, the database could have been written from a vastly old or future
version of ARMI from the code you are using.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.loadBlueprints">
<code class="sig-name descname">loadBlueprints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.loadBlueprints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.loadBlueprints" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to load reactor blueprints from the database file</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>There are no guarantees here. If the database was written from a different version of ARMI than you are using,
these results may not be usable. For instance, the database could have been written from a vastly old or future
version of ARMI from the code you are using.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.loadGeometry">
<code class="sig-name descname">loadGeometry</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.loadGeometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.loadGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>This is primarily just used for migrations.
The “geometry files” were replaced by <code class="docutils literal notranslate"><span class="pre">systems:</span></code> and <code class="docutils literal notranslate"><span class="pre">grids:</span></code> sections of <code class="docutils literal notranslate"><span class="pre">Blueprints</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.writeInputsToDB">
<code class="sig-name descname">writeInputsToDB</code><span class="sig-paren">(</span><em class="sig-param">cs</em>, <em class="sig-param">csString=None</em>, <em class="sig-param">geomString=None</em>, <em class="sig-param">bpString=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.writeInputsToDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.writeInputsToDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Write inputs into the database based the CaseSettings.</p>
<p>This is not DRY on purpose. The goal is that any particular Database
implementation should be very stable, so we dont want it to be easy to change
one Database implementation’s behavior when trying to change another’s.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This is hard-coded to read the entire file contents into memory and write that
directly into the database. We could have the cs/blueprints/geom write to a
string, however the ARMI log file contains a hash of each files’ contents. In
the future, we should be able to reproduce a calculation with confidence that
the inputs are identical.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.readInputsFromDB">
<code class="sig-name descname">readInputsFromDB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.readInputsFromDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.readInputsFromDB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.mergeHistory">
<code class="sig-name descname">mergeHistory</code><span class="sig-paren">(</span><em class="sig-param">inputDB</em>, <em class="sig-param">startCycle</em>, <em class="sig-param">startNode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.mergeHistory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.mergeHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy time step data up to, but not including the passed cycle and node.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This is used for restart runs with the standard operator for example.
The current time step (being loaded from) should not be copied, as that
time steps data will be written at the end of the time step.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.__enter__">
<code class="sig-name descname">__enter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.__enter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.__enter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Context management support</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.__exit__">
<code class="sig-name descname">__exit__</code><span class="sig-paren">(</span><em class="sig-param">type</em>, <em class="sig-param">value</em>, <em class="sig-param">traceback</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.__exit__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.__exit__" title="Permalink to this definition">¶</a></dt>
<dd><p>Typically we don’t care why it broke but we want the DB to close</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.genTimeStepGroups">
<code class="sig-name descname">genTimeStepGroups</code><span class="sig-paren">(</span><em class="sig-param">timeSteps: Sequence[Tuple[int</em>, <em class="sig-param">int]] = None</em><span class="sig-paren">)</span> &#x2192; Generator[h5py._hl.group.Group, None, None]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.genTimeStepGroups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.genTimeStepGroups" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator of HDF5 Groups for all time nodes, or for the passed selection.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getLayout">
<code class="sig-name descname">getLayout</code><span class="sig-paren">(</span><em class="sig-param">cycle</em>, <em class="sig-param">node</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getLayout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getLayout" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Layout object representing the requested cycle and time node.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.genTimeSteps">
<code class="sig-name descname">genTimeSteps</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Generator[Tuple[int, int], None, None]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.genTimeSteps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.genTimeSteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator of (cycle, node) tuples that are present in the DB.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.genAuxiliaryData">
<code class="sig-name descname">genAuxiliaryData</code><span class="sig-paren">(</span><em class="sig-param">ts: Tuple[int, int]</em><span class="sig-paren">)</span> &#x2192; Generator[str, None, None]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.genAuxiliaryData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.genAuxiliaryData" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generator of names of auxiliary data on the requested time point.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getAuxiliaryDataPath">
<code class="sig-name descname">getAuxiliaryDataPath</code><span class="sig-paren">(</span><em class="sig-param">ts: Tuple[int, int], name: str</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getAuxiliaryDataPath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getAuxiliaryDataPath" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a string describing a path to an auxiliary data location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – The time step that the auxiliary data belongs to</p></li>
<li><p><strong>name</strong> – The name of the auxiliary data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An absolute location for storing auxiliary data with the given name for the
given time step</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.keys">
<code class="sig-name descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getH5Group">
<code class="sig-name descname">getH5Group</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">statePointName=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getH5Group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getH5Group" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the H5Group for the current ARMI timestep.</p>
<p>This method can be used to allow other interfaces to place data into the database
at the correct timestep.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.hasTimeStep">
<code class="sig-name descname">hasTimeStep</code><span class="sig-paren">(</span><em class="sig-param">cycle</em>, <em class="sig-param">timeNode</em>, <em class="sig-param">statePointName=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.hasTimeStep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.hasTimeStep" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if (cycle, timeNode, statePointName) is contained in the database.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.writeToDB">
<code class="sig-name descname">writeToDB</code><span class="sig-paren">(</span><em class="sig-param">reactor</em>, <em class="sig-param">statePointName=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.writeToDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.writeToDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Write reactor data to the DB</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.syncToSharedFolder">
<code class="sig-name descname">syncToSharedFolder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.syncToSharedFolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.syncToSharedFolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy DB to run working directory.</p>
<p>Needed when multiple MPI processes need to read the same db, for example
when a history is needed from independent runs (e.g. for fuel performance on
a variety of assemblies).</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>At some future point, we may implement a client-server like DB system which
would render this kind of operation unnecessary.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">cycle</em>, <em class="sig-param">node</em>, <em class="sig-param">cs=None</em>, <em class="sig-param">bp=None</em>, <em class="sig-param">statePointName=None</em>, <em class="sig-param">allowMissing=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a new reactor from (cycle, node).</p>
<p>Case settings, blueprints, and geom can be provided by the client, or read from
the database itself. Providing these from the client could be useful when
performing snapshot runs or the like, where it is expected to use results from a
run using different settings, then continue with new settings. Even in this
case, the blueprints and geom should probably be the same as the original run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cycle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – cycle number</p></li>
<li><p><strong>node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – time node</p></li>
<li><p><strong>cs</strong> (<em>armi.settings.Settings</em><em> (</em><em>optional</em><em>)</em>) – if not provided one is read from the database</p></li>
<li><p><strong>bp</strong> (<em>armi.reactor.Blueprints</em><em> (</em><em>Optional</em><em>)</em>) – if not provided one is read from the database</p></li>
<li><p><strong>statePointName</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Optional arbitrary statepoint name (e.g., “special” for “c00n00-special/”)</p></li>
<li><p><strong>allowMissing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to emit a warning, rather than crash if reading a database
with undefined parameters. Default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>root</strong> – The top-level object stored in the database; usually a Reactor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="armi.reactor.composites.html#armi.reactor.composites.ArmiObject" title="armi.reactor.composites.ArmiObject">ArmiObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3._assignBlueprintsParams">
<em class="property">static </em><code class="sig-name descname">_assignBlueprintsParams</code><span class="sig-paren">(</span><em class="sig-param">blueprints</em>, <em class="sig-param">groupedComps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3._assignBlueprintsParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3._assignBlueprintsParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3._compose">
<code class="sig-name descname">_compose</code><span class="sig-paren">(</span><em class="sig-param">comps</em>, <em class="sig-param">cs</em>, <em class="sig-param">parent=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3._compose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3._compose" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a flat collection of all of the ArmiObjects in the model, reconstitute the hierarchy.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3._writeParams">
<code class="sig-name descname">_writeParams</code><span class="sig-paren">(</span><em class="sig-param">h5group</em>, <em class="sig-param">comps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3._writeParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3._writeParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3._addHomogenizedNumberDensityParams">
<em class="property">static </em><code class="sig-name descname">_addHomogenizedNumberDensityParams</code><span class="sig-paren">(</span><em class="sig-param">blocks</em>, <em class="sig-param">h5group</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3._addHomogenizedNumberDensityParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3._addHomogenizedNumberDensityParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Create on-the-fly block homog. number density params for XTVIEW viewing.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">collectBlockNumberDensities()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3._readParams">
<em class="property">static </em><code class="sig-name descname">_readParams</code><span class="sig-paren">(</span><em class="sig-param">h5group</em>, <em class="sig-param">compTypeName</em>, <em class="sig-param">comps</em>, <em class="sig-param">allowMissing=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3._readParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3._readParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getHistoryByLocation">
<code class="sig-name descname">getHistoryByLocation</code><span class="sig-paren">(</span><em class="sig-param">comp: armi.reactor.composites.ArmiObject</em>, <em class="sig-param">params: Optional[List[str]] = None</em>, <em class="sig-param">timeSteps: Optional[Sequence[Tuple[int</em>, <em class="sig-param">int]]] = None</em><span class="sig-paren">)</span> &#x2192; Dict[str, Dict[Tuple[int, int], Any]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getHistoryByLocation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getHistoryByLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameter histories at a specific location.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getHistoriesByLocation">
<code class="sig-name descname">getHistoriesByLocation</code><span class="sig-paren">(</span><em class="sig-param">comps: Sequence[armi.reactor.composites.ArmiObject], params: Optional[List[str]] = None, timeSteps: Optional[Sequence[Tuple[int, int]]] = None</em><span class="sig-paren">)</span> &#x2192; Dict[armi.reactor.composites.ArmiObject, Dict[str, Dict[Tuple[int, int], Any]]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getHistoriesByLocation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getHistoriesByLocation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameter histories at specific locations.</p>
<dl class="simple">
<dt>This has a number of limitations, which should in practice not be too limiting:</dt><dd><ul class="simple">
<li><p>The passed objects must have IndexLocations. This type of operation doesn’t
make much sense otherwise.</p></li>
<li><p>The passed objects must exist in a hierarchy that leads to a Core
object, which serves as an anchor that can fully define all index locations.
This could possibly be made more general by extending grids, but that gets a
little more complicated.</p></li>
<li><p>All requested objects must exist under the <strong>same</strong> anchor object, and at the
same depth below it.</p></li>
<li><p>All requested objects must have the same type.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comps</strong> (<em>list of ArmiObject</em>) – The components/composites that currently occupy the location that you want
histories at. ArmiObjects are passed, rather than locations, because this
makes it easier to figure out things related to layout.</p></li>
<li><p><strong>params</strong> (<em>List of str</em><em>, </em><em>optional</em>) – The parameter names for the parameters that we want the history of. If None,
all parameter history is given</p></li>
<li><p><strong>timeSteps</strong> (<em>List of</em><em> (</em><em>cycle</em><em>, </em><em>node</em><em>) </em><em>tuples</em><em>, </em><em>optional</em>) – The time nodes that you want history for. If None, all available time nodes
will be returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getHistory">
<code class="sig-name descname">getHistory</code><span class="sig-paren">(</span><em class="sig-param">comp: armi.reactor.composites.ArmiObject</em>, <em class="sig-param">params: Optional[Sequence[str]] = None</em>, <em class="sig-param">timeSteps: Optional[Sequence[Tuple[int</em>, <em class="sig-param">int]]] = None</em><span class="sig-paren">)</span> &#x2192; Dict[str, Dict[Tuple[int, int], Any]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getHistory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameter history for a single ARMI Object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comps</strong> – An individual ArmiObject</p></li>
<li><p><strong>params</strong> – parameters to gather</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of str/list pairs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.Database3.getHistories">
<code class="sig-name descname">getHistories</code><span class="sig-paren">(</span><em class="sig-param">comps: Sequence[armi.reactor.composites.ArmiObject], params: Optional[Sequence[str]] = None, timeSteps: Optional[Sequence[Tuple[int, int]]] = None</em><span class="sig-paren">)</span> &#x2192; Dict[armi.reactor.composites.ArmiObject, Dict[str, Dict[Tuple[int, int], Any]]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#Database3.getHistories"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.Database3.getHistories" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameter histories for a sequence of ARMI Objects.</p>
<p>This implementation is unaware of the state of the reactor outside of the
database itself, and is therefore not usually what client code should be calling
directly during normal ARMI operation. It only knows about historical data that
have actually been written to the database. Usually one wants to be able to get
historical, plus current data, for which the similar method on the
DatabaseInterface may be more useful.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comps</strong> – Something that is iterable multiple times</p></li>
<li><p><strong>params</strong> – parameters to gather.</p></li>
<li><p><strong>timeSteps</strong> – Selection of time nodes to get data for. If omitted, return full history</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary ArmiObject (input): dict of str/list pairs containing ((cycle,
node), value).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="armi.bookkeeping.db.DatabaseInterface">
<em class="property">class </em><code class="sig-prename descclassname">armi.bookkeeping.db.</code><code class="sig-name descname">DatabaseInterface</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">cs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="armi.interfaces.html#armi.interfaces.Interface" title="armi.interfaces.Interface"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.interfaces.Interface</span></code></a></p>
<p>Handles interactions between the ARMI data model and the persistent data storage
system.</p>
<p>This reads/writes the ARMI state to/from the database and helps derive state
information that can be derived.</p>
<p>Construct an interface.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">cs</span></code> arguments are required, but may be <code class="docutils literal notranslate"><span class="pre">None</span></code>, where
appropriate for the specific <code class="docutils literal notranslate"><span class="pre">Interface</span></code> implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<a class="reference internal" href="armi.reactor.reactors.html#armi.reactor.reactors.Reactor" title="armi.reactor.reactors.Reactor"><em>Reactor</em></a>) – A reactor to attach to</p></li>
<li><p><strong>cs</strong> (<a class="reference internal" href="armi.settings.caseSettings.html#armi.settings.caseSettings.Settings" title="armi.settings.caseSettings.Settings"><em>Settings</em></a>) – Settings object to use</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – Interfaces derived from Interface must define their name</p>
</dd>
</dl>
<dl class="attribute">
<dt id="armi.bookkeeping.db.DatabaseInterface.name">
<code class="sig-name descname">name</code><em class="property"> = 'database'</em><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.database">
<em class="property">property </em><code class="sig-name descname">database</code><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.database" title="Permalink to this definition">¶</a></dt>
<dd><p>Presents the internal database object, if it exists.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactBOL">
<code class="sig-name descname">interactBOL</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactBOL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactBOL" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the database if the main interface was not available. (Begining of Life)</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.initDB">
<code class="sig-name descname">initDB</code><span class="sig-paren">(</span><em class="sig-param">fName: Optional[os.PathLike] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.initDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.initDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the underlying database to be written to, and write input files to DB.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Main Interface calls this so that the database is available as early as
possible in the run. The database interface interacts near the end of the
interface stack (so that all the parameters have been updated) while the Main
Interface interacts first.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactEveryNode">
<code class="sig-name descname">interactEveryNode</code><span class="sig-paren">(</span><em class="sig-param">cycle</em>, <em class="sig-param">node</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactEveryNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactEveryNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to database.</p>
<p>DBs should receive the state information of the run at each node.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactEOC">
<code class="sig-name descname">interactEOC</code><span class="sig-paren">(</span><em class="sig-param">cycle=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactEOC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactEOC" title="Permalink to this definition">¶</a></dt>
<dd><p>In case anything changed since last cycle (e.g. rxSwing), update DB. (End of Cycle)</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactEOL">
<code class="sig-name descname">interactEOL</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactEOL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactEOL" title="Permalink to this definition">¶</a></dt>
<dd><p>DB’s should be closed at run’s end. (End of Life)</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactError">
<code class="sig-name descname">interactError</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactError" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shutdown state information even if the run encounters an error</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.interactDistributeState">
<code class="sig-name descname">interactDistributeState</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.interactDistributeState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.interactDistributeState" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconnect to pre-existing database.</p>
<p>DB is created and managed by the master node only but we can still connect to it
from workers to enable things like history tracking.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.distributable">
<code class="sig-name descname">distributable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.distributable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.distributable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true if this can be MPI broadcast.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Cases where this isn’t possible include the database interface,
where the SQL driver cannot be distributed.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.prepRestartRun">
<code class="sig-name descname">prepRestartRun</code><span class="sig-paren">(</span><em class="sig-param">dbCycle</em>, <em class="sig-param">dbNode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.prepRestartRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.prepRestartRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the data history from the database being restarted from.</p>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface._getLoadDB">
<code class="sig-name descname">_getLoadDB</code><span class="sig-paren">(</span><em class="sig-param">fileName</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface._getLoadDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface._getLoadDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the database to load from in order of preference.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>If filename is present only returns one database since specifically instructed
to load from that database.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.loadState">
<code class="sig-name descname">loadState</code><span class="sig-paren">(</span><em class="sig-param">cycle</em>, <em class="sig-param">timeNode</em>, <em class="sig-param">timeStepName=''</em>, <em class="sig-param">fileName=None</em>, <em class="sig-param">updateGlobalAssemNum=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.loadState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.loadState" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a fresh reactor and applies it to the Operator.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Will load preferentially from the <cite>fileName</cite> if passed. Otherwise will load from
existing database in memory or <cite>cs[“reloadDBName”]</cite> in that order.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – If fileName is specified and that  file does not have the time step.
    If fileName is not specified and neither the database in memory, nor the
    <cite>cs[“reloadDBName”]</cite> have the time step specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.getHistory">
<code class="sig-name descname">getHistory</code><span class="sig-paren">(</span><em class="sig-param">comp: armi.reactor.composites.ArmiObject</em>, <em class="sig-param">params: Optional[Sequence[str]] = None</em>, <em class="sig-param">timeSteps: Optional[MutableSequence[Tuple[int</em>, <em class="sig-param">int]]] = None</em>, <em class="sig-param">byLocation: bool = False</em><span class="sig-paren">)</span> &#x2192; Dict[str, Dict[Tuple[int, int], Any]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.getHistory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.getHistory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get historical parameter values for a single object.</p>
<p>This is mostly a wrapper around the same function on the <code class="docutils literal notranslate"><span class="pre">Database3</span></code> class,
but knows how to return the current value as well.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#armi.bookkeeping.db.Database3.getHistory" title="armi.bookkeeping.db.Database3.getHistory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Database3.getHistory()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.bookkeeping.db.DatabaseInterface.getHistories">
<code class="sig-name descname">getHistories</code><span class="sig-paren">(</span><em class="sig-param">comps: Sequence[armi.reactor.composites.ArmiObject], params: Optional[Sequence[str]] = None, timeSteps: Optional[MutableSequence[Tuple[int, int]]] = None, byLocation: bool = False</em><span class="sig-paren">)</span> &#x2192; Dict[armi.reactor.composites.ArmiObject, Dict[str, Dict[Tuple[int, int], Any]]]<a class="reference internal" href="../_modules/armi/bookkeeping/db/database3.html#DatabaseInterface.getHistories"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.DatabaseInterface.getHistories" title="Permalink to this definition">¶</a></dt>
<dd><p>Get historical parameter values for one or more objects.</p>
<p>This is mostly a wrapper around the same function on the <code class="docutils literal notranslate"><span class="pre">Database3</span></code> class,
but knows how to return the current value as well.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#armi.bookkeeping.db.Database3.getHistories" title="armi.bookkeeping.db.Database3.getHistories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Database3.getHistories()</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="armi.bookkeeping.db.compareDatabases">
<code class="sig-prename descclassname">armi.bookkeeping.db.</code><code class="sig-name descname">compareDatabases</code><span class="sig-paren">(</span><em class="sig-param">refFileName: str</em>, <em class="sig-param">srcFileName: str</em>, <em class="sig-param">exclusions: Optional[Sequence[str]] = None</em>, <em class="sig-param">tolerance: float = 0.0</em><span class="sig-paren">)</span> &#x2192; Optional[armi.bookkeeping.db.compareDB3.DiffResults]<a class="reference internal" href="../_modules/armi/bookkeeping/db/compareDB3.html#compareDatabases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.compareDatabases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="armi.bookkeeping.db.databaseFactory">
<code class="sig-prename descclassname">armi.bookkeeping.db.</code><code class="sig-name descname">databaseFactory</code><span class="sig-paren">(</span><em class="sig-param">dbName: str</em>, <em class="sig-param">permission: str</em>, <em class="sig-param">version: Optional[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/bookkeeping/db/factory.html#databaseFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.bookkeeping.db.databaseFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an appropriate object for interacting with a database file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbName</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to db file, e.g. <cite>baseCase.h5</cite></p></li>
<li><p><strong>permission</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – String defining permission, <cite>r</cite> for read only. See armi.bookeeping.db.permissions</p></li>
<li><p><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Version of database you want to read or write. In many cases ARMI will
auto-detect. For advanced users.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This is not a proper factory, as the different database versions do not present a
common interface. However, this is useful code, since it at least creates an object
based on some knowledge of how to probe around. This allows client code to just
interrogate the type of the returned object to figure out to do based on whatever it
needs.</p>
</div>
</dd></dl>

</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.compareDB3.html">armi.bookkeeping.db.compareDB3 module</a></li>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.database.html">armi.bookkeeping.db.database module</a></li>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.database3.html">armi.bookkeeping.db.database3 module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="armi.bookkeeping.db.database3.html#minor-revision-changelog">Minor revision changelog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.factory.html">armi.bookkeeping.db.factory module</a></li>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.permissions.html">armi.bookkeeping.db.permissions module</a></li>
<li class="toctree-l1"><a class="reference internal" href="armi.bookkeeping.db.typedefs.html">armi.bookkeeping.db.typedefs module</a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="armi.bookkeeping.db.compareDB3.html" class="btn btn-neutral float-right" title="armi.bookkeeping.db.compareDB3 module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="armi.bookkeeping.html" class="btn btn-neutral float-left" title="armi.bookkeeping package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2021, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2021-11-09.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>