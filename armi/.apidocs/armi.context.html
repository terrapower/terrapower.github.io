

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta property="og:title" content="armi.context module" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://terrapower.github.io/armi/.apidocs/armi.context.html" />
  <meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
  <meta property="og:description" content="Module containing global constants that reflect the executing context of ARMI. This contains information about the circumstatces under which an ARMI application is running. Things like the MPI envi..." />
  <meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
  <meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>armi.context module &mdash; ARMI 0.2.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/assets/jsonview.bundle.js"></script>
        <script src="../_static/assets/jsonview_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables.min.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="armi.interfaces module" href="armi.interfaces.html" />
    <link rel="prev" title="armi.conftest module" href="armi.conftest.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >
          

          
            <a href="../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements/index.html">Requirements</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="armi.html">armi package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="armi.html#subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="armi.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="armi.apps.html">armi.apps module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.conftest.html">armi.conftest module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">armi.context module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.interfaces.html">armi.interfaces module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.meta.html">armi.meta module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.mpiActions.html">armi.mpiActions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.pluginManager.html">armi.pluginManager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.plugins.html">armi.plugins module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.runLog.html">armi.runLog module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">armi</a> &raquo;</li>
        
          <li><a href="armi.html">armi package</a> &raquo;</li>
        
      <li>armi.context module</li>
    
    
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-armi.context">
<span id="armi-context-module"></span><h1>armi.context module<a class="headerlink" href="#module-armi.context" title="Permalink to this headline">¶</a></h1>
<p>Module containing global constants that reflect the executing context of ARMI.</p>
<p>This contains information about the circumstatces under which an ARMI application is
running. Things like the MPI environment, executing user, etc. live here. These are
re-exported by the <cite>armi</cite> package, but live here so that import loops won’t lead to
as many issues.</p>
<dl class="py class">
<dt class="sig sig-object py" id="armi.context.Mode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">Mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/context.html#Mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.Mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></a></p>
<p>Mode represents different run modes possible in ARMI.</p>
<p>The modes can be Batch, Interactive, or GUI. In different modes, there are different
types of interactions possible.</p>
<p>Mode is generally auto-detected based on your terminal. It can also be set in
various CLI entry points, which are the implementations of
<a class="reference internal" href="armi.cli.entryPoint.html#armi.cli.entryPoint.EntryPoint" title="armi.cli.entryPoint.EntryPoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.cli.entryPoint.EntryPoint</span></code></a>. Lastly, each entry point has a
<code class="docutils literal notranslate"><span class="pre">--batch</span></code> command line argument that can force Batch mode.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="armi.context.Mode.BATCH">
<span class="sig-name descname"><span class="pre">BATCH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#armi.context.Mode.BATCH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="armi.context.Mode.INTERACTIVE">
<span class="sig-name descname"><span class="pre">INTERACTIVE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#armi.context.Mode.INTERACTIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="armi.context.Mode.GUI">
<span class="sig-name descname"><span class="pre">GUI</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#armi.context.Mode.GUI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="armi.context.Mode.setMode">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">setMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/context.html#Mode.setMode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.Mode.setMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the run mode of the current ARMI case.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armi.context.activateLocalFastPath">
<span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">activateLocalFastPath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/armi/context.html#activateLocalFastPath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.activateLocalFastPath" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a local temp directory to be the fast path.</p>
<p><code class="docutils literal notranslate"><span class="pre">FAST_PATH</span></code> is often a local hard drive on a cluster node. It’s a high-performance
scratch space. Different processors on the same node should have different fast paths.
Some old code may MPI_RANK-dependent folders/filenames as well, but this is no longer
necessary.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This path will be obliterated when the job ends so be careful.</p>
</div>
<p>Note also
that this path is set at import time, so if a series of unit tests come through that
instantiate one operator after the other, the path will already exist the second time.
The directory is created in the Operator constructor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armi.context.getFastPath">
<span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">getFastPath</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/armi/context.html#getFastPath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.getFastPath" title="Permalink to this definition">¶</a></dt>
<dd><p>Callable to get the current FAST_PATH.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>It’s too dangerous to use <code class="docutils literal notranslate"><span class="pre">FAST_PATH</span></code> directly as it can change between import and
runtime. For example, a module that does <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">armi.context</span> <span class="pre">import</span> <span class="pre">FAST_PATH</span></code> is
disconnected from the official <code class="docutils literal notranslate"><span class="pre">FAST_PATH</span></code> controlled by this module.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armi.context.cleanTempDirs">
<span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">cleanTempDirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">olderThanDays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/context.html#cleanTempDirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.cleanTempDirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean up temporary files after a run.</p>
<p>The Windows HPC system sends a SIGBREAK signal when the user cancels a job, which
is NOT handled by <code class="docutils literal notranslate"><span class="pre">atexit</span></code>. Notably SIGBREAK doesn’t exist off Windows.
For the SIGBREAK signal to work with a Microsoft HPC, the <code class="docutils literal notranslate"><span class="pre">TaskCancelGracePeriod</span></code>
option must be configured to be non-zero. This sets the period between SIGBREAK
and SIGTERM/SIGINT. To do cleanups in this case, we must use the <code class="docutils literal notranslate"><span class="pre">signal</span></code> module.
Actually, even then it does not work because MS <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code> does not pass signals
through.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>olderThanDays</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – If provided, deletes other ARMI directories if they are older than the requested
time.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armi.context.cleanAllArmiTempDirs">
<span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">cleanAllArmiTempDirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">olderThanDays</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/armi/context.html#cleanAllArmiTempDirs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.cleanAllArmiTempDirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete all ARMI-related files from other unrelated runs after <cite>olderThanDays</cite> days (in
case this failed on earlier runs).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This will break any concurrent runs that are still running.</p>
</div>
<p>This is a useful utility in HPC environments when some runs crash sometimes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="armi.context.disconnectAllHdfDBs">
<span class="sig-prename descclassname"><span class="pre">armi.context.</span></span><span class="sig-name descname"><span class="pre">disconnectAllHdfDBs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/armi/context.html#disconnectAllHdfDBs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#armi.context.disconnectAllHdfDBs" title="Permalink to this definition">¶</a></dt>
<dd><p>Forcibly disconnect all instances of HdfDB objects</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This is a hack to help ARMI exit gracefully when the garbage collector and h5py have
issues destroying objects. After lots of investigation, the root cause for why this
was having issues was never identified. It appears that when several HDF5 files are
open in the same run (e.g.  when calling armi.init() multiple times from a
post-processing script), when these h5py File objects were closed, the garbage
collector would raise an exception related to the repr’ing the object. We
get around this by using the garbage collector to manually disconnect all open HdfDB
objects.</p>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="armi.interfaces.html" class="btn btn-neutral float-right" title="armi.interfaces module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="armi.conftest.html" class="btn btn-neutral float-left" title="armi.conftest module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2023, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2023-01-04.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>