

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta property="og:title" content="armi.mpiActions module" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://terrapower.github.io/armi/.apidocs/armi.mpiActions.html" />
  <meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
  <meta property="og:description" content="This module provides an abstract class to be used to implement “MPI actions.” MPI actions are tasks, activities, or work that can be executed on the worker nodes. The standard workflow is essential..." />
  <meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
  <meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>armi.mpiActions module &mdash; ARMI 0.1.7 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="armi.pluginManager module" href="armi.pluginManager.html" />
    <link rel="prev" title="armi.meta module" href="armi.meta.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >
          

          
            <a href="../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blog/index.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Docs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="armi.html">armi package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="armi.html#subpackages">Subpackages</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="armi.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="armi.apps.html">armi.apps module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.conftest.html">armi.conftest module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.context.html">armi.context module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.interfaces.html">armi.interfaces module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.meta.html">armi.meta module</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">armi.mpiActions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.pluginManager.html">armi.pluginManager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.plugins.html">armi.plugins module</a></li>
<li class="toctree-l4"><a class="reference internal" href="armi.runLog.html">armi.runLog module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">armi</a> &raquo;</li>
        
          <li><a href="armi.html">armi package</a> &raquo;</li>
        
      <li>armi.mpiActions module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/terrapower/armi/blob/master/doc/.apidocs/armi.mpiActions.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-armi.mpiActions">
<span id="armi-mpiactions-module"></span><h1>armi.mpiActions module<a class="headerlink" href="#module-armi.mpiActions" title="Permalink to this headline">¶</a></h1>
<p>This module provides an abstract class to be used to implement “MPI actions.”</p>
<p>MPI actions are tasks, activities, or work that can be executed on the worker nodes. The standard
workflow is essentially that the master node creates an <a class="reference internal" href="#armi.mpiActions.MpiAction" title="armi.mpiActions.MpiAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpiAction</span></code></a>,
sends it to the workers, and then both the master and the workers
<a class="reference internal" href="#armi.mpiActions.MpiAction.invoke" title="armi.mpiActions.MpiAction.invoke"><code class="xref py py-meth docutils literal notranslate"><span class="pre">invoke()</span></code></a> together. For example:</p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">Sample MPI Action Workflow</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 5%" />
<col style="width: 60%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Step</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><strong>master</strong>: <a class="reference internal" href="#armi.mpiActions.MpiAction" title="armi.mpiActions.MpiAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">distributeState</span> <span class="pre">=</span> <span class="pre">DistributeStateAction()</span></code></a></p>
<p><strong>worker</strong>: <code class="code docutils literal notranslate"><span class="pre">action</span> <span class="pre">=</span> <span class="pre">armi.MPI_COMM.bcast(None,</span> <span class="pre">root=0)</span></code></p>
</td>
<td><p><strong>master</strong>: Initializing a distribute state action.</p>
<p><strong>worker</strong>: Waiting for something to do, as determined by the master, this happens within the
worker’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">workerOperate()</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><strong>master</strong>: <code class="code docutils literal notranslate"><span class="pre">armi.MPI_COMM.bcast(distributeState,</span> <span class="pre">root=0)</span></code></p>
<p><strong>worker</strong>: <code class="code docutils literal notranslate"><span class="pre">action</span> <span class="pre">=</span> <span class="pre">armi.MPI_COMM.bcast(None,</span> <span class="pre">root=0)</span></code></p>
</td>
<td><p><strong>master</strong>: Broadcasts a distribute state action to all the worker nodes</p>
<p><strong>worker</strong>: Receives the action from the master, which is a
<a class="reference internal" href="#armi.mpiActions.DistributeStateAction" title="armi.mpiActions.DistributeStateAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributeStateAction</span></code></a>.</p>
</td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><strong>master</strong>: <code class="code docutils literal notranslate"><span class="pre">distributeState.invoke(self.o,</span> <span class="pre">self.r,</span> <span class="pre">self.cs)</span></code></p>
<p><strong>worker</strong>: <code class="code docutils literal notranslate"><span class="pre">action.invoke(self.o,</span> <span class="pre">self.r,</span> <span class="pre">self.cs)</span></code></p>
</td>
<td><p>Both invoke the action, and are in sync. Any broadcast or receive within the action should
also be synced up.</p></td>
</tr>
</tbody>
</table>
<p>In order to create a new, custom MPI Action, inherit from <a class="reference internal" href="#armi.mpiActions.MpiAction" title="armi.mpiActions.MpiAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpiAction</span></code></a>,
and override the <a class="reference internal" href="#armi.mpiActions.MpiAction.invokeHook" title="armi.mpiActions.MpiAction.invokeHook"><code class="xref py py-meth docutils literal notranslate"><span class="pre">invokeHook()</span></code></a> method.</p>
<dl class="class">
<dt id="armi.mpiActions.MpiAction">
<em class="property">class </em><code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">MpiAction</code><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base of all MPI actions.</p>
<p>MPI Actions are tasks that can be executed without needing lots of other
information. When a worker node sits in it’s main loop, and receives an MPI Action, it will
simply call <a class="reference internal" href="#armi.mpiActions.MpiAction.invoke" title="armi.mpiActions.MpiAction.invoke"><code class="xref py py-meth docutils literal notranslate"><span class="pre">invoke()</span></code></a>.</p>
<dl class="method">
<dt id="armi.mpiActions.MpiAction.parallel">
<em class="property">property </em><code class="sig-name descname">parallel</code><a class="headerlink" href="#armi.mpiActions.MpiAction.parallel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.invokeAsMaster">
<em class="property">classmethod </em><code class="sig-name descname">invokeAsMaster</code><span class="sig-paren">(</span><em class="sig-param">o</em>, <em class="sig-param">r</em>, <em class="sig-param">cs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.invokeAsMaster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.invokeAsMaster" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplified method to call from the master process.</p>
<p>This can be used in place of:</p>
<blockquote>
<div><p>someInstance = MpiAction()
someInstance = COMM_WORLD.bcast(someInstance, root=0)
someInstance.invoke(o, r, cs)</p>
</div></blockquote>
<p>Interestingly, the code above can be used in two ways:</p>
<ol class="arabic simple">
<li><p>Both the master and worker can call the above code at the same time, or</p></li>
<li><p>the master can run the above code, which will be handled by the worker’s main loop.</p></li>
</ol>
<p>Option number 2 is the most common usage.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method will not work if the constructor (i.e. <code class="code docutils literal notranslate"><span class="pre">__init__</span></code>) requires
additional arguments. Since the method body is so simple, it is strong discouraged to
add a <code class="code docutils literal notranslate"><span class="pre">*args</span></code> or <code class="code docutils literal notranslate"><span class="pre">**kwargs</span></code> arguments to this method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">armi.operators.Operator</span></code>) – If an operator is not necessary, supply <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">armi.operators.Reactor</span></code>) – If a reactor is not necessary, supply <code class="code docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction._mpiOperationHelper">
<code class="sig-name descname">_mpiOperationHelper</code><span class="sig-paren">(</span><em class="sig-param">obj</em>, <em class="sig-param">mpiFunction</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction._mpiOperationHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction._mpiOperationHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips off the operator, reactor, cs from the mpiAction before</p>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.broadcast">
<code class="sig-name descname">broadcast</code><span class="sig-paren">(</span><em class="sig-param">obj=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.broadcast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.broadcast" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper around <code class="docutils literal notranslate"><span class="pre">bcast</span></code>, on the master node can be run with an equals sign, so that it
can be consistent within both master and worker nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – This is any object that can be broadcast, if it is None, then it will broadcast itself,
which triggers it to run on the workers (assuming the workers are in the worker main loop.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.operators.operator.OperatorMPI.workerOperate()</span></code></dt><dd><p>receives this on the workers and calls <code class="docutils literal notranslate"><span class="pre">invoke</span></code></p>
</dd>
</dl>
</div>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>The standard <code class="docutils literal notranslate"><span class="pre">bcast</span></code> method creates a new instance even for the root process. Consequently,
when passing an object, references can be broken to the original object. Therefore, this
method, returns the original object when called by the master node, or the broadcasted
object when called on the worker nodes.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.gather">
<code class="sig-name descname">gather</code><span class="sig-paren">(</span><em class="sig-param">obj=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.gather"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.gather" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper around <code class="docutils literal notranslate"><span class="pre">MPI_COMM.gather</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – This is any object that can be gathered, if it is None, then it will gather itself.</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>The returned list will contain a reference to the original gathered object, without making a copy of it.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.invoke">
<code class="sig-name descname">invoke</code><span class="sig-paren">(</span><em class="sig-param">o</em>, <em class="sig-param">r</em>, <em class="sig-param">cs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.invoke"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.invoke" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called by worker nodes, and passed the worker node’s operator, reactor and
settings file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>o</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">armi.operators.Operator</span></code>) – the operator for this process</p></li>
<li><p><strong>r</strong> (<a class="reference internal" href="armi.reactor.reactors.html#armi.reactor.reactors.Reactor" title="armi.reactor.reactors.Reactor"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.reactor.reactors.Reactor</span></code></a>) – the reactor represented in this process</p></li>
<li><p><strong>cs</strong> (<a class="reference internal" href="armi.settings.caseSettings.html#armi.settings.caseSettings.Settings" title="armi.settings.caseSettings.Settings"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.settings.caseSettings.Settings</span></code></a>) – the case settings</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – result from invokeHook</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)">object</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.mpiFlatten">
<em class="property">static </em><code class="sig-name descname">mpiFlatten</code><span class="sig-paren">(</span><em class="sig-param">allCPUResults</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.mpiFlatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.mpiFlatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten results to the same order they were in before making a list of mpiIter results.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#armi.mpiActions.MpiAction.mpiIter" title="armi.mpiActions.MpiAction.mpiIter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mpiIter()</span></code></a></dt><dd><p>used for distributing objects/tasks</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.mpiIter">
<em class="property">static </em><code class="sig-name descname">mpiIter</code><span class="sig-paren">(</span><em class="sig-param">objectsForAllCoresToIter</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.mpiIter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.mpiIter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the subset of objects one node is responsible for in MPI.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Each CPU will get similar number of objects. E.G. if there are 12 objects and 5
CPUs, the first 2 CPUs will get 3 objects and the last 3 CPUS will get 2.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>objectsForAllCoresToIter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – List of all objects that need to have an MPI calculation performed on.
Note, that since len() is needed this method cannot accept a generator.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#armi.mpiActions.MpiAction.mpiFlatten" title="armi.mpiActions.MpiAction.mpiFlatten"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mpiFlatten()</span></code></a></dt><dd><p>used for collecting results</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.MpiAction.invokeHook">
<code class="sig-name descname">invokeHook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiAction.invokeHook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiAction.invokeHook" title="Permalink to this definition">¶</a></dt>
<dd><p>This method must be overridden in sub-clases.</p>
<p>This method is called by worker nodes, and has access to the worker node’s operator,
reactor, and settings (through <code class="code docutils literal notranslate"><span class="pre">self.o</span></code>, <code class="code docutils literal notranslate"><span class="pre">self.r</span></code>, and <code class="code docutils literal notranslate"><span class="pre">self.cs</span></code>).
It must return a boolean value of <code class="code docutils literal notranslate"><span class="pre">True</span></code> or <code class="code docutils literal notranslate"><span class="pre">False</span></code>, otherwise the worker node
will raise an exception and terminate execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>result</strong> – Dependent on implementation</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)">object</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="armi.mpiActions.runActions">
<code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">runActions</code><span class="sig-paren">(</span><em class="sig-param">o</em>, <em class="sig-param">r</em>, <em class="sig-param">cs</em>, <em class="sig-param">actions</em>, <em class="sig-param">numPerNode=None</em>, <em class="sig-param">serial=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#runActions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.runActions" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a series of MpiActions in parallel, or in series if <code class="code docutils literal notranslate"><span class="pre">serial=True</span></code>.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>The number of actions DOES NOT need to match <code class="code docutils literal notranslate"><span class="pre">armi.MPI_SIZE</span></code>.</p>
<p>Calling this method may invoke MPI Split which will change the MPI_SIZE during the action. This allows someone to
call MPI operations without being blocked by tasks which are not doing the same thing.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="armi.mpiActions.runActionsInSerial">
<code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">runActionsInSerial</code><span class="sig-paren">(</span><em class="sig-param">o</em>, <em class="sig-param">r</em>, <em class="sig-param">cs</em>, <em class="sig-param">actions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#runActionsInSerial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.runActionsInSerial" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a series of MpiActions in serial.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This will set the <cite>MpiAction.serial</cite> attribute to <code class="code docutils literal notranslate"><span class="pre">True</span></code>, and the <cite>MpiAction.broadcast</cite> and <cite>MpiAction.gather</cite>
methods will basically just return the value being supplied.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="armi.mpiActions.DistributionAction">
<em class="property">class </em><code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">DistributionAction</code><span class="sig-paren">(</span><em class="sig-param">actions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributionAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributionAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#armi.mpiActions.MpiAction" title="armi.mpiActions.MpiAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.mpiActions.MpiAction</span></code></a></p>
<p>This MpiAction scatters the workload of multiple actions to available resources.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This currently only works from the root (of COMM_WORLD). Eventually, it would be nice to make
it possible for sub-tasks to manage their own communicators and spawn their own work within some
sub-communicator.</p>
<p>This performs an MPI Split operation and takes over the armi.MPI_COMM and associated varaibles.
For this reason, it is possible that when someone thinks they have distributed information to all
nodes, it may only be a subset that was necessary to perform the number of actions needed by this
DsitributionAction.</p>
</div>
<dl class="method">
<dt id="armi.mpiActions.DistributionAction.__reduce__">
<code class="sig-name descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributionAction.__reduce__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributionAction.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce prevents from unnecessary actions to others, after all we only want to scatter.</p>
<p>Consequently, the worker nodes _actions will be None.</p>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.DistributionAction.invokeHook">
<code class="sig-name descname">invokeHook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributionAction.invokeHook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributionAction.invokeHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Overrides invokeHook to distribute work amongst available resources as requested.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Two things about this method make it non-recursiv</p>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="armi.mpiActions.MpiActionError">
<em class="property">exception </em><code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">MpiActionError</code><a class="reference internal" href="../_modules/armi/mpiActions.html#MpiActionError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.MpiActionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception class raised when error conditions occur during an MpiAction.</p>
</dd></dl>

<dl class="class">
<dt id="armi.mpiActions.DistributeStateAction">
<em class="property">class </em><code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">DistributeStateAction</code><span class="sig-paren">(</span><em class="sig-param">skipInterfaces=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#armi.mpiActions.MpiAction" title="armi.mpiActions.MpiAction"><code class="xref py py-class docutils literal notranslate"><span class="pre">armi.mpiActions.MpiAction</span></code></a></p>
<dl class="method">
<dt id="armi.mpiActions.DistributeStateAction.invokeHook">
<code class="sig-name descname">invokeHook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction.invokeHook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction.invokeHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync up all nodes with the reactor, the cs, and the interfaces.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This is run by all workers and the master any time the code needs to sync all processors.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="armi.mpiActions.DistributeStateAction._distributeSettings">
<code class="sig-name descname">_distributeSettings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction._distributeSettings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction._distributeSettings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.mpiActions.DistributeStateAction._distributeReactor">
<code class="sig-name descname">_distributeReactor</code><span class="sig-paren">(</span><em class="sig-param">cs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction._distributeReactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction._distributeReactor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.mpiActions.DistributeStateAction._distributeParamAssignments">
<code class="sig-name descname">_distributeParamAssignments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction._distributeParamAssignments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction._distributeParamAssignments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="armi.mpiActions.DistributeStateAction._distributeInterfaces">
<code class="sig-name descname">_distributeInterfaces</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#DistributeStateAction._distributeInterfaces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions.DistributeStateAction._distributeInterfaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Distribute the interfaces to all MPI nodes.</p>
<p>Interface copy description
Since interfaces store information that can influence a calculation, it is important
in branch searches to make sure that no information is carried forward from these
runs on either the master node or the workers.  However, there are interfaces that
cannot be distributed, making this a challenge.  To solve this problem, any interface
that cannot be distributed is simply re-initialized.  If any information needs to be
given to the worker nodes on a non-distributable interface, additional function definitions
(and likely soul searching as to why needed distributable information is on a
non-distributable interface) are required to pass the information around.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="armi.interfaces.html#armi.interfaces.Interface.preDistributeState" title="armi.interfaces.Interface.preDistributeState"><code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.interfaces.Interface.preDistributeState()</span></code></a></dt><dd><p>runs on master before DS</p>
</dd>
<dt><a class="reference internal" href="armi.interfaces.html#armi.interfaces.Interface.postDistributeState" title="armi.interfaces.Interface.postDistributeState"><code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.interfaces.Interface.postDistributeState()</span></code></a></dt><dd><p>runs on master after DS</p>
</dd>
<dt><a class="reference internal" href="armi.interfaces.html#armi.interfaces.Interface.interactDistributeState" title="armi.interfaces.Interface.interactDistributeState"><code class="xref py py-meth docutils literal notranslate"><span class="pre">armi.interfaces.Interface.interactDistributeState()</span></code></a></dt><dd><p>runs on workers after DS</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="armi.mpiActions._diagnosePickleError">
<code class="sig-prename descclassname">armi.mpiActions.</code><code class="sig-name descname">_diagnosePickleError</code><span class="sig-paren">(</span><em class="sig-param">o</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/armi/mpiActions.html#_diagnosePickleError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#armi.mpiActions._diagnosePickleError" title="Permalink to this definition">¶</a></dt>
<dd><p>Scans through various parts of the reactor to identify which part cannot be pickled.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>So, you’re having a pickle error and you don’t know why. This method will help you
find the problem. It doesn’t always catch everything, but it does help.</p>
<p>We also find that modifying the Python library as documented here tells us which
object can’t be pickled by printing it out.</p>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="armi.pluginManager.html" class="btn btn-neutral float-right" title="armi.pluginManager module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="armi.meta.html" class="btn btn-neutral float-left" title="armi.meta module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2021, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2021-10-26.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>