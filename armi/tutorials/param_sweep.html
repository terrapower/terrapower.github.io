

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5. Parameter sweeps" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://terrapower.github.io/armi/tutorials/param_sweep.html" />
<meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
<meta property="og:description" content="Parameter sweeps allow you to quickly and easily build a series of related cases that all change one or more aspects of the input model or modeling approximations. Because ARMI automates full-scope..." />
<meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
<meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
<meta name="description" content="Parameter sweeps allow you to quickly and easily build a series of related cases that all change one or more aspects of the input model or modeling approximations. Because ARMI automates full-scope..." />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. Parameter sweeps &mdash; ARMI 0.5.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme_fixes.css?v=2b77b304" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=e5fbc548" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_links.css?v=2150a916" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_toggle.css?v=5c6620df" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_style.css?v=678fb11e" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/needstable.css?v=5e1b6797" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/common_css/need_core.css?v=f5b60a78" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-needs/modern.css?v=803738c0" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-test-results/common.css?v=9ec2c1d5" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=b9afe91b"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
      <script src="../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
      <script src="../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
      <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=dca66431"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Release Notes" href="../release/index.html" />
    <link rel="prev" title="4. Making your first ARMI-based App" href="making_your_first_app.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >

          
          
          <a href="../index.html" class="icon icon-home">
            ARMI
              <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="walkthrough_inputs.html">1. Building input files for a fast reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="walkthrough_lwr_inputs.html">2. Building input files for a thermal reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_model.html">3. Hands-on at the ARMI Terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="making_your_first_app.html">4. Making your first ARMI-based App</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5. Parameter sweeps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#A-simple-one-dimensional-parameter-sweep">5.1. A simple one-dimensional parameter sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Modifying-the-reactor-design">5.2. Modifying the reactor design</a></li>
<li class="toctree-l3"><a class="reference internal" href="#A-full-factorial-parameter-sweep">5.3. A full factorial parameter sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Post-processing-the-results-of-the-sweep">5.4. Post-processing the results of the sweep</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qa_docs/index.html">QA Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.apidocs/modules.html">API Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #233C5B" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active"><span class="section-number">5. </span>Parameter sweeps</li>
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Parameter-sweeps">
<h1><span class="section-number">5. </span>Parameter sweeps<a class="headerlink" href="#Parameter-sweeps" title="Link to this heading"></a></h1>
<p>Parameter sweeps allow you to quickly and easily build a series of related cases that all change one or more aspects of the input model or modeling approximations. Because ARMI automates full-scope engineering analysis, ARMI-driven parameter sweeps are extremely useful for design exploration, sensitivity studies, and statistical analysis.</p>
<p>To get started with a parameter sweep, you first need some inputs.</p>
<ul class="simple">
<li><p><code class="xref download docutils literal notranslate"><span class="pre">Blueprints</span></code></p></li>
<li><p><code class="xref download docutils literal notranslate"><span class="pre">Settings</span></code></p></li>
<li><p><code class="xref download docutils literal notranslate"><span class="pre">Core</span> <span class="pre">map</span></code></p></li>
<li><p><code class="xref download docutils literal notranslate"><span class="pre">Fuel</span> <span class="pre">management</span></code></p></li>
</ul>
<p>Next, you need an app and a <code class="docutils literal notranslate"><span class="pre">Case</span></code> object as the starting point.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can only configure an app once</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">armi</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">armi</span><span class="o">.</span><span class="n">isConfigured</span><span class="p">():</span>
    <span class="n">armi</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">armi</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">App</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

       +===================================================+
       |            _      ____     __  __    ___          |
       |           / \    |  _ \   |  \/  |  |_ _|         |
       |          / _ \   | |_) |  | |\/| |   | |          |
       |         / ___ \  |  _ &lt;   | |  | |   | |          |
       |        /_/   \_\ |_| \_\  |_|  |_|  |___|         |
       |        Advanced  Reactor  Modeling Interface      |
       |                                                   |
       |                    version 0.5.1                  |
       |                                                   |
       +===================================================+
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">armi</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">armi</span><span class="w"> </span><span class="kn">import</span> <span class="n">cases</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">armi.cases</span><span class="w"> </span><span class="kn">import</span> <span class="n">suiteBuilder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">armi.cases.inputModifiers</span><span class="w"> </span><span class="kn">import</span> <span class="n">inputModifiers</span>

<span class="n">cs</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">Settings</span><span class="p">(</span><span class="s1">&#39;../anl-afci-177/anl-afci-177.yaml&#39;</span><span class="p">)</span>
<span class="n">case</span> <span class="o">=</span> <span class="n">cases</span><span class="o">.</span><span class="n">Case</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, you make a SuiteBuilder, which is the thing that will perturb the input files to generate a suite of related cases from the base case. There are two basic choices, the <code class="docutils literal notranslate"><span class="pre">FullFactorialSuiteBuilder</span></code> which will expand each degree of freedom in every combination (a full multi-dimensional matrix), and the <code class="docutils literal notranslate"><span class="pre">SeparateEffectsSuiteBuilder</span></code> builder, which varies each degree of freedom in isolation. We’ll make a FullFactorial case for this demo.</p>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">SuiteBuilder</span></code>, you start adding one or more degrees of freedom, each of which will adjust one aspect of the input definitions (modeling options, reactor design, etc.).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may also find the <a class="reference internal" href="../.apidocs/armi.cases.suiteBuilder.html#module-armi.cases.suiteBuilder" title="armi.cases.suiteBuilder"><code class="xref py py-mod docutils literal notranslate"><span class="pre">more</span> <span class="pre">detailed</span> <span class="pre">API</span> <span class="pre">documentation</span> <span class="pre">useful</span></code></a>.</p>
</div>
<section id="A-simple-one-dimensional-parameter-sweep">
<h2><span class="section-number">5.1. </span>A simple one-dimensional parameter sweep<a class="headerlink" href="#A-simple-one-dimensional-parameter-sweep" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">suiteBuilder</span><span class="o">.</span><span class="n">SeparateEffectsSuiteBuilder</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Each degree of freedom is defined by an <code class="docutils literal notranslate"><span class="pre">InputModifier</span></code> and a range of values. ARMI contains a few basic <code class="docutils literal notranslate"><span class="pre">InputModifier</span></code> for simple things (like changing settings), and for design-specific param sweeps you can make your own design-specific modifiers.</p>
<p>The simplest form of parameter sweep just adjusts settings. For example, we could adjust the reactor power from 10 MW to 100 MW in a few steps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building power modifiers with powers: </span><span class="si">{</span><span class="n">powers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">powerModifications</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputModifiers</span><span class="o">.</span><span class="n">SettingsModifier</span><span class="p">(</span><span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span> <span class="k">for</span> <span class="n">mw</span> <span class="ow">in</span> <span class="n">powers</span><span class="p">]</span>
<span class="n">builder</span><span class="o">.</span><span class="n">addDegreeOfFreedom</span><span class="p">(</span><span class="n">powerModifications</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">modifierSets</span><span class="p">)</span><span class="si">}</span><span class="s2"> cases in this suite so far.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Building power modifiers with powers: [ 10.  40.  70. 100.]
There are 4 cases in this suite so far.
</pre></div></div>
</div>
<p>Now we can build the suite. The <code class="docutils literal notranslate"><span class="pre">Suite</span></code> object itself can write input files or just run on the local computer with <code class="docutils literal notranslate"><span class="pre">suite.run</span></code>.</p>
<p>The suite will generate copies of the base case with the power modified across the defined range.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">suite</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">buildSuite</span><span class="p">()</span>
<span class="n">suite</span><span class="o">.</span><span class="n">echoConfiguration</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] No component matched Flags.CLAD in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt;. Returning None
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: A ENV GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: B ENV GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: C ENV GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[warn] Temperature 597.0 out of range (25 to 500) for B4C linear expansion percent
[warn] No component matched Flags.WIRE in &lt;radial shield block-bol-000 at ExCore XS: A ENV GP: A&gt;. Returning None
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[impt] Use the Python Tracer: False
[impt] Turn On the Profiler: False
[impt] Turn On Coverage Report Generation: False
[impt] Worker Log Verbosity: error
[impt] Module-Level Verbosity: {}
[impt] Primary Log Verbosity: info
[impt] Location of Output Cache:
[impt] Test inputs will be taken from test case results when they have finished
[impt] -----------------  ---------  --------------
       Title              Enabled    Dependencies
       -----------------  ---------  --------------
       anl-afci-177-0000  T
       anl-afci-177-0001  T
       anl-afci-177-0002  T
       anl-afci-177-0003  T
       -----------------  ---------  --------------
</pre></div></div>
</div>
<p>On the other hand, if you want to write inputs and then submit them all to a high-performance computer, you can do that too with <code class="docutils literal notranslate"><span class="pre">suite.writeInputs()</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">suite</span><span class="o">.</span><span class="n">writeInputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>You can now see that perturbed input files have been produced in the <code class="docutils literal notranslate"><span class="pre">case-suite</span></code> folder.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>grep<span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;power:&quot;</span><span class="w"> </span><span class="k">case</span>-suite/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
case-suite/0000/anl-afci-177-0000.yaml:  power: 10000000.0
case-suite/0001/anl-afci-177-0001.yaml:  power: 40000000.0
case-suite/0002/anl-afci-177-0002.yaml:  power: 70000000.0
case-suite/0003/anl-afci-177-0003.yaml:  power: 100000000.0
</pre></div></div>
</div>
<p>To submit this suite to a computer cluster, one would run a series of <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">armi</span> <span class="pre">run</span></code> commands from the <code class="docutils literal notranslate"><span class="pre">case-suite</span></code> folder. On a HPC, one would submit these commands to the HPC using the queuing system.</p>
</section>
<section id="Modifying-the-reactor-design">
<h2><span class="section-number">5.2. </span>Modifying the reactor design<a class="headerlink" href="#Modifying-the-reactor-design" title="Link to this heading"></a></h2>
<p>Modifying settings is one thing, but the real power of parameter sweeps comes from programmatically perturbing the reactor component designs themselves. We accomplish this by modifying ARMI Blueprint objects as derived from the base input.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CladThicknessModifier</span><span class="p">(</span><span class="n">inputModifiers</span><span class="o">.</span><span class="n">InputModifier</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Modifier that adjust the cladding outer diameter&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cs</span><span class="p">,</span> <span class="n">bp</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">blockDesign</span> <span class="ow">in</span> <span class="n">bp</span><span class="o">.</span><span class="n">blockDesigns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">componentDesign</span> <span class="ow">in</span> <span class="n">blockDesign</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">componentDesign</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;clad&quot;</span><span class="p">:</span>
                    <span class="c1"># by default, values passed to a modifier end up in the</span>
                    <span class="c1"># independentVariable dict</span>
                    <span class="n">componentDesign</span><span class="o">.</span><span class="n">od</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">independentVariable</span><span class="p">[</span><span class="s2">&quot;cladThickness&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">cs</span><span class="p">,</span> <span class="n">bp</span>

<span class="n">cladThicknesses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">builder</span> <span class="o">=</span> <span class="n">suiteBuilder</span><span class="o">.</span><span class="n">SeparateEffectsSuiteBuilder</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
<span class="n">cladModifications</span> <span class="o">=</span> <span class="p">[</span><span class="n">CladThicknessModifier</span><span class="p">({</span><span class="s2">&quot;cladThickness&quot;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">od</span><span class="p">)})</span> <span class="k">for</span> <span class="n">od</span> <span class="ow">in</span> <span class="n">cladThicknesses</span><span class="p">]</span>
<span class="n">builder</span><span class="o">.</span><span class="n">addDegreeOfFreedom</span><span class="p">(</span><span class="n">cladModifications</span><span class="p">)</span>
<span class="n">suite</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">buildSuite</span><span class="p">()</span>
<span class="n">suite</span><span class="o">.</span><span class="n">echoConfiguration</span><span class="p">()</span>
<span class="n">suite</span><span class="o">.</span><span class="n">writeInputs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Will expand HE, NA, SI, V, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A ENV GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[impt] Use the Python Tracer: False
[impt] Turn On the Profiler: False
[impt] Turn On Coverage Report Generation: False
[impt] Worker Log Verbosity: error
[impt] Module-Level Verbosity: {}
[impt] Primary Log Verbosity: info
[impt] Location of Output Cache:
[impt] Test inputs will be taken from test case results when they have finished
[impt] -----------------  ---------  --------------
       Title              Enabled    Dependencies
       -----------------  ---------  --------------
       anl-afci-177-0000  T
       anl-afci-177-0001  T
       anl-afci-177-0002  T
       anl-afci-177-0003  T
       anl-afci-177-0004  T
       -----------------  ---------  --------------
</pre></div></div>
</div>
<p>Now we can inspect the input files and see that the cladding outer diameter definition has indeed been modified</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>grep<span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;clad:&quot;</span><span class="w"> </span>-A6<span class="w"> </span><span class="k">case</span>-suite/*<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;od:&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
case-suite/0000/anl-afci-177-0000-blueprints.yaml-      od: 0.8
case-suite/0000/anl-afci-177-0000-blueprints.yaml-      od: 0.8
case-suite/0001/anl-afci-177-0001-blueprints.yaml-      od: 0.8250000000000001
case-suite/0001/anl-afci-177-0001-blueprints.yaml-      od: 0.8250000000000001
case-suite/0002/anl-afci-177-0002-blueprints.yaml-      od: 0.8500000000000001
case-suite/0002/anl-afci-177-0002-blueprints.yaml-      od: 0.8500000000000001
case-suite/0003/anl-afci-177-0003-blueprints.yaml-      od: 0.875
case-suite/0003/anl-afci-177-0003-blueprints.yaml-      od: 0.875
case-suite/0004/anl-afci-177-0004-blueprints.yaml-      od: 0.9
case-suite/0004/anl-afci-177-0004-blueprints.yaml-      od: 0.9
</pre></div></div>
</div>
</section>
<section id="A-full-factorial-parameter-sweep">
<h2><span class="section-number">5.3. </span>A full factorial parameter sweep<a class="headerlink" href="#A-full-factorial-parameter-sweep" title="Link to this heading"></a></h2>
<p>Of course, one can use factorial sweeps as well. Below we add two degrees of freedom, one of length 5 and another of length 20. This suite has 100 cases total with all combinations of each setting.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">suiteBuilder</span><span class="o">.</span><span class="n">FullFactorialSuiteBuilder</span><span class="p">(</span><span class="n">case</span><span class="p">)</span>
<span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">powerModifications</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputModifiers</span><span class="o">.</span><span class="n">SettingsModifier</span><span class="p">(</span><span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="n">mw</span><span class="o">*</span><span class="mf">1e6</span><span class="p">)</span> <span class="k">for</span> <span class="n">mw</span> <span class="ow">in</span> <span class="n">powers</span><span class="p">]</span>
<span class="n">builder</span><span class="o">.</span><span class="n">addDegreeOfFreedom</span><span class="p">(</span><span class="n">powerModifications</span><span class="p">)</span>

<span class="n">cycleLengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">cycleLengthMods</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputModifiers</span><span class="o">.</span><span class="n">SettingsModifier</span><span class="p">(</span><span class="s1">&#39;cycleLength&#39;</span><span class="p">,</span> <span class="n">cL</span><span class="p">)</span> <span class="k">for</span> <span class="n">cL</span> <span class="ow">in</span> <span class="n">cycleLengths</span><span class="p">]</span>
<span class="n">builder</span><span class="o">.</span><span class="n">addDegreeOfFreedom</span><span class="p">(</span><span class="n">cycleLengthMods</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">modifierSets</span><span class="p">)</span><span class="si">}</span><span class="s2"> cases in this suite.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There are 100 cases in this suite.
</pre></div></div>
</div>
</section>
<section id="Post-processing-the-results-of-the-sweep">
<h2><span class="section-number">5.4. </span>Post-processing the results of the sweep<a class="headerlink" href="#Post-processing-the-results-of-the-sweep" title="Link to this heading"></a></h2>
<p>After all the runs have completed in a parameter sweep, you will want to post-process them to come to some kind of useful conclusion. Because post-processing is very design-specific, you need to make a simple post-processing script. The ARMI framework has useful functions that will assist you in this task.</p>
<p>First, we assume you’re in a new shell and we discover all the cases that ran:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">loadSuite</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading suite results...&#39;</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">Settings</span><span class="p">(</span><span class="s1">&#39;../anl-afci-177/anl-afci-177.yaml&#39;</span><span class="p">)</span>
    <span class="n">suite</span> <span class="o">=</span> <span class="n">cases</span><span class="o">.</span><span class="n">CaseSuite</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
    <span class="n">suite</span><span class="o">.</span><span class="n">discover</span><span class="p">(</span><span class="n">patterns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;anl-afci-177-????.yaml&quot;</span><span class="p">])</span>
    <span class="n">suite</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">suite</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">inputDirectory</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">suite</span>
<span class="n">suite</span> <span class="o">=</span> <span class="n">loadSuite</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading suite results...
[info] Finding potential settings files matching [&#39;anl-afci-177-????.yaml&#39;].
[info] Checking for valid settings files.
=========== Settings Validation Checks ===========
=========== Settings Validation Checks ===========
=========== Settings Validation Checks ===========
=========== Settings Validation Checks ===========
=========== Settings Validation Checks ===========
</pre></div></div>
</div>
<p>At this point, you have two options based on your needs:</p>
<ul class="simple">
<li><p>Read the ARMI HDF5 output databases directly (useful if you just need to pull certain scalar parameters directly out of the database)</p></li>
<li><p>Have ARMI load HDF5 output databases into full ARMI reactor objects and use the ARMI API to extract data (useful if you want to loop over certain parts of the plant to sum things up)</p></li>
</ul>
<p>Directly reading the database will be inherently less stable (e.g. in case the underlying DB format changes), but can be very fast. Loading ARMI reactors for each case is slower, but should also be more powerful and more stable.</p>
<p>After you extract the data, you can plot it or make tables or anything else you need. We often pass it to non-parametric regression systems like the <a class="reference external" href="https://github.com/partofthething/ace">Alternating Conditional Expectation</a> (ACE) and then on to a multi-objective optimization system (like <a class="reference external" href="https://github.com/partofthething/physprog">Physical Programming</a>).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="making_your_first_app.html" class="btn btn-neutral float-left" title="4. Making your first ARMI-based App" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../release/index.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2025, TerraPower, LLC.
      <span class="lastupdated">Last updated on 2025-05-20.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>