

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta property="og:title" content="5. Hands-on at the ARMI Terminal" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://terrapower.github.io/armi/tutorials/data_model.html" />
  <meta property="og:site_name" content="Advanced Reactor Modeling Interface" />
  <meta property="og:description" content="This tutorial will walk you through some exploration with ARMI on the command line with the goal of exposing you to some of the capabilities and organization of information in the ARMI system. Init..." />
  <meta property="og:image" content="https://terrapower.github.io/armi/_static/armiSchematicView.png" />
  <meta property="og:image:alt" content="Advanced Reactor Modeling Interface" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5. Hands-on at the ARMI Terminal &mdash; ARMI 0.2.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_fixes.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/armiicon_16x16.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/assets/jsonview.bundle.js"></script>
        <script src="../_static/assets/jsonview_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables.min.js"></script>
        <script src="../_static/sphinx-needs/libs/html/datatables_loader.js"></script>
        <script src="../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Making your first ARMI-based App" href="making_your_first_app.html" />
    <link rel="prev" title="4. Building input files for a thermal reactor" href="walkthrough_lwr_inputs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #233C5B" >
          

          
            <a href="../index.html" class="icon icon-home"> ARMI
          

          
            
            <img src="../_static/armiicon_24x24.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nuclide_demo.html">1. The ARMI Nuclide and Element Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="materials_demo.html">2. The ARMI Material Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="walkthrough_inputs.html">3. Building input files for a fast reactor</a></li>
<li class="toctree-l2"><a class="reference internal" href="walkthrough_lwr_inputs.html">4. Building input files for a thermal reactor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5. Hands-on at the ARMI Terminal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Initializing-and-Exploring-the-ARMI-Model">5.1. Initializing and Exploring the ARMI Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Exploring-the-state-of-the-reactor">5.2. Exploring the <em>state</em> of the reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Modifying-the-state-of-the-reactor">5.3. Modifying the state of the reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Modifying-number-densities">5.4. Modifying number densities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Saving-state-to-disk">5.5. Saving state to disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Fuel-management">5.6. Fuel management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Loading-from-the-database">5.7. Loading from the database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="making_your_first_app.html">6. Making your first ARMI-based App</a></li>
<li class="toctree-l2"><a class="reference internal" href="param_sweep.html">7. Parameter sweeps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements/index.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../.apidocs/modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ARMI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Hands-on at the ARMI Terminal</li>
    
    
  <li class="wy-breadcrumbs-aside">
    
      
    
  </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Hands-on-at-the-ARMI-Terminal">
<h1><span class="section-number">5. </span>Hands-on at the ARMI Terminal<a class="headerlink" href="#Hands-on-at-the-ARMI-Terminal" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will walk you through some exploration with ARMI on the command line with the goal of exposing you to some of the capabilities and organization of information in the ARMI system.</p>
<div class="section" id="Initializing-and-Exploring-the-ARMI-Model">
<h2><span class="section-number">5.1. </span>Initializing and Exploring the ARMI Model<a class="headerlink" href="#Initializing-and-Exploring-the-ARMI-Model" title="Permalink to this headline">¶</a></h2>
<p>First we need to get some inputs. We built some from scratch in <a class="reference external" href="walkthrough_inputs.html">Building input files for a fast reactor</a> and we pick those up and use them here as well:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/d8fa61001ab140ffa761c8f7d29f1884/anl-afci-177-blueprints.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Blueprints</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/112f8b8914837219e97641ef68a02a73/anl-afci-177.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Settings</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/735a3ff7c198d960411ed4194fc12c03/anl-afci-177-coreMap.yaml"><code class="xref download docutils literal notranslate"><span class="pre">Core</span> <span class="pre">map</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/d661bbdfd419763f7462f13a6a452f7c/anl-afci-177-fuelManagement.py"><code class="xref download docutils literal notranslate"><span class="pre">Fuel</span> <span class="pre">management</span></code></a></p></li>
</ul>
<p>You can load these inputs using armi’s <code class="docutils literal notranslate"><span class="pre">init</span></code> function. This will build an <strong>Operator</strong>, a <strong>Reactor</strong>, and an <strong>Interface Stack</strong> full of various interfaces.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># you can only configure an app once
import armi
if not armi.isConfigured():
    armi.configure(armi.apps.App())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Failed to import psutil; MemoryProfiler will not provide meaningful data.

       +===================================================+
       |            _      ____     __  __    ___          |
       |           / \    |  _ \   |  \/  |  |_ _|         |
       |          / _ \   | |_) |  | |\/| |   | |          |
       |         / ___ \  |  _ &lt;   | |  | |   | |          |
       |        /_/   \_\ |_| \_\  |_|  |_|  |___|         |
       |        Advanced  Reactor  Modeling Interface      |
       |                                                   |
       |                    version 0.2.5                  |
       |                                                   |
       +===================================================+
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>o=armi.init(fName=&quot;anl-afci-177.yaml&quot;);
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
=========== Settings Validation Checks ===========
=========== Case Information ===========
[info] ---------------------  ------------------------------------------------------------
       Case Title:            anl-afci-177
       Case Description:      ANL-AFCI-177 CR 1.0 metal core but with HALEU instead of TRU
       Run Type:              Standard - Operator
       Current User:          armi
       ARMI Location:         /home/runner/work/armi/armi/armi
       Working Directory:     /home/runner/work/armi/armi/doc/tutorials
       Python Interpreter:    3.9.16 (main, Dec  8 2022, 11:01:53)
                              [GCC 11.3.0]
       Master Machine:        ?
       Number of Processors:  1
       Date and Time:         Wed Dec 28 00:23:44 2022
       ---------------------  ------------------------------------------------------------
=========== Input File Information ===========
[info] --------------------------------------------------------------------  ------------------------------  ------------
       Input Type                                                            Path                            SHA-1 Hash
       --------------------------------------------------------------------  ------------------------------  ------------
       Case Settings                                                         anl-afci-177.yaml               5e5875c322
       Blueprints                                                            anl-afci-177-blueprints.yaml    04761fb2b3
       Included blueprints                                                   anl-afci-177-coreMap.yaml       5904530cb2
       Geometry                                                                                              MISSING
       &lt;Setting shuffleLogic value:anl-afci-177-fuelManagement.py default:&gt;  anl-afci-177-fuelManagement.py  622957b035
       --------------------------------------------------------------------  ------------------------------  ------------
=========== Reactor Cycle Information ===========
[info] ---------------------------  -----------------------------------------------------------------
       Reactor Thermal Power (MW):  1000.0
       Number of Cycles:            10
       Cycle Lengths:               411.11, 411.11, 411.11, 411.11, 411.11, 411.11, 411.11, 411.11,
                                    411.11, 411.11
       Availability Factors:        0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9
       Power Fractions:             [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0,
                                    1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]
       Step Lengths (days):         [184.9995, 184.9995], [184.9995, 184.9995], [184.9995, 184.9995],
                                    [184.9995, 184.9995], [184.9995, 184.9995], [184.9995, 184.9995],
                                    [184.9995, 184.9995], [184.9995, 184.9995], [184.9995, 184.9995],
                                    [184.9995, 184.9995]
       ---------------------------  -----------------------------------------------------------------
=========== Constructing Reactor and Verifying Inputs ===========
[info] Constructing the `core`
=========== Adding Assemblies to &lt;Core: core id:139954847107728&gt; ===========
[info] Will expand HE, NA, SI, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Nuclides truncating the burn-chain:  LFP35, LFP38, LFP41, LFP40, LFP39, DUMP2, DUMP1
[info] Constructing assembly `inner fuel`
[warn] No component matched Flags.CLAD in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt;. Returning None
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt; so pin-to-duct gap not calculated
[warn] Cannot get pin pitch in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt; because it does not have a wire and a clad
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: A BU GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B BU GP: A&gt; so pin-to-duct gap not calculated
[warn] Cannot get pin pitch in &lt;reflector block-bol-000 at ExCore XS: B BU GP: A&gt; because it does not have a wire and a clad
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: B BU GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C BU GP: A&gt; so pin-to-duct gap not calculated
[warn] Cannot get pin pitch in &lt;reflector block-bol-000 at ExCore XS: C BU GP: A&gt; because it does not have a wire and a clad
[warn] The gap between wire wrap and clad in block &lt;plenum block-bol-006 at ExCore XS: C BU GP: A&gt; was 3.999999999998449e-05 cm. Expected 0.0.
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[warn] Temperature 597.0 out of range (25 to 500) for B4C linear expansion percent
[warn] No component matched Flags.WIRE in &lt;radial shield block-bol-000 at ExCore XS: A BU GP: A&gt;. Returning None
[warn] Cannot get pin pitch in &lt;radial shield block-bol-000 at ExCore XS: A BU GP: A&gt; because it does not have a wire and a clad
[info] Constructing assembly `control`
[warn] Could not create a spatialGrid for block control, multiplicities are not 1 or N they are {1.0}
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
=========== Summarizing Source of Material Data for &lt;Core: core id:139954847107728&gt; ===========
[info] ---------------  -----------------  ----------------------------
       Material Name    Source Location    Property Data was Modified
                                           from the Source?
       ---------------  -----------------  ----------------------------
       B4C              ARMI               False
       HT9              ARMI               False
       Sodium           ARMI               False
       UZr              ARMI               False
       Void             ARMI               False
       ---------------  -----------------  ----------------------------
=========== Applying Geometry Modifications ===========
[info] Resetting the state of the converted reactor core model in &lt;EdgeAssemblyChanger&gt;
[info] Updating spatial grid pitch data for hex geometry
=========== Initializing Mesh, Assembly Zones, and Nuclide Categories ===========
[info] Nuclide categorization for cross section temperature assignments:
       ------------------  ------------------------------------------------------------
       Nuclide Category    Nuclides
       ------------------  ------------------------------------------------------------
       Fuel                AM241, CM243, ZR90, PU242, CM242, DUMP1, LFP35, ZR92, LFP38,
                           LFP41, ZR94, DUMP2, U238, CM244, LFP40, AM243, PU239, CM247,
                           U234, PU240, U236, NP238, AM242M, ZR96, PU241, U235,
                           NP237, LFP39, CM245, HE4, CM246, ZR91, PU238, PU236
       Coolant             NA23
       Structure           SI28, FE54, MO92, MO94, FE58, NI60, C, B10,
                           B11, NI58, NI62, W183, FE56, CR54, MO96, CR50,
                           CR52, W184, W186, MO98, W182, FE57, NI61, SI29,
                           MO95, MO97, CR53, MO100, NI64, MN55, V, SI30
       ------------------  ------------------------------------------------------------
=========== Interface Stack Summary  ===========
[info] -------  ------------------------  ---------------  ----------  ---------  -----------  ------------
         Index  Type                      Name             Function    Enabled    EOL order    BOL forced
       -------  ------------------------  ---------------  ----------  ---------  -----------  ------------
            01  Main                      main                         Yes        Reversed     No
            02  FissionProductModel       fissionProducts              Yes        Normal       No
            03  CrossSectionGroupManager  xsGroups                     Yes        Normal       No
            04  FuelHandler               fuelHandler                  Yes        Normal       No
            05  HistoryTracker            history                      Yes        Normal       No
            06  Report                    report                       Yes        Normal       No
            07  Database                  database                     Yes        Normal       No
            08  MemoryProfiler            memoryProfiler               Yes        Normal       No
            09  Snapshot                  snapshot                     Yes        Normal       No
       -------  ------------------------  ---------------  ----------  ---------  -----------  ------------
===========  Triggering Init Event ===========
=========== 01 - main                           Init            ===========
=========== 02 - fissionProducts                Init            ===========
=========== 03 - xsGroups                       Init            ===========
=========== 04 - fuelHandler                    Init            ===========
=========== 05 - history                        Init            ===========
=========== 06 - report                         Init            ===========
=========== 07 - database                       Init            ===========
=========== 08 - memoryProfiler                 Init            ===========
=========== 09 - snapshot                       Init            ===========
===========  Completed Init Event ===========
</pre></div></div>
</div>
<p>You have now created an <code class="docutils literal notranslate"><span class="pre">operator</span></code> object, which contains a <code class="docutils literal notranslate"><span class="pre">Reactor</span></code> object (called <code class="docutils literal notranslate"><span class="pre">o.r</span></code>) that
represents the beginning-of-life (BOL) state of the nuclear reactor defined in the inputs. The reactor looks
like this:</p>
<div class="figure align-center" id="id1">
<img alt="../_images/armi_reactor_objects.png" src="../_images/armi_reactor_objects.png" />
<p class="caption"><span class="caption-text"><strong>Figure 1.</strong> The primary data containers in ARMI</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The data hierarchy in an ARMI model often is made up of:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../.apidocs/armi.reactor.reactors.html#module-armi.reactor.reactors" title="armi.reactor.reactors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Reactors</span></code></a>, often named <code class="docutils literal notranslate"><span class="pre">reactor</span></code> or <code class="docutils literal notranslate"><span class="pre">r</span></code> contain a Core and possibly other equipment. They represent collections of assemblies.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.reactor.assemblies.html#module-armi.reactor.assemblies" title="armi.reactor.assemblies"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Assemblies</span></code></a>, often named <code class="docutils literal notranslate"><span class="pre">assembly</span></code> or <code class="docutils literal notranslate"><span class="pre">a</span></code>, are individual pieces that collect into a System.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.reactor.blocks.html#module-armi.reactor.blocks" title="armi.reactor.blocks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Blocks</span></code></a>, often called <code class="docutils literal notranslate"><span class="pre">block</span></code> or <code class="docutils literal notranslate"><span class="pre">b</span></code> are divisions of the assemblies into sections one on top of the other.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.reactor.components.html#module-armi.reactor.components" title="armi.reactor.components"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Components</span></code></a> The geometrically defined objects (Circles, Hexagons, Helices, Dodecagons) and their dimensions.</p></li>
<li><p><a class="reference internal" href="../.apidocs/armi.materials.html#module-armi.materials" title="armi.materials"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Materials</span></code></a> are objects which have material properties like linear expansion coefficients, thermal conductivities, isotopic mass fractions, and densities.</p></li>
</ul>
<p>Each of these objects house more than the listed objects, they also are responsible for a variety of state information
like the reactor’s overall keff, flux, height, temperature, etc. In this section, we will explore these objects,
see how to access them, and how to view their contained information.</p>
<p>Exploring it a little, we can list all the assemblies in the reactor with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>core = o.r.core
core.getAssemblies()[:25] # only print the first 25
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;radial shield Assembly A0012 at 011-056&gt;,
 &lt;radial reflector Assembly A0011 at 009-045&gt;,
 &lt;radial reflector Assembly A0017 at 010-051&gt;,
 &lt;radial shield Assembly A0023 at 011-057&gt;,
 &lt;control Assembly A0010 at 007-034&gt;,
 &lt;outer core fuel Assembly A0016 at 008-040&gt;,
 &lt;radial reflector Assembly A0022 at 009-046&gt;,
 &lt;radial reflector Assembly A0028 at 010-052&gt;,
 &lt;radial shield Assembly A0034 at 011-058&gt;,
 &lt;middle core fuel Assembly A0009 at 005-023&gt;,
 &lt;middle core fuel Assembly A0015 at 006-029&gt;,
 &lt;outer core fuel Assembly A0021 at 007-035&gt;,
 &lt;outer core fuel Assembly A0027 at 008-041&gt;,
 &lt;radial reflector Assembly A0033 at 009-047&gt;,
 &lt;radial reflector Assembly A0040 at 010-053&gt;,
 &lt;radial shield Assembly A0046 at 011-059&gt;,
 &lt;inner fuel Assembly A0008 at 003-012&gt;,
 &lt;middle core fuel Assembly A0014 at 004-018&gt;,
 &lt;middle core fuel Assembly A0020 at 005-024&gt;,
 &lt;middle core fuel Assembly A0026 at 006-030&gt;,
 &lt;outer core fuel Assembly A0032 at 007-036&gt;,
 &lt;outer core fuel Assembly A0039 at 008-042&gt;,
 &lt;radial reflector Assembly A0045 at 009-048&gt;,
 &lt;radial shield Assembly A0052 at 010-054&gt;,
 &lt;inner fuel Assembly A0007 at 001-001&gt;]
</pre></div></div>
</div>
<div class="admonition-quiz-question-1 admonition">
<p class="admonition-title">Quiz Question 1</p>
<p>How many assemblies does the model have? (see answers at bottom)</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A reactor is made up of assemblies, which are made up of blocks, and so on. Each composite ARMI
object has a <code class="docutils literal notranslate"><span class="pre">getChildren</span></code> method that will retrieve a list of its contents. For clarity,
reactors have a <code class="docutils literal notranslate"><span class="pre">getAssemblies()</span></code> method and assemblies have a <code class="docutils literal notranslate"><span class="pre">getBlocks()</span></code> method,
but these do exactly the same thing as <code class="docutils literal notranslate"><span class="pre">getChildren()</span></code> in both cases.</p>
<p>Reactor, assembly, blocks, etc. objects act like lists as well, so you can get the fifth
assembly out of a reactor just like you’d get the fifth item out of any other list
(don’t forget that Python uses <a class="reference external" href="http://en.wikipedia.org/wiki/Zero-based_numbering">zero-based numbering</a>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; fifthAssem = core[4]
</pre></div>
</div>
</div>
<p>You can drill down the hierarchy for a particular assembly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>core = o.r[0]
print(core)
assem = core[1]
print(assem)
block = assem[5]
print(block)
print(f&quot;Block&#39;s parent is: {block.parent}&quot;)
components = block.getChildren()
print(components)
material = components[0].material
print(material)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Core: core id:139954847107728&gt;
&lt;inner fuel Assembly A0008 at 003-012&gt;
&lt;fuel B0008-005 at 003-012-005 XS: A BU GP: A&gt;
Block&#39;s parent is: &lt;inner fuel Assembly A0008 at 003-012&gt;
[&lt;Circle: clad&gt;, &lt;Helix: wire&gt;, &lt;Circle: fuel&gt;, &lt;Circle: bond&gt;, &lt;Hexagon: duct&gt;, &lt;Hexagon: intercoolant&gt;, &lt;DerivedShape: coolant&gt;]
&lt;Material: HT9&gt;
</pre></div></div>
</div>
</div>
<div class="section" id="Exploring-the-state-of-the-reactor">
<h2><span class="section-number">5.2. </span>Exploring the <em>state</em> of the reactor<a class="headerlink" href="#Exploring-the-state-of-the-reactor" title="Permalink to this headline">¶</a></h2>
<p>State can be explored using a variety of framework methods, as well as looking at state <em>parameters</em>. Let’s first try out some methods to find out how much U-235 is in the model and what the average uranium enrichment is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>u235 = core.getMass(&#39;U235&#39;)
u238 = core.getMass(&#39;U238&#39;)
print(f&quot;The core contains {u235} grams of U-235&quot;)
print(f&quot;The average fissile enrichment is {u235/(u235+u238)}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The core contains 913110.7780886305 grams of U-235
The average fissile enrichment is 0.16152980132450329
</pre></div></div>
</div>
<p>That’s how much U-235 is in the 1/3 core. If we want the total mass (including all nuclides), we can just leave the argument out:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>core.getMass()/1.e6
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
27.630279585150177
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>core.getMass?
</pre></div>
</div>
</div>
<p>Furthermore, you can get a list of available methods by pressing the tab key. Try <code class="docutils literal notranslate"><span class="pre">core.</span></code> followed by <code class="docutils literal notranslate"><span class="pre">[Tab]</span></code>. Try out some options!</p>
<p>Use tab completion to explore other methods of ARMI reactors assemblies and blocks. You can
view a summary of the methods of any object in the <a class="reference internal" href="../py-modindex.html"><span class="std std-ref">API documentation</span></a>.
For a good example, see <a class="reference internal" href="../.apidocs/armi.reactor.blocks.html#armi.reactor.blocks.Block" title="armi.reactor.blocks.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">the</span> <span class="pre">API</span> <span class="pre">docs</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">block</span></code></a>.</p>
<p>Next, lets find out what the number density of U235 is in a particular fuel block. We’ll use the <em>FLAGS</em> system to select a particular type of block (in this case, a fuel block):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from armi.reactor.flags import Flags
b = core.getFirstBlock(Flags.FUEL)
print(f&quot;U-235 ndens: {b.getNumberDensity(&#39;U235&#39;):.4e} (atoms/bn-cm)&quot;)
print(f&quot;Block name: {b.getName()}&quot;)
print(f&quot;Block type: {b.getType()}&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
U-235 ndens: 2.2592e-03 (atoms/bn-cm)
Block name: B0016-001
Block type: fuel
</pre></div></div>
</div>
<p>You can find lots of other details about this block with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>b.printContents(includeNuclides=False)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[impt] &lt;fuel B0016-001 at 008-040-001 XS: C BU GP: A&gt;
[impt] &lt;Circle: clad&gt;
[impt] ---------------------------------------------------------------------------------------------
       Cladding Dimensions -  Of First Fuel Block
                                      Tcold (25.0)                   Thot (450.0)
       ---------------------------------------------------------------------------------------------
       Inner Diameter (cm)            0.6962                         0.6996347645979837
       Material                       HT9
       Multiplicity                   271                            271
       Name                           clad
       Outer Diameter (cm)            0.808                          0.8119863398379357
       Thickness (cm)                 0.0559000                      0.0561758
[impt] &lt;Helix: wire&gt;
[impt] ---------------------------------------------------------------------------------------------
       Wire Dimensions -  Of First Fuel Block
                                      Tcold (25.0)                   Thot (450.0)
       ---------------------------------------------------------------------------------------------
       Axial Pitch (cm)               30.0                           30.148007667250084
       Helix Diameter (cm)            0.8888                         0.8931849738217292
       Inner Diameter (cm)            0.0                            0.0
       Material                       HT9
       Multiplicity                   271                            271
       Name                           wire
       Outer Diameter (cm)            0.0808                         0.08119863398379355
[impt] &lt;Circle: fuel&gt;
[impt] ---------------------------------------------------------------------------------------------
       Fuel Dimensions -  Of First Fuel Block
                                      Tcold (25.0)                   Thot (500.0)
       ---------------------------------------------------------------------------------------------
       Inner Diameter (cm)            0.0                            0.0
       Material                       UZr
       Multiplicity                   271                            271
       Name                           fuel
       Outer Diameter (cm)            0.6029                         0.6086118601525807
[impt] &lt;Circle: bond&gt;
[impt] ---------------------------------------------------------------------------------------------
       Bond Dimensions -  Of First Fuel Block
                                      Tcold (447.0)                  Thot (447.0)
       ---------------------------------------------------------------------------------------------
       Inner Diameter (cm)            0.6029                         0.6086118601525807
       Material                       Sodium
       Multiplicity                   271                            271
       Name                           bond
       Outer Diameter (cm)            0.6962                         0.6996347645979837
       Thickness (cm)                 0.0466500                      0.0455115
[impt] &lt;Hexagon: duct&gt;
[impt] ---------------------------------------------------------------------------------------------
       Duct Dimensions -  Of First Fuel Block
                                      Tcold (25.0)                   Thot (450.0)
       ---------------------------------------------------------------------------------------------
       Inner Pitch (cm)               14.922                         14.995619013690193
       Material                       HT9
       Multiplicity                   1.0                            1.0
       Name                           duct
       Outer Pitch (cm)               15.71                          15.787506681749962
       Thickness (cm)                 0.3940000                      0.3959438
[impt] &lt;Hexagon: intercoolant&gt;
[impt] ---------------------------------------------------------------------------------------------
       Intercoolant Dimensions -  Of First Fuel Block
                                      Tcold (450.0)                  Thot (450.0)
       ---------------------------------------------------------------------------------------------
       Inner Pitch (cm)               15.71                          15.787506681749962
       Material                       Sodium
       Multiplicity                   1.0                            1.0
       Name                           intercoolant
       Outer Pitch (cm)               16.142                         16.142
       Thickness (cm)                 0.2160000                      0.1772467
[impt] &lt;DerivedShape: coolant&gt;
[impt] ---------------------------------------------------------------------------------------------
       Coolant Dimensions -  Of First Fuel Block
                                      Tcold (450.0)                  Thot (450.0)
       ---------------------------------------------------------------------------------------------
       Material                       Sodium
       Name                           coolant
</pre></div></div>
</div>
</div>
<div class="section" id="Modifying-the-state-of-the-reactor">
<h2><span class="section-number">5.3. </span>Modifying the state of the reactor<a class="headerlink" href="#Modifying-the-state-of-the-reactor" title="Permalink to this headline">¶</a></h2>
<p>Each object in the Reactor model has a bunch of <em>state parameters</em> contained in its special <code class="docutils literal notranslate"><span class="pre">.p</span></code> attribute, called its <em>Parameter Collection</em>. The state parameters are defined both by the ARMI framework and the collection of plugins. For instance, you can look at the core’s keff parameters or each individual block’s power and multi-group flux parameters like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(b.p.power)
print(core.p.keff)
print(b.p.mgFlux)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
0.0
None
</pre></div></div>
</div>
<p>As you might expect, the values are zero because we have not performed any physics calculations yet. We could run a physics plugin at this point to add physics state, but for this tutorial, we’ll just apply dummy data. Here’s a fake physics kernel that just sets a power distribution based on spatial location of each block (e.g. a spherical distribution):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
midplane = core[0].getHeight()/2.0
center = np.array([0,0,midplane])
peakPower = 1e6
mgFluxBase = np.arange(5)
def setFakePower(core):
    for a in core:
        for b in a:
            vol = b.getVolume()
            coords = b.spatialLocator.getGlobalCoordinates()
            r = np.linalg.norm(abs(coords-center))
            fuelFlag = 10 if b.isFuel() else 1.0
            b.p.power = peakPower / r**2 * fuelFlag
            b.p.pdens = b.p.power/vol
            b.p.mgFlux = mgFluxBase*b.p.pdens
setFakePower(core)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(b.p.power)
print(b.p.pdens)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
381.5754294076418
0.08321687067850306
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
a = b.parent
z = [b.spatialLocator.getGlobalCoordinates()[2] for b in a]
power = a.getChildParamValues(&#39;power&#39;)
plt.plot(z,power,&#39;.-&#39;)
plt.title(&quot;Fake power distribution on reactor&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Fake power distribution on reactor&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_data_model_27_1.png" src="../_images/tutorials_data_model_27_1.png" />
</div>
</div>
<p>We can take a look at the spatial distribution as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from armi.utils import plotting
# Note, if you were plotting outside jupyter, you could click
# on different depths at the bottom to view different axial planes.
plotting.plotBlockDepthMap(core, &quot;power&quot;, depthIndex=5)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_data_model_29_0.png" src="../_images/tutorials_data_model_29_0.png" />
</div>
</div>
</div>
<div class="section" id="Modifying-number-densities">
<h2><span class="section-number">5.4. </span>Modifying number densities<a class="headerlink" href="#Modifying-number-densities" title="Permalink to this headline">¶</a></h2>
<p>Analysts frequently want to modify number densities. For example, if you needed to compute a coolant density coefficient, you could simply reduce the amount of coolant in the core.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sodiumBefore = core.getMass(&#39;NA&#39;)
print(f&quot;Before: {sodiumBefore/1e6:.2f} MT Sodium&quot;)
for b in core.getBlocks():      # loop through all blocks
    refDens = b.getNumberDensity(&#39;NA23&#39;)
    b.setNumberDensity(&#39;NA23&#39;,refDens*0.98) # reduce Na density by 2%
sodiumAfter = core.getMass(&#39;NA&#39;)
print(f&quot;After:  {sodiumAfter/1e6:.2f} MT Sodium&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Before: 2.48 MT Sodium
After:  2.43 MT Sodium
</pre></div></div>
</div>
<p>If you analyze the keff with a physics plugin before and after, the change in the <code class="docutils literal notranslate"><span class="pre">core.p.keff</span></code> param would determine your density coefficient of reactivity.</p>
</div>
<div class="section" id="Saving-state-to-disk">
<h2><span class="section-number">5.5. </span>Saving state to disk<a class="headerlink" href="#Saving-state-to-disk" title="Permalink to this headline">¶</a></h2>
<p>During analysis, it’s often useful to save the reactor state to disk in a database. The ARMI database package handles this, and writes it out to an <a class="reference external" href="https://en.wikipedia.org/wiki/Hierarchical_Data_Format">HDF-formatted</a> file. This is typically done automatically at each point in time in a normal simulation, and can also be done manually, like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dbi = o.getInterface(&quot;database&quot;)
dbi.initDB()
dbi.database.writeToDB(o.r)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[info] Opening database file at /home/runner/.armi/0-20221228002346186103/anl-afci-177.h5
[info] Writing to database for statepoint: /c00n00
</pre></div></div>
</div>
</div>
<div class="section" id="Fuel-management">
<h2><span class="section-number">5.6. </span>Fuel management<a class="headerlink" href="#Fuel-management" title="Permalink to this headline">¶</a></h2>
<p>One plugin that comes with the framework is the Fuel Handler. It attaches the Fuel Handler interface, which we can grab now to move fuel around. In a typical ARMI run, the detailed fuel management choices are specified by the user-input custom shuffle logic file. In this particular example, we will simply swap the 10 highest-power fuel assemblies with the 10 lowest-power ones.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from armi.physics.fuelCycle import fuelHandlers
fh = fuelHandlers.fuelHandlerFactory(o)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>moved = []
for n in range(10):
    high = fh.findAssembly(param=&quot;power&quot;, compareTo=1.0e6, blockLevelMax=True, exclusions=moved)
    low = fh.findAssembly(param=&quot;power&quot;, compareTo=0.0, blockLevelMax=True, exclusions=moved)
    fh.swapAssemblies(high, low)
    moved.extend([high, low])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plotting.plotBlockDepthMap(core, &quot;power&quot;, depthIndex=5)
# You can also plot total assembly params, which are the sum of block params
plotting.plotFaceMap(core, &quot;power&quot;, vals=&#39;sum&#39;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_data_model_37_0.png" src="../_images/tutorials_data_model_37_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_data_model_37_1.png" src="../_images/tutorials_data_model_37_1.png" />
</div>
</div>
<p>We can write this new state to DB as well, since we’ve shuffled the fuel</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>o.r.p.timeNode +=1
dbi.database.writeToDB(o.r)
dbi.database.close()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[info] Writing to database for statepoint: /c00n01
</pre></div></div>
</div>
</div>
<div class="section" id="Loading-from-the-database">
<h2><span class="section-number">5.7. </span>Loading from the database<a class="headerlink" href="#Loading-from-the-database" title="Permalink to this headline">¶</a></h2>
<p>Once you have a database, you can use it to load a Reactor object from any of the states that were written to it. First, create a Database3 object, then open it and call its <code class="docutils literal notranslate"><span class="pre">load()</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from armi.bookkeeping import db
databaseLocation = &quot;anl-afci-177.h5&quot;
cycle, timeNode = 0, 1
dbo = db.databaseFactory(databaseLocation, &quot;r&quot;)
with dbo:
    # Load a new reactor object from the requested cycle and time node
    r = dbo.load(cycle, timeNode)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[info] Loading reactor state for time node (0, 1)
[info] Applying &lt;Migration from 0.1.2: Removes now-invalid `centers:` lines fro...
[info] Removing `centers:` sections.
[info] Applying &lt;Migration from 0.1.2: Update elemental nuclide flags....
=========== Initializing Mesh, Assembly Zones, and Nuclide Categories ===========
[info] Will expand HE, NA, SI, CR, MN, FE, NI, ZR, MO, W elementals to have natural isotopics
[info] Constructing assembly `inner fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `middle core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: B BU GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `outer core fuel`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: C BU GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial reflector`
[warn] Some component was missing in &lt;reflector block-bol-000 at ExCore XS: A BU GP: A&gt; so pin-to-duct gap not calculated
[info] Constructing assembly `radial shield`
[info] Constructing assembly `control`
[info] Constructing assembly `ultimate shutdown`
=========== Verifying Assembly Configurations ===========
[info] Nuclide categorization for cross section temperature assignments:
       ------------------  ------------------------------------------------------------
       Nuclide Category    Nuclides
       ------------------  ------------------------------------------------------------
       Fuel                AM241, CM243, ZR90, PU242, CM242, DUMP1, LFP35, ZR92, LFP38,
                           LFP41, ZR94, DUMP2, U238, CM244, LFP40, AM243, PU239, CM247,
                           PU240, U234, U236, NP238, AM242M, PU241, ZR96, U235,
                           NP237, LFP39, CM245, HE4, CM246, ZR91, PU238, PU236
       Coolant             NA23
       Structure           SI28, FE54, MO92, MO94, FE58, NI60, C, B10,
                           B11, NI58, NI62, W183, FE56, CR54, MO96, CR50,
                           CR52, W184, W186, MO98, W182, FE57, NI61, SI29,
                           MO95, MO97, CR53, MO100, NI64, MN55, V, SI30
       ------------------  ------------------------------------------------------------
</pre></div></div>
</div>
<p>We can see that the time node is what we expect (node 1), and there is some fission product mass since we loaded from a cycle after a depletion step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(r.p.timeNode)
print(o.r.getFissileMass())
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1
909142.5216630073
</pre></div></div>
</div>
<p>Having a Reactor object by itself can be very useful for all sorts of post-processing tasks. However, sometimes we may wish initialize more ARMI components to do more advanced tasks and interactive follow-on analysis. Lucky for us, the database stores the settings that were used to run the case in the first place. We can get them like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with dbo:
    cs = dbo.loadCS()
    print(cs[&quot;neutronicsKernel&quot;])
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>With this <code class="docutils literal notranslate"><span class="pre">CaseSettings</span></code> object, we could create a brand new <code class="docutils literal notranslate"><span class="pre">Case</span></code> and <code class="docutils literal notranslate"><span class="pre">Operator</span></code> and do all sorts of magic. This way of interacting with ARMI is rather advanced, and beyond the scope of this tutorial.</p>
<p>That’s just a brief exploration of the data model. Hopefully it helped orient you to the underlying ARMI structure.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="making_your_first_app.html" class="btn btn-neutral float-right" title="6. Making your first ARMI-based App" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="walkthrough_lwr_inputs.html" class="btn btn-neutral float-left" title="4. Building input files for a thermal reactor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2009-2022, TerraPower, LLC.
      <span class="lastupdated">
        Last updated on 2022-12-28.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>